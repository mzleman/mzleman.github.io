

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Leman">
  <meta name="keywords" content="">
  <title>webpack4é…ç½® - Personal Blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"mzleman.gitee.io","root":"/","version":"1.8.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.3.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Leman ğŸ˜€</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/profile/">
                <i class="iconfont icon-link-fill"></i>
                ç®€å†
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/post.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="webpack4é…ç½®">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-04-19 17:26" pubdate>
        2021å¹´4æœˆ19æ—¥ ä¸‹åˆ
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      19.4k å­—
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      260
       åˆ†é’Ÿ
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">webpack4é…ç½®</h1>
            
            <div class="markdown-body">
              <h1 id="webpackçš„ä½œç”¨"><a href="#webpackçš„ä½œç”¨" class="headerlink" title="webpackçš„ä½œç”¨"></a>webpackçš„ä½œç”¨</h1><p>ä½¿ç”¨webpackæ„å»ºå‰ç«¯é¡¹ç›®å·¥ç¨‹å…¶å®æ˜¯å·¥ç¨‹åŒ–ã€è‡ªåŠ¨åŒ–æ€æƒ³åœ¨å‰ç«¯å‘å¼€ä¸­çš„ä½“ç°ï¼ŒæŠŠä¸€ç³»åˆ—æµç¨‹ç”¨ä»£ç å»è‡ªåŠ¨å®ç°ã€‚</p>
<ul>
<li>ä»£ç è½¬æ¢ï¼šå°†TypeScriptç¼–è¯‘æˆJSï¼ŒSCSSç¼–è¯‘æˆCSSç­‰ã€‚</li>
<li>æ–‡ä»¶ä¼˜åŒ–ï¼šå‹ç¼©JSã€CSSã€HTMLä»£ç ï¼Œå‹ç¼©åˆå¹¶å›¾ç‰‡ç­‰ã€‚</li>
<li>ä»£ç åˆ†å‰²ï¼šæå–å¤šä¸ªé¡µé¢çš„å…¬å…±ä»£ç ã€æå–é¦–å±ä¸éœ€è¦æ‰§è¡Œéƒ¨åˆ†çš„ä»£ç è®©å…¶å¼‚æ­¥åŠ è½½ã€‚</li>
<li>æ¨¡å—åˆå¹¶ï¼šåœ¨é‡‡ç”¨æ¨¡å—åŒ–çš„é¡¹ç›®é‡Œä¼šæœ‰å¾ˆå¤šä¸ªæ¨¡å—å’Œæ–‡ä»¶ï¼Œéœ€è¦æ„å»ºåŠŸèƒ½æŠŠæ¨¡å—åˆ†ç±»åˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶ã€‚</li>
<li>è‡ªåŠ¨åˆ·æ–°ï¼šä¸»è¦æ˜¯ä¾èµ–äºwebpack-dev-serverï¼Œç›‘å¬æœ¬åœ°æºä»£ç çš„å˜åŒ–ï¼Œè‡ªåŠ¨é‡æ–°æ„å»ºã€åˆ·æ–°æµè§ˆå™¨ã€‚</li>
<li>ä»£ç æ ¡éªŒï¼šä¸»è¦æ˜¯ä¾èµ–äºEslintï¼Œå¯¹ä»£ç çš„æ­£ç¡®æ€§å’Œè§„èŒƒæ€§è¿›è¡Œæ£€æŸ¥ï¼Œä»¥åŠå•å…ƒæµ‹è¯•æ˜¯å¦é€šè¿‡ã€‚</li>
<li>è‡ªåŠ¨å‘å¸ƒï¼šæ›´æ–°å®Œä»£ç åï¼Œè‡ªåŠ¨æ„å»ºå‡ºçº¿ä¸Šå‘å¸ƒä»£ç å¹¶ä¼ è¾“ç»™å‘å¸ƒç³»ç»Ÿã€‚</li>
</ul>
<h1 id="webpackæ ¸å¿ƒæ¦‚å¿µ"><a href="#webpackæ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="webpackæ ¸å¿ƒæ¦‚å¿µ"></a>webpackæ ¸å¿ƒæ¦‚å¿µ</h1><ol>
<li><p><strong>entry</strong>ï¼šå…¥å£ï¼Œwebpackæ‰§è¡Œæ„å»ºçš„ç¬¬ä¸€æ­¥å°†ä»Entryå¼€å§‹ã€‚</p>
</li>
<li><p><strong>output</strong>ï¼šè¾“å‡ºç»“æœï¼Œåœ¨webpackç»è¿‡ä¸€ç³»åˆ—å¤„ç†å¹¶å¾—å‡ºæœ€ç»ˆæƒ³è¦çš„ä»£ç åè¾“å‡ºç»“æœã€‚</p>
</li>
<li><p><strong>module</strong>ï¼šæ¨¡å—ï¼Œåœ¨webpackä¸­ä¸€åˆ‡çš†æ¨¡å—ï¼ŒæŒ‡çš„æ˜¯ä¸€ä¸ªæ¨¡å—å¯¹åº”ç€ä¸€ä¸ªæ–‡ä»¶ï¼Œwebpackä¼šä»entryå¼€å§‹é€’å½’æ‰¾å‡ºæ‰€æœ‰ä¾èµ–çš„æ¨¡å—ã€‚</p>
</li>
<li><p><strong>chunk</strong>ï¼šä»£ç å—ï¼Œä¸€ä¸ªchunkç”±å¤šä¸ªæ¨¡å—ç»„åˆè€Œæˆï¼Œç”¨äºä»£ç åˆå¹¶ä¸åˆ†å‰²ã€‚</p>
</li>
<li><p><strong>loader</strong>ï¼šæ¨¡å—è½¬æ¢å™¨ï¼Œç”¨äºæŠŠæ¨¡å—åŸå†…å®¹æŒ‰ç…§è¦æ±‚è½¬æ¢æˆæ–°å†…å®¹ã€‚</p>
<blockquote>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œwebpackåªèƒ½è¯†åˆ«<code>.json</code>å’Œ<code>.js</code>æ–‡ä»¶ã€‚</p>
</blockquote>
</li>
<li><p><strong>plugin</strong>ï¼šæ‰©å±•æ’ä»¶ï¼Œåœ¨webpackæ„å»ºæµç¨‹ä¸­çš„ç‰¹å®šæ—¶æœºæ³¨å…¥æ‰©å±•é€»è¾‘æ¥æ”¹å˜æ„å»ºç»“æœæˆ–åšä½ æƒ³è¦åšçš„äº‹æƒ…ã€‚</p>
</li>
<li><p><strong>mode</strong>ï¼šæ¨¡å¼ï¼Œåˆ†ä¸ºå¼€å‘æ¨¡å¼<code>development</code>å’Œç”Ÿäº§æ¨¡å¼<code>production</code>ã€‚ä¸åŒçš„æ¨¡å¼ä¸‹ï¼Œå¯¹webpackçš„é…ç½®å’Œwebpackè‡ªèº«çš„å¤„ç†æµç¨‹æœ‰ä¸€äº›åŒºåˆ«ã€‚</p>
</li>
</ol>
<h2 id="å…³äºmoduleã€chunkã€chunkç»„"><a href="#å…³äºmoduleã€chunkã€chunkç»„" class="headerlink" title="å…³äºmoduleã€chunkã€chunkç»„"></a>å…³äºmoduleã€chunkã€chunkç»„</h2><p><strong>ä»¥ä¸‹å†…å®¹æ¥æºäºWebpackä¸­æ–‡å®˜æ–¹æ–‡æ¡£ï¼š</strong></p>
<p><a target="_blank" rel="noopener" href="https://webpack.docschina.org/concepts/under-the-hood/#the-main-parts">é“¾æ¥</a></p>
<p>é¡¹ç›®ä¸­ä½¿ç”¨çš„æ¯ä¸ªæ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ª<strong>æ¨¡å—</strong>ã€‚</p>
<p><strong>./index.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> app <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./app.js&#x27;</span>;<br></code></pre></td></tr></table></figure>
<p><strong>./app.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-string">&#x27;the app&#x27;</span>;<br></code></pre></td></tr></table></figure>


<p>é€šè¿‡äº’ç›¸å¼•ç”¨ï¼Œè¿™äº›æ¨¡å—ä¼šå½¢æˆä¸€ä¸ªå›¾(<code>ModuleGraph</code>)æ•°æ®ç»“æ„ã€‚</p>
<p><strong>æ¨¡å—ä¹‹é—´ç›¸äº’ä¾èµ–ï¼Œå¹¶å½¢æˆä¸€ä¸ªè¿æ¥çš„å›¾(<code>ModuleGraph</code>)ï¼Œå…¥å£æ¨¡å—å°±æ˜¯æ‹“æ‰‘çš„èµ·ç‚¹</strong>ã€‚ </p>
<p><strong>ä»å…¥å£æ¨¡å—å¼€å§‹åˆ†æä¾èµ–å…³ç³»ï¼Œå°†åŒæ­¥çš„æ¨¡å—åˆå¹¶ç”Ÿæˆchunkï¼Œå°†å¼‚æ­¥çš„æ¨¡å—ã€å…±åŒçš„ä¾èµ–è¿›è¡Œåˆ†ç¦»æˆchunkï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­å°±äº§ç”Ÿäº†ä¸€åˆ°å¤šä¸ªchunkï¼Œç§°ä¸ºchunkç»„ï¼ˆ<code>chunk group</code>ï¼‰ã€‚</strong></p>
<p><strong>./webpack.config.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = &#123;<br>  entry: <span class="hljs-string">&#x27;./index.js&#x27;</span>,<br>&#125;;<br></code></pre></td></tr></table></figure>
<p>è¿™ä¼šåˆ›å»ºå‡ºä¸€ä¸ªåä¸º <code>main</code> çš„ chunk ç»„ï¼ˆ<code>main</code> æ˜¯å…¥å£èµ·ç‚¹çš„é»˜è®¤åç§°ï¼‰ã€‚ æ­¤ chunk ç»„åŒ…å« <code>./index.js</code> æ¨¡å—ã€‚éšç€ parser å¤„ç† <code>./index.js</code> å†…éƒ¨çš„ import æ—¶ï¼Œ æ–°æ¨¡å—å°±ä¼šè¢«æ·»åŠ åˆ°æ­¤ chunk ä¸­ã€‚</p>
<p><strong>å¦å¤–çš„ä¸€ä¸ªç¤ºä¾‹ï¼š</strong></p>
<p><strong>./webpack.config.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = &#123;<br>  entry: &#123;<br>    home: <span class="hljs-string">&#x27;./home.js&#x27;</span>,<br>    about: <span class="hljs-string">&#x27;./about.js&#x27;</span>,<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure>
<p>è¿™ä¼šåˆ›å»ºå‡ºä¸¤ä¸ªåä¸º <code>home</code> å’Œ <code>about</code> çš„ chunk ç»„ã€‚ æ¯ä¸ª chunk ç»„éƒ½æœ‰ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæ¨¡å—çš„ chunkï¼š<code>./home.js</code> å¯¹åº” <code>home</code>ï¼Œ<code>./about.js</code> å¯¹åº” <code>about</code>ã€‚</p>
<blockquote>
<p><em>ä¸€ä¸ª chunk ç»„ä¸­å¯èƒ½æœ‰å¤šä¸ª chunkã€‚ä¾‹å¦‚ï¼Œ</em><a target="_blank" rel="noopener" href="https://webpack.docschina.org/plugins/split-chunks-plugin/">SplitChunksPlugin</a> <em>ä¼šå°†ä¸€ä¸ª chunk æ‹†åˆ†ä¸ºä¸€ä¸ªæˆ–å¤šä¸ª chunkã€‚</em></p>
</blockquote>
<p><font size="10">chunks</font></p>
<p><strong>chunk æœ‰ä¸¤ç§å½¢å¼ï¼š</strong></p>
<ul>
<li><p><code>initialï¼ˆåˆå§‹åŒ–chunkï¼‰</code> ï¼Œä¹Ÿå¯ä»¥å«åšä¸»chunkï¼Œæ˜¯ç”±å…¥å£èµ·ç‚¹ç”Ÿæˆçš„ä¸»çº¿ã€‚æ­¤ chunk åŒ…å«ä¸ºå…¥å£èµ·ç‚¹æŒ‡å®šçš„æ‰€æœ‰æ¨¡å—åŠå…¶ä¾èµ–é¡¹ã€‚</p>
</li>
<li><p><code>non-initialï¼ˆéåˆå§‹åŒ–chunkï¼‰</code> ã€‚ç”± <a target="_blank" rel="noopener" href="https://webpack.docschina.org/guides/code-splitting/#dynamic-imports">åŠ¨æ€å¯¼å…¥(dynamic imports)</a> è¯­æ³•æˆ–è€… <a target="_blank" rel="noopener" href="https://webpack.docschina.org/plugins/split-chunks-plugin/">SplitChunksPlugin</a> è§„åˆ™åˆ†ç¦»å‡ºçš„chunkã€‚</p>
</li>
</ul>
<blockquote>
<p>ä¸€èˆ¬è€Œè¨€ï¼ŒsplitChunksPluginåˆ†ç¦»å‡ºçš„éæ‡’åŠ è½½chunkæ‰“åŒ…å‡ºçš„jsæ–‡ä»¶ä¸€èˆ¬æ’å…¥åœ¨initial-chunkæ‰“åŒ…å‡ºçš„jsä¹‹å‰ã€‚</p>
</blockquote>
<p>æ‰€æœ‰çš„chunkä¼šå¯¹åº”ä¸€ä¸ªèµ„æºï¼ˆ<code>asset</code>ï¼‰ï¼Œèµ„æºæ˜¯ç”±chunkæ‰“åŒ…å‡ºçš„ç»“æœï¼Œä¸€èˆ¬æ˜¯js+css+å›¾ç‰‡ç­‰èµ„æºçš„ç»„åˆã€‚</p>
<p><strong>webpack.config.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = &#123;<br>  entry: <span class="hljs-string">&#x27;./src/index.jsx&#x27;</span>,<br>&#125;;<br></code></pre></td></tr></table></figure>
<p><strong>./src/index.jsx</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;<br><span class="hljs-keyword">import</span> ReactDOM <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-dom&#x27;</span>;<br><br><span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;./app.jsx&#x27;</span>).then(<span class="hljs-function">(<span class="hljs-params">App</span>) =&gt;</span> &#123;<br>  ReactDOM.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>, root);<br>&#125;);<br></code></pre></td></tr></table></figure>
<p>è¿™ä¼šåˆ›å»ºå‡ºä¸€ä¸ªåä¸º <code>main</code> çš„ initial chunkã€‚å…¶ä¸­åŒ…å«ï¼š</p>
<ul>
<li><code>./src/index.jsx</code></li>
<li><code>react</code></li>
<li><code>react-dom</code></li>
</ul>
<p>ä»¥åŠé™¤ <code>./app.jsx</code> å¤–çš„æ‰€æœ‰ä¾èµ–</p>
<p>ç„¶åä¼šä¸º <code>./app.jsx</code> åˆ›å»º non-initial chunkï¼Œè¿™æ˜¯å› ä¸º <code>./app.jsx</code> æ˜¯åŠ¨æ€å¯¼å…¥çš„ã€‚</p>
<p><strong>è¾“å‡ºçš„ç»“æœæ–‡ä»¶ï¼ˆ<code>asset</code>ï¼‰</strong>:</p>
<ul>
<li><code>/dist/main.js</code> - ä¸€ä¸ª <code>initial</code> chunk</li>
<li><code>/dist/394.js</code> - <code>non-initial</code> chunk</li>
</ul>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™äº› <code>non-initial</code> chunk æ²¡æœ‰åç§°ï¼Œå› æ­¤ä¼šä½¿ç”¨å”¯ä¸€ ID æ¥æ›¿ä»£åç§°ã€‚ åœ¨ä½¿ç”¨åŠ¨æ€å¯¼å…¥æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://webpack.docschina.org/api/module-methods/#magic-comments">magic comment(é­”æœ¯æ³¨é‡Š)</a> æ¥æ˜¾å¼æŒ‡å®š chunk åç§°ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span>(<br>  <span class="hljs-comment">/* webpackChunkName: &quot;app&quot; */</span><br>  <span class="hljs-string">&#x27;./app.jsx&#x27;</span><br>).then(<span class="hljs-function">(<span class="hljs-params">App</span>) =&gt;</span> &#123;<br>  ReactDOM.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>, root);<br>&#125;);<br></code></pre></td></tr></table></figure>
<blockquote>
<p>Webpack5ä¸­ï¼Œå¼‚æ­¥å¯¼å…¥çš„æ¨¡å—çš„webpackChunkNameé»˜è®¤ä¸ºç”±ä¸‹åˆ’çº¿å’Œä¸­åˆ’çº¿è¿æ¥çš„æ–‡ä»¶è§£æè·¯å¾„ï¼Œè¿™æ˜¯ä¸Webpack4çš„ä¸åŒä¹‹å¤„ä¹‹ä¸€ã€‚</p>
</blockquote>
<p><strong>è¾“å‡ºæ–‡ä»¶çš„åç§°ä¼šå—é…ç½®ä¸­çš„ä¸¤ä¸ªå­—æ®µçš„å½±å“ï¼š</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://webpack.docschina.org/configuration/output/#outputfilename"><code>output.filename</code></a> - ç”¨äº <code>initial</code> chunk æ–‡ä»¶</li>
<li><a target="_blank" rel="noopener" href="https://webpack.docschina.org/configuration/output/#outputchunkfilename"><code>output.chunkFilename</code></a> - ç”¨äº <code>non-initial</code> chunk æ–‡ä»¶</li>
</ul>
<h1 id="æ¨¡å—çš„åˆçº§æ‰“åŒ…"><a href="#æ¨¡å—çš„åˆçº§æ‰“åŒ…" class="headerlink" title="æ¨¡å—çš„åˆçº§æ‰“åŒ…"></a>æ¨¡å—çš„åˆçº§æ‰“åŒ…</h1><h2 id="webpackçš„hello-world"><a href="#webpackçš„hello-world" class="headerlink" title="webpackçš„hello world"></a>webpackçš„hello world</h2><ol>
<li><p>åˆ›å»ºå·¥ç¨‹ç›®å½•</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">mkdir project<br></code></pre></td></tr></table></figure></li>
<li><p>åˆ›å»ºæºä»£ç ç›®å½•</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">cd</span> project<br>mkdir src<br></code></pre></td></tr></table></figure></li>
<li><p>åˆ›å»ºè¾“å‡ºç›®å½•ï¼ˆå¯çœç•¥ï¼Œæ¢åœ¨webpacké…ç½®ä¸­å£°æ˜ï¼‰</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">mkdir dist<br></code></pre></td></tr></table></figure></li>
<li><p>åˆå§‹åŒ–npmåŒ…å¹¶å®‰è£…<code>webpack</code>ã€<code>webpack-cli</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell">npm init <span class="hljs-literal">-y</span><br>npm install webpack webpack<span class="hljs-literal">-cli</span> <span class="hljs-literal">-D</span><br></code></pre></td></tr></table></figure></li>
<li><p>æ–°å»º<code>webpack.config.js</code>ï¼Œé…ç½®å…¥å£å’Œè¾“å‡ºè·¯å¾„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> &#123; resolve &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    entry: <span class="hljs-string">&#x27;./src/main.js&#x27;</span>, <span class="hljs-comment">// å…¥å£ä¸ºsrcç›®å½•ä¸‹main.js</span><br>    output: &#123;<br>        filename: <span class="hljs-string">&#x27;bundle.js&#x27;</span>, <span class="hljs-comment">// æ‰“åŒ…åçš„ä¸»æ–‡ä»¶å</span><br>        path: resolve(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>) <span class="hljs-comment">// è¾“å‡ºç›®å½•ï¼Œå¿…é¡»æ˜¯ç»å¯¹è·¯å¾„</span><br>    &#125;,<br>    mode: <span class="hljs-string">&#x27;development&#x27;</span>,<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>åœ¨<code>package.json</code>ä¸­é…ç½®npmè„šæœ¬</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json"># package.json<br>&#123;<br>    <span class="hljs-comment">//....</span><br>    <span class="hljs-comment">// æ–°å¢scriptså­—æ®µ</span><br>    <span class="hljs-attr">&quot;scripts&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;build&quot;</span>: <span class="hljs-string">&quot;webpack&quot;</span><br>    &#125; <br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>æ–°å»º<code>src/main.js</code>ï¼Œæ‰§è¡Œ<code>npm run build</code>æ‰“åŒ…æ–‡ä»¶ã€‚æ‰“åŒ…ååœ¨distç›®å½•ä¸‹æ–°å»º<code>index.html</code>ï¼Œå¼•å…¥<code>bundle.js</code>è¿›è¡Œæµ‹è¯•</p>
<p>â€“ dist</p>
<p>â€”- bundle.js</p>
<p>â€”- index.html</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//# src/main.js</span><br><span class="hljs-built_in">document</span>.write(<span class="hljs-string">&#x27;hello world&#x27;</span>);<br></code></pre></td></tr></table></figure>
<p><img src="/2021/04/19/Webpack/webpack4/image-20210213175816749.png" srcset="/img/loading.gif"> </p>
</li>
</ol>
<h2 id="æ‰“åŒ…JS"><a href="#æ‰“åŒ…JS" class="headerlink" title="æ‰“åŒ…JS"></a>æ‰“åŒ…JS</h2><p>webpackä¼šä»å…¥å£jsæ–‡ä»¶å¼€å§‹è‡ªåŠ¨é€’å½’æ‰“åŒ…ä¾èµ–ï¼Œæ‰€ä»¥è®¾ç½®å¥½å…¥å£åå°±èƒ½å¤Ÿæ‰“åŒ…jsæ–‡ä»¶ã€‚</p>
<p>åœ¨ä¸åˆ†å‰²ä»£ç ã€æ²¡æœ‰æ‡’åŠ è½½çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå…¥å£jsæ–‡ä»¶ä¼šå¯¹åº”ä¸€ä¸ªchunkï¼Œå¤šä¸ªå…¥å£æ–‡ä»¶ä¼šå¯¹åº”å¤šä¸ªchunkï¼Œæ¯ä¸ªchunkæ‰“åŒ…å‡ºä¸€ä¸ªbundleã€‚</p>
<h3 id="å•å…¥å£"><a href="#å•å…¥å£" class="headerlink" title="å•å…¥å£"></a>å•å…¥å£</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-keyword">const</span> &#123;resolve&#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  entry: <span class="hljs-string">&#x27;./src/main.js&#x27;</span>, <span class="hljs-comment">/* â­ è¿™å…¶å®æ˜¯è¯­æ³•ç³–å†™æ³•ï¼Œç›¸å½“äº entry: &#123; main: &#x27;./src/main.js&#x27; &#125;*/</span><br>  output: &#123;<br>    filename: <span class="hljs-string">&#x27;bundle.js&#x27;</span>,<br>    path: resolve(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>) <span class="hljs-comment">// æ‰“åŒ…çš„è¾“å‡ºç›®å½•</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="å¤šå…¥å£"><a href="#å¤šå…¥å£" class="headerlink" title="å¤šå…¥å£"></a>å¤šå…¥å£</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-keyword">const</span> &#123;resolve&#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  entry: &#123;<br>    <span class="hljs-comment">/* å¤šå…¥å£æ—¶ï¼Œentryé‡‡ç”¨é”®å€¼å¯¹å†™æ³•, keyä¸ºå…¥å£chunkçš„nameï¼Œvalueä¸ºå…¥å£æ–‡ä»¶çš„è·¯å¾„/ç¬¬ä¸‰æ–¹åŒ…å </span><br><span class="hljs-comment">    	å•å…¥å£è¯­æ³•ç³–å†™æ³•æ—¶ï¼Œchunkçš„nameé»˜è®¤ä¸ºmain */</span><br>    main: <span class="hljs-string">&#x27;main.js&#x27;</span>,<br>    index: <span class="hljs-string">&#x27;index.js&#x27;</span>,<br>    vendor: <span class="hljs-string">&#x27;jquery&#x27;</span><br>  &#125;<br>  output: &#123;<br>  	<span class="hljs-comment">// ğŸ‘‡ å¤šå…¥å£æ—¶æ–‡ä»¶ååº”è¯¥è¿™æ ·å†™ï¼Œ[name]ä¸ºentryä¸­å®šä¹‰çš„keyï¼Œä¹Ÿå°±æ˜¯chunkçš„nameã€‚[hash]ä¸ºå¯é€‰</span><br>    filename: <span class="hljs-string">&#x27;[name].[hash].js&#x27;</span>, <span class="hljs-comment">// æ¯”å¦‚è¯´jqueryæ‰“åŒ…åå°±æ˜¯ä¸ºvendor.[hash].js</span><br>  	path: resolve(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>






<h2 id="æ‰“åŒ…å•é¡µHTML"><a href="#æ‰“åŒ…å•é¡µHTML" class="headerlink" title="æ‰“åŒ…å•é¡µHTML"></a>æ‰“åŒ…å•é¡µHTML</h2><p>ä½¿ç”¨æ’ä»¶<code>html-webpack-plugin</code>è¯»å–æ¨¡æ¿ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-keyword">const</span> HtmlWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-comment">//...</span><br>    plugins: [<br>        <span class="hljs-keyword">new</span> HtmlWebpackPlugin(&#123;<br>            template: <span class="hljs-string">&#x27;./src/index.html&#x27;</span> <span class="hljs-comment">// æŒ‡å®šä»¥å“ªä¸ªhtmlæ–‡ä»¶ä½œä¸ºæ¨¡æ¿</span><br>        	<span class="hljs-comment">// å…¶ä»–å¯é…ç½®é¡¹</span><br>        	<span class="hljs-comment">/*</span><br><span class="hljs-comment">        	filename: &#x27;index.html&#x27;, ğŸ‘ˆ å¯ä»¥æ›´æ”¹è¾“å‡ºçš„æ–‡ä»¶è·¯å¾„</span><br><span class="hljs-comment">        	hash: true, ğŸ‘ˆ ä¸ºhtmlå¼•ç”¨çš„å…¶ä»–èµ„æºçš„urlååŠ ä¸ŠæŸ¥è¯¢hashï¼Œä¾‹å¦‚ï¼šbundle.js?29ab09214532</span><br><span class="hljs-comment">        	chunks: [&#x27;main&#x27;], ğŸ‘ˆ æŒ‡å®šhtml.bodyæœ«å°¾æ’å…¥å“ªäº›chunkçš„scriptæ ‡ç­¾ï¼Œæ•°ç»„ä¸­å…ƒç´ ä¸ºchunkçš„name</span><br><span class="hljs-comment">        	chunksSortMode: &#x27;maunal&#x27; ğŸ‘ˆ æ‰‹åŠ¨è®¾ç½®chunkçš„æ’å…¥é¡ºåºï¼Œå³æŒ‰ç…§ä¸Šä¸€è¡Œchunksæ•°ç»„ä¸­çš„é¡ºåºæ’å…¥</span><br><span class="hljs-comment">        	*/</span><br>        &#125;)<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p><strong>â— æ–°ç‰ˆhtml-webpack-pluginä¸­é»˜è®¤ä¼šå°†scriptæ’å…¥åˆ°<head>æ ‡ç­¾ä¸­ï¼Œä½†åŒæ—¶æ’å…¥çš„scriptæ ‡ç­¾ä¼šæ‹¥æœ‰<code>defer=&quot;defer&quot;</code> å±æ€§</strong>ã€‚è¿™ä¸ªå±æ€§ä¼šæ ‡è®°jsè„šæœ¬åœ¨é¡µé¢åŠ è½½å®Œåæ‰§è¡Œï¼Œä½†æ˜¯èƒ½å¤Ÿåœ¨<strong>é«˜çº§æµè§ˆå™¨ä¸­</strong>æé«˜é¡µé¢åŠ è½½çš„æ€§èƒ½ï¼Œè¿™ç§æŠ€æœ¯å«åšéé˜»å¡JavaScriptåŠ è½½ï¼ˆnon-blocking javascript loadingï¼‰ã€‚</p>
<p>å¦‚æœä»ç„¶éœ€è¦å°†scriptæ ‡ç­¾æ’å…¥åˆ°bodyæœ€åï¼Œéœ€è¦åœ¨<code>options</code>ä¸­å¤šé…ç½®ä¸€æ¡ï¼š<code>inject: &#39;body&#39;</code>ã€‚ä½†ç”±äºdeferå±æ€§çš„å­˜åœ¨ï¼Œä»…ä»…å°†scriptæ ‡ç­¾æ’å…¥åˆ°bodyæœ€åï¼Œæœ‰ç‚¹ç”»è›‡æ·»è¶³ã€‚è¿™æ˜¯å› ä¸ºåªè¦æœ‰deferå±æ€§çš„å­˜åœ¨ï¼Œscriptæ ‡ç­¾æŒ‡å‘çš„å¤–éƒ¨jsè„šæœ¬éƒ½ä¼šéé˜»å¡åŠ è½½ã€‚</p>
<p>å¦‚æœä¸æƒ³ä½¿ç”¨éé˜»å¡åŠ è½½å¹¶ä¸”å°†scriptæ ‡ç­¾æ’å…¥åˆ°bodyæœ€åï¼Œåˆ™éœ€è¦åœ¨<code>options</code>ä¸­å†å¤šé…ç½®ä¸€æ¡ï¼š<code>scriptLoading: &#39;blocking&#39;</code>ï¼Œè¯¥å€¼é»˜è®¤ä¸º<code>defer</code>ã€‚</p>
</blockquote>
<h2 id="æ‰“åŒ…CSS"><a href="#æ‰“åŒ…CSS" class="headerlink" title="æ‰“åŒ…CSS"></a>æ‰“åŒ…CSS</h2><h3 id="å¼€å‘ç¯å¢ƒå†…è”"><a href="#å¼€å‘ç¯å¢ƒå†…è”" class="headerlink" title="å¼€å‘ç¯å¢ƒå†…è”"></a>å¼€å‘ç¯å¢ƒå†…è”</h3><p>å¼€å‘ç¯å¢ƒä¸‹æ ·å¼å†…è”ï¼Œå°†ä¸€ä¸ªchunkä¸­çš„cssæ‰“åŒ…ç»“æœæ’å…¥åˆ°styleæ ‡ç­¾ä¸­ã€‚ä½¿ç”¨<code>css-loader</code>å’Œ<code>style-loader</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-comment">//...</span><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-comment">//...</span><br>    <span class="hljs-built_in">module</span>: &#123;  <span class="hljs-comment">// æ‰€æœ‰çš„loaderåŒ¹é…è§„åˆ™åœ¨module.rulesä¸­é…ç½®</span><br>        rules: [<br>            &#123;<br>                test: <span class="hljs-regexp">/\.css$/</span>,<br>                use: [<span class="hljs-string">&#x27;style-loader&#x27;</span>, <span class="hljs-string">&#x27;css-loader&#x27;</span>] <span class="hljs-comment">// loaderçš„æ‰§è¡Œé¡ºåºæ˜¯ä»åå‘å‰</span><br>            &#125;<br>        ]<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="ç”Ÿäº§ç¯å¢ƒåˆ†ç¦»"><a href="#ç”Ÿäº§ç¯å¢ƒåˆ†ç¦»" class="headerlink" title="ç”Ÿäº§ç¯å¢ƒåˆ†ç¦»"></a>ç”Ÿäº§ç¯å¢ƒåˆ†ç¦»</h3><p>ç”Ÿäº§ç¯å¢ƒä¸­å¦‚æœæ ·å¼ä»ç„¶æ‰“åŒ…åˆ°headä¸­çš„styleæ ‡ç­¾ä¸­ï¼Œç”±äºcssæ–‡ä»¶ä½“ç§¯è¿‡å¤§ï¼Œè§£æéœ€è¦çŸ­æš‚çš„æ—¶é—´ï¼Œä¼šå‡ºç°é—ªå±ç°è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨<code>mini-css-extract-plugin</code>çš„loaderä»£æ›¿<code>style-loader</code>ï¼Œ<strong>å°†cssæ–‡ä»¶åˆ†ç¦»ã€‚</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-comment">//...</span><br><span class="hljs-keyword">const</span> MiniCssExtractPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;mini-css-extract-plugin&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-comment">//...</span><br>    <span class="hljs-built_in">module</span>: &#123;  <br>        rules: [<br>            &#123;<br>                test: <span class="hljs-regexp">/\.css$/</span>,<br>                use: [MiniCssExtractPlugin.loader, <span class="hljs-string">&#x27;css-loader&#x27;</span>] â­ <span class="hljs-comment">// æ›¿æ¢æ‰style-loader</span><br>            &#125;<br>        ]<br>    &#125;,<br>    plugins: [<br>        <span class="hljs-comment">//...</span><br>        <span class="hljs-keyword">new</span> MiniCssExtractPlugin(&#123;<br>            filename: <span class="hljs-string">&#x27;[name].css&#x27;</span> <span class="hljs-comment">// nameæ˜¯æ‰€åœ¨chunkçš„nameï¼Œå•å…¥å£æ—¶ä¸ºmain.css</span><br>        &#125;)<br>    ]<br>&#125;<br><br></code></pre></td></tr></table></figure>


<h2 id="æ‰“åŒ…å›¾ç‰‡"><a href="#æ‰“åŒ…å›¾ç‰‡" class="headerlink" title="æ‰“åŒ…å›¾ç‰‡"></a>æ‰“åŒ…å›¾ç‰‡</h2><h3 id="å¤„ç†jsä¸­å¼•å…¥çš„å›¾ç‰‡"><a href="#å¤„ç†jsä¸­å¼•å…¥çš„å›¾ç‰‡" class="headerlink" title="å¤„ç†jsä¸­å¼•å…¥çš„å›¾ç‰‡"></a>å¤„ç†jsä¸­å¼•å…¥çš„å›¾ç‰‡</h3><p>ä¾‹å¦‚ï¼Œåœ¨å¦‚ä¸‹çš„ä»£ç å—ä¸­å¼•å…¥äº†ä¸€ä¸ªå›¾ç‰‡æ¨¡å—ï¼Œwebpackæ˜¯è¯†åˆ«ä¸äº†å›¾ç‰‡çš„ï¼Œæ‰€ä»¥éœ€è¦loaderçš„å¸®åŠ©</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//# main.js</span><br><span class="hljs-keyword">const</span> imgSrc = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./images/xxx.jpg&#x27;</span>);<br></code></pre></td></tr></table></figure>
<p>webpackå»ºè®®æˆ‘ä»¬ä½¿ç”¨<code>url-loader</code>æˆ–<code>file-loader</code>å¤„ç†å›¾ç‰‡ï¼Œ<code>url-loader</code>å†…ç½®äº†<code>file-loader</code>ï¼ŒåŠŸèƒ½æ›´å¼ºå¤§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-comment">//...</span><br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      &#123;<br>        test: <span class="hljs-regexp">/\.(jpe?g|png|gif|svg|bmp)$/</span>,<br>        use: &#123;<br>          <span class="hljs-comment">/* å½“éœ€è¦å¯¹ä¸€ä¸ªloaderè¿›è¡Œé…ç½®æ—¶ï¼Œé‡‡ç”¨å¯¹è±¡å†™æ³• */</span><br>          loader: <span class="hljs-string">&#x27;url-loader&#x27;</span>, <br>          options: &#123;             <span class="hljs-comment">// é…ç½®å†™åœ¨optionsä¸­</span><br>            limit: <span class="hljs-number">12</span> * <span class="hljs-number">1024</span>, <span class="hljs-comment">// limité™åˆ¶äº†å¤šå¤§çš„å›¾ç‰‡ä»¥ä¸‹é‡‡ç”¨Base64å†…è”ï¼Œå•ä½ä¸ºByteã€‚è¿™é‡Œé™åˆ¶äº†12KB</span><br>          &#125;<br>        &#125;<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="å¤„ç†htmlæ¨¡æ¿ä¸­çš„å›¾ç‰‡æ ‡ç­¾"><a href="#å¤„ç†htmlæ¨¡æ¿ä¸­çš„å›¾ç‰‡æ ‡ç­¾" class="headerlink" title="å¤„ç†htmlæ¨¡æ¿ä¸­çš„å›¾ç‰‡æ ‡ç­¾"></a>å¤„ç†htmlæ¨¡æ¿ä¸­çš„å›¾ç‰‡æ ‡ç­¾</h3><p>HTMLæ¨¡æ¿ä¸­å¦‚æœç”¨imgæ ‡ç­¾å¼•å…¥äº†å¼€å‘ç›®å½•ä¸‹çš„å›¾ç‰‡èµ„æºï¼Œå¦‚æœä¸è¿›è¡Œå¤„ç†ï¼Œwebpackæ˜¯ä¸ä¼šæ‰“åŒ…å¼•å…¥çš„å›¾ç‰‡çš„ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-comment">&lt;!--....--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./images/xxx.jpg&quot;</span>&gt;</span> <span class="hljs-comment">&lt;!--ğŸ‘ˆæ‰“åŒ…ådistç›®å½•ä¸­index.htmlçš„imgæ ‡ç­¾ä¸ä¼šå˜åŒ–ï¼Œä½†æ˜¯æ²¡æœ‰æ‰“åŒ…å›¾ç‰‡--&gt;</span><br><span class="hljs-comment">&lt;!----&gt;</span><br></code></pre></td></tr></table></figure>
<p>æ‰€ä»¥æˆ‘ä»¬è¦ä½¿ç”¨<code>html-withimg-loader</code>å¤„ç†htmlæ–‡ä»¶, å‘ç°å…¶ä¸­çš„å›¾ç‰‡å¼•ç”¨ï¼Œä»è€Œäº¤ç»™<code>url-loader</code>å¤„ç†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      &#123;<br>        test: <span class="hljs-regexp">/\.(jpe?g|png|gif|svg|bmp)$/</span>,<br>        use: &#123;<br>          loader: <span class="hljs-string">&#x27;url-loader&#x27;</span>,<br>          options: &#123;<br>            limit: <span class="hljs-number">12</span> * <span class="hljs-number">1024</span>,<br>            esModule: <span class="hljs-literal">false</span> <span class="hljs-comment">/*ğŸ‘ˆâ­â­ æœ‰æ—¶éœ€è¦æŒ‡å®šurl-loaderä½¿ç”¨commonJSå¯¼å…¥,å¦åˆ™å’Œhtml-webpack-pluginä¹‹é—´ä¼šå­˜åœ¨bug*/</span><br>          &#125;<br>        &#125;<br>      &#125;,<br>      &#123;<br>        test: <span class="hljs-regexp">/\.html$/</span>,<br>        use: <span class="hljs-string">&#x27;html-withimg-loader&#x27;</span> <span class="hljs-comment">// é…ç½®html-withimg-loader</span><br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="å¤„ç†cssä¸­çš„æ–‡ä»¶"><a href="#å¤„ç†cssä¸­çš„æ–‡ä»¶" class="headerlink" title="å¤„ç†cssä¸­çš„æ–‡ä»¶"></a>å¤„ç†cssä¸­çš„æ–‡ä»¶</h3><p>cssä¸­ä½¿ç”¨<code>url(...)</code>è¿™æ ·çš„è¯­æ³•å¼•ç”¨çš„å›¾ç‰‡èµ„æºä¼šè¢«<code>css-loader</code>è¿›è¡Œå¤„ç†ã€‚</p>
<h1 id="æ¨¡å—çš„é«˜çº§å¤„ç†"><a href="#æ¨¡å—çš„é«˜çº§å¤„ç†" class="headerlink" title="æ¨¡å—çš„é«˜çº§å¤„ç†"></a>æ¨¡å—çš„é«˜çº§å¤„ç†</h1><h2 id="é™æ€èµ„æºåˆ†ç¦»ä¸é‡å‘½å"><a href="#é™æ€èµ„æºåˆ†ç¦»ä¸é‡å‘½å" class="headerlink" title="é™æ€èµ„æºåˆ†ç¦»ä¸é‡å‘½å"></a>é™æ€èµ„æºåˆ†ç¦»ä¸é‡å‘½å</h2><p>ä¹‹å‰å¯¹jsã€å›¾ç‰‡ã€cssçš„å¤„ç†éƒ½åªä¼šå°†æ‰“åŒ…çš„ç»“æœå…¨éƒ¨ä¿å­˜åœ¨distç›®å½•ä¸‹ï¼Œè¿™æ— ç–‘æ˜¯æ··ä¹±çš„ï¼Œæˆ‘ä»¬éœ€è¦å°†ä¸åŒçš„é™æ€èµ„æºåˆ†ç±»ï¼Œå­˜æ”¾åœ¨<code>dist</code>æˆ–<code>dist/static</code>ç›®å½•ä¸‹ã€‚</p>
<h3 id="å°†jsæ‰“åŒ…åˆ°dist-js-æˆ–-dist-static-js"><a href="#å°†jsæ‰“åŒ…åˆ°dist-js-æˆ–-dist-static-js" class="headerlink" title="å°†jsæ‰“åŒ…åˆ°dist/js æˆ– dist/static/js"></a>å°†jsæ‰“åŒ…åˆ°dist/js æˆ– dist/static/js</h3><p>webpackä¼šä»<code>entry</code>å¼€å§‹æ‰“åŒ…jsï¼Œå¹¶è¾“å‡ºåˆ°<code>output</code>ï¼Œæ‰€ä»¥jsæ‰“åŒ…åˆ°æŒ‡å®šç›®å½•éœ€è¦åœ¨<code>output</code>ä¸­å¤„ç†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-keyword">const</span> &#123;resolve&#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  entry: <span class="hljs-string">&#x27;./src/main.js&#x27;</span>,<br>  output: &#123;<br>    filename: <span class="hljs-string">&#x27;js/bundle.js&#x27;</span> <br>    <span class="hljs-comment">// â­ å¦‚æœæ‰“åŒ…ç»“æœè¦ä¿å­˜åˆ°dist/staticï¼Œ åˆ™filename: &#x27;static/js/bundle.js&#x27;</span><br>    <span class="hljs-comment">// â­ å¦‚æœå¤šå…¥å£ä¸”ç»“æœä¿å­˜åˆ°jsç›®å½•ä¸‹ï¼Œåˆ™filename: &#x27;js/[name].[hash].js&#x27;</span><br>    path: resolve(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>),<br>  	publicPath: <span class="hljs-string">&#x27;/&#x27;</span> <span class="hljs-comment">// â­ æœ€å¥½è®¾ç½®ä¸€ä¸‹publicPathä¸º&quot;/&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="å°†å›¾ç‰‡æ‰“åŒ…åˆ°dist-imageæˆ–dist-static-image"><a href="#å°†å›¾ç‰‡æ‰“åŒ…åˆ°dist-imageæˆ–dist-static-image" class="headerlink" title="å°†å›¾ç‰‡æ‰“åŒ…åˆ°dist/imageæˆ–dist/static/image"></a>å°†å›¾ç‰‡æ‰“åŒ…åˆ°dist/imageæˆ–dist/static/image</h3><p>å›¾ç‰‡æ‰“åŒ…åˆ°æŒ‡å®šç›®å½•éœ€è¦åœ¨<code>url-loader</code>çš„<code>options</code>ä¸­å¤„ç†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-comment">//...</span><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  output: &#123;<br>    <span class="hljs-comment">//...</span><br>    publicPath: <span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-comment">// ğŸ‘ˆ è¿™é‡Œé…åˆoutput.publicPath</span><br>  &#125;<br>  <span class="hljs-comment">//..</span><br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      <span class="hljs-comment">//...</span><br>      &#123;<br>        test: <span class="hljs-regexp">/\.(jpe?g|png|gif|svg|bmp)/</span>,<br>        use: &#123;<br>          loader: <span class="hljs-string">&#x27;url-loader&#x27;</span>,<br>          options: &#123;<br>            limit: <span class="hljs-number">12</span> * <span class="hljs-number">1024</span>,<br>    		esModule: <span class="hljs-literal">false</span>,<br>            <span class="hljs-comment">// ğŸ‘‡ â­</span><br>    		outputPath: <span class="hljs-string">&#x27;static/image&#x27;</span> <span class="hljs-comment">// outputPathä¸ºfile-loaderä¸­çš„å¯é€‰é¡¹ï¼Œèµ„æºçš„ç»Ÿä¸€å­˜æ”¾è·¯å¾„ã€‚</span><br>            name: <span class="hljs-string">&#x27;[name].[contenthash:10].[ext]&#x27;</span>, <span class="hljs-comment">// nameå¯ä»¥çœç•¥ï¼Œæ–‡ä»¶åç›´æ¥ç”±hashå€¼æ›¿ä»£</span><br>          &#125;<br>        &#125;<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="å°†cssæ‰“åŒ…åˆ°dist-css-æˆ–-dist-static-css"><a href="#å°†cssæ‰“åŒ…åˆ°dist-css-æˆ–-dist-static-css" class="headerlink" title="å°†cssæ‰“åŒ…åˆ°dist/css æˆ– dist/static/css"></a>å°†cssæ‰“åŒ…åˆ°dist/css æˆ– dist/static/css</h3><p>ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œcssæ‰“åŒ…åˆ°æŒ‡å®šç›®å½•éœ€è¦åœ¨<code>mini-css-extract-plugin</code>ä¸­é…ç½®<code>filename</code>å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  output: &#123;<br>    <span class="hljs-comment">//...</span><br>    publicPath: <span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-comment">// ğŸ‘ˆ è¿™é‡Œé…åˆoutput.publicPath</span><br>  &#125;<br>  plugins: [<br>    <span class="hljs-keyword">new</span> MiniCssExtractPlugin(&#123;<br>      <span class="hljs-comment">// ğŸ‘‡ â­ </span><br>      filename: <span class="hljs-string">&#x27;css/[name].[contenthash].css&#x27;</span> <span class="hljs-comment">// æˆ– &#x27;static/css/[name].[contenthash].css&#x27;     </span><br>    &#125;)<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="hash-ã€-chunkhash-ã€-contenthash"><a href="#hash-ã€-chunkhash-ã€-contenthash" class="headerlink" title="[hash]ã€[chunkhash]ã€[contenthash]"></a>[hash]ã€[chunkhash]ã€[contenthash]</h3><p>ä»¥ä¸Šä¸‰ä¸ªæ–‡ä»¶åå ä½ç¬¦å¯ä»¥å«åš<strong>æ–‡ä»¶æŒ‡çº¹</strong>ã€‚</p>
<p>åŒºåˆ«åœ¨äºï¼š</p>
<ul>
<li><p>[hash]ï¼šåŒä¸€æ¬¡webpackæ‰“åŒ…çš„æ‰€æœ‰æ–‡ä»¶å…·æœ‰åŒä¸€ä¸ª[hash]ã€‚</p>
</li>
<li><p>[chunkhash]ï¼šå³ä½¿è¿›è¡Œå¤šæ¬¡æ‰“åŒ…ï¼Œåªè¦åŒä¸€ä¸ªchunkå†…çš„æ¨¡å—æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œ[chunkhash]ä¸å˜ã€‚</p>
</li>
<li><p>[contenthash]ï¼šè¯¥å“ˆå¸Œå€¼åªä¸æ–‡ä»¶å†…å®¹æœ‰å…³ï¼Œæ–‡ä»¶å†…å®¹æ”¹å˜è¯¥å“ˆå¸Œå€¼æ‰ä¼šæ”¹å˜ã€‚</p>
</li>
</ul>
<h2 id="å¤„ç†CSSå…¼å®¹æ€§é—®é¢˜"><a href="#å¤„ç†CSSå…¼å®¹æ€§é—®é¢˜" class="headerlink" title="å¤„ç†CSSå…¼å®¹æ€§é—®é¢˜"></a>å¤„ç†CSSå…¼å®¹æ€§é—®é¢˜</h2><p>æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨<code>postcss</code>æ¥å¤„ç†csså…¼å®¹æ€§é—®é¢˜ï¼Œä¸ºå„ç§æ ·å¼æ·»åŠ å‚å•†å‰ç¼€ã€‚</p>
<p>ä½¿ç”¨<code>postcss-loader</code>å’Œ <code>postcss-preset-env</code>å¸®åŠ©æˆ‘ä»¬æ ¹æ®éœ€è¦é€‚é…çš„æµè§ˆå™¨ç‰ˆæœ¬å¯¹cssè¿›è¡Œå…¼å®¹æ€§å¤„ç†ã€‚</p>
<blockquote>
<p><strong>postcss-preset-dev</strong> çš„ä½œç”¨æ˜¯å¸®åŠ© <strong>postcss-loader</strong> è¯»å– <strong>browserslist</strong> å®šä¹‰çš„å„ç§ç¯å¢ƒä¸‹éœ€è¦é€‚é…çš„æµè§ˆå™¨ç‰ˆæœ¬ï¼Œå†æ ¹æ®å½“å‰è¿è¡Œç¯å¢ƒ  <strong>process.env.BROWSERSLIST_ENV</strong>  ï¼Œå¤„ç†cssæ ·å¼ã€‚</p>
</blockquote>
<h3 id="æ–°ç‰ˆpostcss-loader"><a href="#æ–°ç‰ˆpostcss-loader" class="headerlink" title="æ–°ç‰ˆpostcss-loader"></a>æ–°ç‰ˆpostcss-loader</h3><p><strong>é…ç½®æ­¥éª¤ï¼š</strong></p>
<p><strong>1. é¦–å…ˆä¸‹è½½éœ€è¦çš„åŒ…<code>postcss-loader postcss-preset-env</code></strong></p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">npm <span class="hljs-keyword">install</span> postcss-loader postcss-preset-env -D<br></code></pre></td></tr></table></figure>
<p><strong>2. é…ç½®<code>browserslist</code>ï¼Œå£°æ˜å„ä¸ªç¯å¢ƒä¸‹éœ€è¦é€‚é…çš„æµè§ˆå™¨ç‰ˆæœ¬ï¼Œä»¥ä¸‹ä¸¤ç§æ–¹æ³•å–å…¶ä¸€ï¼š</strong></p>
<p>â­æ–¹æ³•1ï¼šåœ¨<code>package.json</code>çš„<code>browserslist</code>å­—æ®µä¸­å£°æ˜ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs json"># package.json<br>&#123;<br>  <span class="hljs-comment">//...</span><br>  browserslist: &#123;<br>    <span class="hljs-comment">/* ç”Ÿå¼€å‘ç¯å¢ƒéœ€è¦å…¼å®¹çš„æµè§ˆå™¨ */</span><br>    &quot;development&quot;: [ <br>      &quot;last 1 chrome version&quot;,<br>      &quot;last 1 firefox version&quot;,<br>      <span class="hljs-string">&quot;last 1 safari version&quot;</span><br>    ],<br>    <span class="hljs-comment">/* ç”Ÿäº§ç¯å¢ƒéœ€è¦å…¼å®¹çš„æµè§ˆå™¨ */</span><br>    &quot;production&quot;: [<br>      &quot;&gt; 1%&quot;,<br>      &quot;not dead&quot;,<br>      <span class="hljs-string">&quot;not op_mini all&quot;</span><br>    ],<br>    <span class="hljs-comment">/* è‡ªå®šä¹‰çš„ç¯å¢ƒ1 */</span><br>    &quot;chrome&quot;: [<br>      <span class="hljs-string">&quot;last 1 chrome version&quot;</span><br>    ],<br>    <span class="hljs-comment">/* è‡ªå®šä¹‰çš„ç¯å¢ƒ2 */</span><br>    &quot;modern&quot;: [<br>      <span class="hljs-string">&quot;&gt; 10%&quot;</span><br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>â­æ–¹æ³•2ï¼šåœ¨å·¥ç¨‹ç›®å½•ä¸‹çš„<code>.browserslistrc</code>æ–‡ä»¶ä¸­å£°æ˜ã€‚</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs vim">[development]<br>  <span class="hljs-keyword">last</span> <span class="hljs-number">1</span> chrome <span class="hljs-keyword">version</span><br>  <span class="hljs-keyword">last</span> <span class="hljs-number">1</span> firefox <span class="hljs-keyword">version</span><br>  <span class="hljs-keyword">last</span> <span class="hljs-number">1</span> safari <span class="hljs-keyword">version</span><br>[production]<br>  &gt; <span class="hljs-number">1</span>%<br>  not dead<br>  not op_mini <span class="hljs-keyword">all</span><br>[chrome]<br>	<span class="hljs-keyword">last</span> <span class="hljs-number">1</span> <span class="hljs-keyword">version</span> chrome<br>[modern]<br>	&gt; <span class="hljs-number">10</span>%<br></code></pre></td></tr></table></figure>


<p><strong>3. åœ¨<code>webpack.config.js</code>ä¸­é…ç½®<code>postcss-loader</code>å¯¹cssæ–‡ä»¶è¿›è¡Œå¤„ç†</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-comment">// ğŸ‘‡ æœ€è¿‘ç‰ˆæœ¬çš„postcss-loaderç»“åˆpostcss-preset-envçš„é…ç½®å¦‚ä¸‹</span><br><span class="hljs-keyword">const</span> postcssLoaderOptions = &#123;<br>  postcssOptions: &#123;<br>    plugins: [<span class="hljs-string">&#x27;postcss-preset-env&#x27;</span>]<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// process.env.BROWSERSLIST_ENV = &#x27;production&#x27;;</span><br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      <span class="hljs-comment">//...</span><br>      &#123;<br>        test: <span class="hljs-regexp">/\.css$/</span>,<br>        use: [<br>          MiniCssExtractPlugin.loader,<br>          <span class="hljs-string">&#x27;css-loader&#x27;</span>,<br>          <span class="hljs-comment">//ğŸ‘‡ å¼€å§‹é…ç½®postcss-loader</span><br>          &#123;<br>            loader: <span class="hljs-string">&#x27;postcss-loader&#x27;</span>,<br>            options: postcssLoaderOptions<br>          &#125;<br>        ]<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>â­ é»˜è®¤æƒ…å†µä¸‹ï¼Œpostcss-preset-envä¼šå‘Šè¯‰postcss-loaderå…¼å®¹<strong>ç”Ÿäº§ç¯å¢ƒ</strong>ä¸‹çš„æµè§ˆå™¨ã€‚</p>
<p>å¦‚æœåœ¨å¼€å‘ç¯å¢ƒä¸‹ï¼Œåªéœ€è¦å…¼å®¹å¼€å‘ç¯å¢ƒéœ€è¦å…¼å®¹çš„æµè§ˆå™¨ï¼Œåˆ™åº”è¯¥åœ¨webpack.config.jsä¸­é€šè¿‡process.env.BROWSERSLIST_ENVå£°æ˜ç¯å¢ƒä¸ºå¼€å‘ç¯å¢ƒæˆ–å…¶ä»–åœ¨browserslistä¸­å£°æ˜çš„ç¯å¢ƒã€‚</p>
</blockquote>
<p><strong>4. å£°æ˜ä½•ç§ç¯å¢ƒä¸‹çš„æµè§ˆå™¨</strong></p>
<p>é€šè¿‡ä¿®æ”¹<code>process.env.BROWERSLIST_ENV</code>ç¯å¢ƒå˜é‡ï¼Œå‘Šè¯‰<code>postcss</code>å½“å‰è¿è¡Œç¯å¢ƒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-comment">//ğŸ‘‡â­</span><br>process.env.BROWSERSLIST_ENV = <span class="hljs-string">&#x27;development&#x27;</span>; <span class="hljs-comment">// é»˜è®¤æƒ…å†µä¸‹è¯¥å€¼æ˜¯&quot;production&quot;</span><br><br><span class="hljs-keyword">const</span> postcssLoaderOptions = &#123;<br>  postcssOptions: &#123;<br>    plugins: [<span class="hljs-string">&#x27;postcss-preset-env&#x27;</span>]<br>  &#125;<br>&#125;<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      <span class="hljs-comment">//...</span><br>      &#123;<br>        test: <span class="hljs-regexp">/\.css$/</span>,<br>        use: [<br>          MiniCssExtractPlugin.loader,<br>          <span class="hljs-string">&#x27;css-loader&#x27;</span>,<br>          &#123;<br>            loader: <span class="hljs-string">&#x27;postcss-loader&#x27;</span>,<br>            options: postcssLoaderOptions<br>          &#125;<br>        ]<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="æ—§ç‰ˆpostcss-loaderçš„options"><a href="#æ—§ç‰ˆpostcss-loaderçš„options" class="headerlink" title="æ—§ç‰ˆpostcss-loaderçš„options"></a>æ—§ç‰ˆpostcss-loaderçš„options</h3><p>æ—§ç‰ˆ<code>postcss-loader</code>ç»“åˆ<code>postcss-preset-env</code>çš„<code>options</code>çš„å†™æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-comment">// ğŸ‘‡ â­åªéœ€è¦å°†postcssLoaderOptionsä¿®æ”¹ä¸ºï¼š</span><br><span class="hljs-keyword">const</span> postcssLoaderOptions = &#123;<br>  ident: <span class="hljs-string">&#x27;postcss&#x27;</span>,<br>  plugins: <span class="hljs-function">() =&gt;</span> [<br>    <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;postcss-preset-env&#x27;</span>)()<br>  ]<br>&#125;<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      <span class="hljs-comment">//...</span><br>      &#123;<br>        test: <span class="hljs-regexp">/\.css$/</span>,<br>        use: [<br>          MiniCssExtractPlugin.loader,<br>          <span class="hljs-string">&#x27;css-loader&#x27;</span>,<br>          <span class="hljs-comment">//ğŸ‘‡ å¼€å§‹é…ç½®postcss-loader</span><br>          &#123;<br>            loader: <span class="hljs-string">&#x27;postcss-loader&#x27;</span>,<br>            options: postcssLoaderOptions<br>          &#125;<br>        ]<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h2 id="å¤„ç†Sasså’ŒLess"><a href="#å¤„ç†Sasså’ŒLess" class="headerlink" title="å¤„ç†Sasså’ŒLess"></a>å¤„ç†Sasså’ŒLess</h2><h3 id="å¤„ç†scss"><a href="#å¤„ç†scss" class="headerlink" title="å¤„ç†scss"></a>å¤„ç†scss</h3><p>é¦–å…ˆä¸‹è½½éœ€è¦çš„åŒ… <code>npm install sass sass-loader -D</code></p>
<p>ç„¶ååœ¨è¿›è¡Œé…ç½®ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-keyword">const</span> MiniCssExtractPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;mini-css-extract-plugin&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      <span class="hljs-comment">//...</span><br>      &#123;<br>        test: <span class="hljs-regexp">/\.scss$/</span>,<br>        use: [<br>          MiniCssExtractPlugin.loader,<br>          <span class="hljs-string">&#x27;css-loader&#x27;</span>,<br>          <span class="hljs-string">&#x27;sass-loader&#x27;</span><br>        ]<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="å¤„ç†less"><a href="#å¤„ç†less" class="headerlink" title="å¤„ç†less"></a>å¤„ç†less</h3><p>é¦–å…ˆä¸‹è½½éœ€è¦çš„åŒ… <code>npm install less less-loader -D</code></p>
<p>ç„¶ååœ¨è¿›è¡Œé…ç½®ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-keyword">const</span> MiniCssExtractPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;mini-css-extract-plugin&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      <span class="hljs-comment">//...</span><br>      &#123;<br>        test: <span class="hljs-regexp">/\.scss$/</span>,<br>        use: [<br>          MiniCssExtractPlugin.loader,<br>          <span class="hljs-string">&#x27;css-loader&#x27;</span>,<br>          <span class="hljs-string">&#x27;less-loader&#x27;</span><br>        ]<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="é…åˆpostcssä½¿ç”¨"><a href="#é…åˆpostcssä½¿ç”¨" class="headerlink" title="é…åˆpostcssä½¿ç”¨"></a>é…åˆpostcssä½¿ç”¨</h3><p>ä»¥å¤„ç†sassä¸ºä¾‹ï¼Œéœ€è¦é…ç½®<code>sass-loader</code>å¤„ç†<code>.scss</code>æ–‡ä»¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-keyword">const</span> MiniCssExtractPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;mini-css-extract-plugin&#x27;</span>);<br><br><span class="hljs-comment">// ğŸ‘‡ å®šä¹‰ä¸€èˆ¬cssçš„å¤„ç†æµç¨‹ä½¿ç”¨åˆ°çš„loaderæ•°ç»„</span><br><span class="hljs-keyword">const</span> cssProcessingLoaders = [<br>  MiniCssExtractPlugin.loader,<br>  <span class="hljs-string">&#x27;css-loader&#x27;</span>,<br>  &#123;<br>    loader: <span class="hljs-string">&#x27;postcss-loader&#x27;</span>,<br>    options: &#123;<br>      postcssOptions: &#123;<br>        plugins: [<span class="hljs-string">&#x27;postcss-preset-env&#x27;</span>],<br>      &#125;,<br>    &#125;,<br>  &#125;,<br>];<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      <span class="hljs-comment">//...</span><br>      &#123;<br>        test: <span class="hljs-regexp">/\.scss$/</span>,<br>        use: [...cssProcessingLoaders, <span class="hljs-string">&#x27;sass-loader&#x27;</span>],<br>      &#125;,<br>    ],<br>  &#125;,<br>&#125;;<br><br></code></pre></td></tr></table></figure>



<h2 id="å¤„ç†JSå…¼å®¹æ€§é—®é¢˜"><a href="#å¤„ç†JSå…¼å®¹æ€§é—®é¢˜" class="headerlink" title="å¤„ç†JSå…¼å®¹æ€§é—®é¢˜"></a>å¤„ç†JSå…¼å®¹æ€§é—®é¢˜</h2><h3 id="æ–¹æ¡ˆä¸€"><a href="#æ–¹æ¡ˆä¸€" class="headerlink" title="æ–¹æ¡ˆä¸€"></a>æ–¹æ¡ˆä¸€</h3><p>ä¸åŒæµè§ˆå™¨å¯¹<code>ECMAScript</code>çš„ç‰ˆæœ¬æ”¯æŒä¸åŒï¼Œæ‰€ä»¥å¯¹ä¸åŒçš„æµè§ˆå™¨éœ€è¦åš<strong>JSè¯­æ³•çš„å…¼å®¹æ€§å¤„ç†</strong>ã€‚</p>
<p>æ¨èçš„åšæ³•æ˜¯æ ¹æ®éœ€è¦é€‚é…çš„æµè§ˆå™¨ç¯å¢ƒï¼ŒåŠ¨æ€è°ƒæ•´polyfillçš„å†…å®¹ï¼š</p>
<p><strong>1. ä¸‹è½½<code>babel-loader</code>ã€<code>@bable/core</code>ã€<code>@bable/preset-env</code>ã€<code>core-js</code></strong></p>
<ul>
<li><code>babel-loader</code>æ˜¯ä¸€ä¸ªloaderï¼Œç›¸å½“äºå¤„ç†å…¼å®¹æ€§çš„å…¥å£ã€‚</li>
<li><code>@bable/core</code>æ˜¯babelçš„æ ¸å¿ƒï¼Œè´Ÿè´£æ§åˆ¶å¤„ç†æµç¨‹ã€‚</li>
<li><code>@bable/preset-env</code>æ ¹æ®æ‰€è¦å…¼å®¹çš„ç¯å¢ƒï¼ŒæŒ‡ç¤º<strong>babel</strong>å¦‚ä½•åšæœ€åŸºæœ¬çš„JSè¯­æ³•å…¼å®¹æ€§å¤„ç†ã€‚</li>
<li><code>core-js</code>ç”¨æ¥æŒ‡ç¤º<strong>bable</strong>æŒ‰éœ€åšæ›´é«˜çº§çš„JSè¯­æ³•å…¼å®¹å¤„ç†ï¼Œå¦‚ <strong>promise</strong>ã€‚</li>
</ul>
<p><strong>2. é…ç½®<code>babel-loader</code>ï¼Œä½†å…¶<code>options</code>æœ‰ä¸¤ç§å†™æ³•ï¼š</strong></p>
<p>â­ æ–¹æ³•1ï¼š å†…è”åœ¨<code>webpack.config.js</code>ä¸­</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      <span class="hljs-comment">//...</span><br>      &#123;<br>        test: <span class="hljs-regexp">/\.js$/</span>,<br>        exclude: <span class="hljs-regexp">/node_modules/</span>, <span class="hljs-comment">// â­â­â­ ä¸€å®šè¦å»é™¤node_modulesï¼Œä¸å¯¹ç¬¬ä¸‰æ–¹åŒ…åšå…¼å®¹å¤„ç†</span><br>        												<span class="hljs-comment">// å¦åˆ™ä¼šäº§ç”Ÿä¸å¯é¢„è®¡çš„åæœã€‚	</span><br>        loader: <span class="hljs-string">&#x27;babel-loader&#x27;</span>,<br>        <span class="hljs-comment">// å¼€å§‹å¯¹babel-loaderè¿›è¡Œé…ç½®ï¼Œä¹Ÿå¯ä»¥ç”¨use &#123;loader: &#x27;babel-loader&#x27;, options:&#123;...&#125;&#125;</span><br>        options: &#123;<br>          presets: [<br>            [ <span class="hljs-comment">// ğŸ‘ˆ æ³¨æ„è¿™é‡Œåˆæœ‰ä¸€å±‚æ•°ç»„ï¼Œ</span><br>              <span class="hljs-comment">//    æ‰€æœ‰babelé¢„è®¾å’Œæ’ä»¶å¦‚æœéœ€è¦æ·»åŠ å‚æ•°ï¼Œå†™æ³•æ˜¯ï¼š[preset/plugin, optionsObject]</span><br>              <span class="hljs-string">&#x27;@babel/preset-env&#x27;</span>,<br>              <span class="hljs-comment">// ğŸ‘‡ @babel/preset-env.options</span><br>              &#123;<br>                modules: <span class="hljs-literal">false</span>, <span class="hljs-comment">// ğŸ‘ˆ è¯¥å­—æ®µä¸tree-shakingç›¸å…³</span><br>                <br>                useBuiltIns: <span class="hljs-string">&#x27;usage&#x27;</span>, <span class="hljs-comment">// ğŸ‘ˆ æ ¹æ®å…·ä½“çš„æµè§ˆå™¨è¿è¡Œç¯å¢ƒï¼Œè°ƒæ•´polyfillï¼ŒæŒ‰éœ€åŠ è½½ã€‚</span><br>                <br>                corejs: &#123;<br>                  version: <span class="hljs-number">3</span>,<br>                &#125;,<br>                <br>                targets: &#123;  <br>                  chrome: <span class="hljs-string">&quot;60&quot;</span>,<br>                  ie: <span class="hljs-string">&quot;9&quot;</span><br>                &#125;<br>             	<span class="hljs-comment">// targetsçš„ç±»å‹å¯ä»¥æ˜¯string | Array&lt;string&gt; | &#123; [string]: string &#125;</span><br>                <span class="hljs-comment">// é»˜è®¤å€¼æ˜¯ &#123;&#125;ï¼Œå°†æ‰€æœ‰çš„ES2015-ES2020è½¬ä¸ºES5. æ³¨: ES2015 = ES6</span><br>                targets: <span class="hljs-string">&#x27;&gt; 0.25%, not dead&#x27;</span>,<br>                targets: [<span class="hljs-string">&#x27;&gt; 0.25%&#x27;</span>, <span class="hljs-string">&#x27;not dead&#x27;</span>, <span class="hljs-string">&#x27;not op_mini all&#x27;</span>]<br>              &#125;<br>            ]<br>          ]<br>        &#125;<br>      &#125;,<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>â­ æ–¹æ³•2ï¼š<code>options</code>åˆ†ç¦»åˆ°<code>.babelrc</code>ä¸­</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># .babelrc<br>&#123;<br>  <span class="hljs-string">&quot;presets&quot;</span>: [<br>    [<br>      <span class="hljs-string">&quot;@babel/preset-env&quot;</span>,<br>      &#123;<br>        <span class="hljs-string">&quot;modules&quot;</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-string">&quot;useBuiltIns&quot;</span>: <span class="hljs-string">&quot;usage&quot;</span>,<br>        <span class="hljs-string">&quot;corejs&quot;</span>: &#123;<br>          <span class="hljs-string">&quot;version&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>  <span class="hljs-comment">// æ•°å­—æˆ–è€…å­—ç¬¦ä¸²éƒ½å¯ä»¥ï¼Œå…·ä½“åˆ°ç‰ˆæœ¬å·ç¬¬ä¸€ä½å³å¯</span><br>        &#125;,<br>        <span class="hljs-string">&quot;targets&quot;</span>: &#123;<br>          <span class="hljs-string">&quot;chrome&quot;</span>: <span class="hljs-string">&quot;60&quot;</span>, <span class="hljs-comment">// æ•°å­—æˆ–è€…å­—ç¬¦ä¸²éƒ½å¯ä»¥ï¼Œå°½é‡å†™å­—ç¬¦ä¸²</span><br>          <span class="hljs-string">&quot;ie&quot;</span>: <span class="hljs-string">&quot;9&quot;</span> <span class="hljs-comment">// æ•°å­—æˆ–è€…å­—ç¬¦ä¸²éƒ½å¯ä»¥ï¼Œå°½é‡å†™å­—ç¬¦ä¸²</span><br>        &#125;<br>      &#125;<br>    ]<br>  ],<br>  <span class="hljs-string">&quot;plugins&quot;</span>: []<br>&#125;<br><span class="hljs-comment">// ä»¥ä¸‹æ˜¯.babelrcæœ€åŸºæœ¬çš„ç»“æ„</span><br>&#123;<br>  <span class="hljs-string">&quot;preset&quot;</span>: [],<br>  <span class="hljs-string">&quot;plugins&quot;</span>: []<br>&#125;<br><span class="hljs-comment">//=======================================================================</span><br># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      <span class="hljs-comment">//...</span><br>      &#123;<br>        test: <span class="hljs-regexp">/\.js$/</span>,<br>        exclude: <span class="hljs-regexp">/node_modules/</span>, <span class="hljs-comment">// ğŸ‘ˆ â­â­ ä¸€å®šè¦å»é™¤node_modulesï¼Œä¸å¯¹ç¬¬ä¸‰æ–¹åŒ…åšå…¼å®¹å¤„ç†</span><br>     	loader: <span class="hljs-string">&#x27;babel-loader&#x27;</span>,<br>      &#125;,<br> ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="æ–¹æ¡ˆäºŒ"><a href="#æ–¹æ¡ˆäºŒ" class="headerlink" title="æ–¹æ¡ˆäºŒ"></a>æ–¹æ¡ˆäºŒ</h3><p><strong>ä½¿ç”¨ï¼š</strong><code>@babel/preset-env</code>+ <code>@babel/plugin-transform-runtime</code>  + <code>@babel/runtime-corejs3</code></p>
<p><strong>ä½¿ç”¨æ–¹æ¡ˆäºŒçš„å¥½å¤„ï¼š</strong></p>
<ol>
<li><p>åŒæ ·å¯ä»¥æ ¹æ®<code>@babel/preset-env.options.targets</code>è®¾å®šçš„ç›®æ ‡å…¼å®¹ç¯å¢ƒè¿›è¡ŒJSçš„è½¬è¯‘ã€‚</p>
</li>
<li><p>æ–°å¢çš„<code>api</code>éƒ½ä¼šä»<code>runtime-corejs3</code>æä¾›çš„ç»Ÿä¸€å‘½åç©ºé—´ä¸­è·å–ï¼Œ<font color='red'>ä¸ä¼šæ±¡æŸ“å½“å‰ç¯å¢ƒã€‚</font></p>
<p>ä¾‹å¦‚ IE9 ä¸æ”¯æŒPromiseï¼Œä½¿ç”¨æ–¹æ¡ˆäºŒåï¼Œåœ¨å…¨å±€ä»ç„¶ä¸å­˜åœ¨<code>window.Promise</code>ã€‚</p>
</li>
<li><p>æ–¹æ¡ˆä¸€ä¸­æ¯ä¸ªæ¨¡å—ä¸­éƒ½ä¼šå«æœ‰å¸®åŠ©è½¬è¯‘è¯­æ³•çš„<code>helper</code>æ–¹æ³•ï¼Œä¸åŒçš„æ‰“åŒ…ç»“æœä¼šå«æœ‰é‡å¤çš„<code>helper</code>ä»£ç ã€‚</p>
<p>æ–¹æ¡ˆäºŒä¼šä»<code>runtime-corejs3</code>æä¾›çš„ç»Ÿä¸€å‘½åç©ºé—´ä¸­è·å–<code>helpers</code>ã€‚</p>
</li>
</ol>
<blockquote>
<p>ä½†ä½¿ç”¨æ–¹æ¡ˆäºŒæœ‰æ—¶å€™æ‰“åŒ…çš„ç»“æœè¿˜æ˜¯æ¯”æ–¹æ¡ˆä¸€æ¥çš„å¤§ã€‚ã€‚ä¸çŸ¥é“æ˜¯ä¸ºä»€ä¹ˆã€‚ã€‚ã€‚</p>
<p>æ‰€ä»¥æ–¹æ¡ˆäºŒçš„æœ€å¤§å¥½å¤„è¿˜æ˜¯å¯ä»¥é¿å…æ±¡æŸ“ç¯å¢ƒå§ã€‚ã€‚</p>
</blockquote>
<p><strong>ä½¿ç”¨æ­¥éª¤ï¼š</strong></p>
<ol>
<li><p>å®‰è£…<code>babel-loader</code>ã€<code>@babel/core</code>ã€<code>@babel/preset-env</code>ã€<code>@babel/plugin-transform-runtime</code>ã€<code>@babel/runtime-corejs3</code>ã€‚</p>
<blockquote>
<p>@babel/runtime-corejs3åŒ…å«äº†corejs3å’Œ@babel/runtimeã€‚</p>
</blockquote>
</li>
<li><p>é…ç½®<code>babel-loader</code>å¤„ç†JSæ–‡ä»¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      &#123;<br>        test: <span class="hljs-regexp">/\.js$/</span>,<br>        loader: <span class="hljs-string">&#x27;babel-loader&#x27;</span>,<br>        options: &#123;<br>          presets: [<br>            [<span class="hljs-string">&#x27;@babel/preset-env&#x27;</span>, &#123;<br>              modules: <span class="hljs-literal">false</span>,  <span class="hljs-comment">// ä¸å…è®¸å°†ES6æ¨¡å—åŒ–è¯­æ³•è½¬è¯‘ï¼Œå’Œtree-shakingæœ‰å…³</span><br>              targets: <span class="hljs-string">&quot;ie&gt;=9&quot;</span>, <span class="hljs-comment">// ğŸ‘ˆ å£°æ˜éœ€è¦å…¼å®¹çš„ç¯å¢ƒ</span><br>            &#125;]<br>          ],<br>          plugins: [<br>            [<span class="hljs-string">&#x27;@babel/plugin-transform-runtime&#x27;</span>, &#123;<br>              corejs: &#123;<br>                version: <span class="hljs-string">&quot;3&quot;</span>,<br>              &#125;<br>            &#125;],<br>          ]<br>        &#125;,<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


</li>
</ol>
<h3 id="å¼€å¯babelç¼“å­˜"><a href="#å¼€å¯babelç¼“å­˜" class="headerlink" title="å¼€å¯babelç¼“å­˜"></a>å¼€å¯babelç¼“å­˜</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      &#123;<br>        test: <span class="hljs-regexp">/\.js$/</span>,<br>        loader: <span class="hljs-string">&#x27;babel-loader&#x27;</span>,<br>        options: &#123;<br>          cacheDirectory: <span class="hljs-literal">true</span>, <span class="hljs-comment">// ğŸ‘ˆ æ„å»ºæ—¶ä¼šè¯»å–ä¸Šä¸€æ¬¡çš„ç¼“å­˜</span><br>          <span class="hljs-comment">//.....</span><br>        &#125;,<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>




<h3 id="å¯¹Webpack5çš„ç‰¹æ®Šå¤„ç†"><a href="#å¯¹Webpack5çš„ç‰¹æ®Šå¤„ç†" class="headerlink" title="å¯¹Webpack5çš„ç‰¹æ®Šå¤„ç†"></a>å¯¹Webpack5çš„ç‰¹æ®Šå¤„ç†</h3><p>ç”±äºwebpack5åœ¨æ‰“åŒ…åçš„JSä»£ç ç”±ä¸€ä¸ªç®­å¤´å‡½æ•°åŒ…è£¹ï¼Œæ‰€ä»¥åœ¨ä¸æ”¯æŒES6çš„æµè§ˆå™¨ä¸­è¿è¡Œä¸äº†webpack5æ‰“åŒ…çš„ç»“æœã€‚</p>
<p>å› æ­¤ï¼Œå¦‚æœæ˜¯ç”¨webpack5æ„å»ºé¡¹ç›®ï¼Œåœ¨ä¸Šè¿°çš„é…ç½®çš„åŸºç¡€ä¸Šï¼Œéœ€è¦å¤šå¢åŠ ä¸€æ¡é…ç½®ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">// ğŸ‘‡ </span><br>  target: [<span class="hljs-string">&#x27;web&#x27;</span>, <span class="hljs-string">&#x27;es5&#x27;</span>],<br>&#125;<br></code></pre></td></tr></table></figure>
<p>å¢åŠ è¯¥æ¡é…ç½®åï¼Œæœ€å¤–å±‚çš„ç®­å¤´å‡½æ•°å°±ä¼šå˜ä¸ºæ™®é€šå‡½æ•°ã€‚</p>
<h2 id="é…ç½®ESlintå’Œairbnbè¯­æ³•è§„èŒƒ"><a href="#é…ç½®ESlintå’Œairbnbè¯­æ³•è§„èŒƒ" class="headerlink" title="é…ç½®ESlintå’Œairbnbè¯­æ³•è§„èŒƒ"></a>é…ç½®ESlintå’Œairbnbè¯­æ³•è§„èŒƒ</h2><p><strong>1. é¦–å…ˆå®‰è£…<code>eslint</code>ã€<code>eslint-loader</code>ã€<code>eslint-config-airbnb-base</code>ã€<code>eslint-plugin-import</code></strong></p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">npm i eslint eslint-loader eslint-<span class="hljs-built_in">config</span>-airbnb-base eslint-plugin-<span class="hljs-keyword">import</span> -D<br></code></pre></td></tr></table></figure>
<p><strong>2. åœ¨<code>webpack.config.js</code>ä¸­é…ç½®<code>eslint-loader</code></strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      <span class="hljs-comment">//...</span><br>      &#123;<br>        test: <span class="hljs-regexp">/\.js$/</span>,<br>        loader: <span class="hljs-string">&#x27;eslint-loader&#x27;</span>,<br>        exclude: <span class="hljs-regexp">/node_modules/</span>, <span class="hljs-comment">// â­â­ ä¸å¯¹node_modulesç›®å½•ä¸‹çš„ç¬¬ä¸‰æ–¹æ¨¡å—ä½œæ£€æŸ¥</span><br>        enforce: <span class="hljs-string">&#x27;pre&#x27;</span>, <span class="hljs-comment">// â­â­ å¼ºåˆ¶è¯¥eslint-loaderæœ€å…ˆæ‰§è¡Œ </span><br>        options: &#123;<br>          fix: <span class="hljs-literal">true</span> <span class="hljs-comment">// é€šçŸ¥eslintè‡ªåŠ¨ä¿®æ”¹å¼€å‘æºç ä¸­é”™è¯¯çš„è¯­æ³•</span><br>        &#125;<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>3. é…ç½®<code>eslintConfig</code>ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼š</strong></p>
<p>â­æ–¹æ³•1ï¼šå†…è”åœ¨<code>package.json</code>ä¸­</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs json"># package.json<br>&#123;<br>  <span class="hljs-attr">&quot;eslintConfig&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;extends&quot;</span>: <span class="hljs-string">&quot;airbnb-base&quot;</span>, <span class="hljs-comment">// ç»§æ‰¿airbnb-baseçš„è§„åˆ™</span><br>    <span class="hljs-attr">&quot;env&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;browser&quot;</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// æŒ‰æµè§ˆå™¨ç¯å¢ƒè¯­æ³•è¿›è¡Œæ£€æŸ¥ï¼Œå…è®¸å­˜åœ¨windowç­‰å…¨å±€å¯¹è±¡</span><br>    &#125;,<br>    <span class="hljs-comment">// ğŸ‘‡ è¿˜å¯ä»¥è¦†ç›–æ‰airbnb-baseä¸­ä¸€äº›æ£€æŸ¥è§„åˆ™</span><br>    <span class="hljs-attr">&quot;rules&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;no-console&quot;</span>: <span class="hljs-string">&quot;off&quot;</span>, <span class="hljs-comment">// å…è®¸å‡ºç°console.logç­‰</span><br>      <span class="hljs-attr">&quot;no-alert&quot;</span>: <span class="hljs-string">&quot;off&quot;</span>, <span class="hljs-comment">// å…è®¸å‡ºç°alert()</span><br>      <span class="hljs-attr">&quot;linebreak-style&quot;</span>: <span class="hljs-string">&quot;off&quot;</span> <span class="hljs-comment">// ä¸æ£€æŸ¥æ¢è¡Œç¬¦æ˜¯LFè¿˜æ˜¯CRLF</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>â­æ–¹æ³•2ï¼šåˆ†ç¦»åˆ°å·¥ç¨‹ç›®å½•ä¸‹çš„<code>.eslintrc</code>æ–‡ä»¶ä¸­ï¼Œ<code>eslint</code>ä¼šè‡ªåŠ¨è¯»å–è¯¥æ–‡ä»¶ã€‚</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs json"># .eslintrc<br>&#123;<br>  <span class="hljs-attr">&quot;extends&quot;</span>: <span class="hljs-string">&quot;airbnb-base&quot;</span>,<br>  <span class="hljs-attr">&quot;env&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;browser&quot;</span>: <span class="hljs-literal">true</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;rules&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;no-console&quot;</span>: <span class="hljs-string">&quot;off&quot;</span>,<br>    <span class="hljs-attr">&quot;no-alert&quot;</span>: <span class="hljs-string">&quot;off&quot;</span>,<br>    <span class="hljs-attr">&quot;linebreak-style&quot;</span>: <span class="hljs-string">&quot;off&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>4. VSCodeä¸­å®‰è£…ESlintæ‰©å±•ï¼Œ åŒæ—¶åœ¨é¡¹ç›®ç›®å½•ä¸‹æ–°å¢<code>.eslintignore</code>æ–‡ä»¶</strong></p>
<blockquote>
<p>è¯¥æ­¥éª¤ä¸ºå¯é€‰ï¼Œç›®çš„æ˜¯è®©æ‰©å±•æ’ä»¶å¸®æˆ‘ä»¬åŠæ—¶æ£€æŸ¥å‡ºä»£ç ä¹¦å†™ä¸è§„èŒƒçš„åœ°æ–¹ï¼Œé¿å…ç¼–è¯‘æ—¶å†æŠ¥é”™ä¿®æ”¹ã€‚</p>
</blockquote>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># .eslintignore</span><br><span class="hljs-comment"># åœ¨å…è®¸vscodeè¯»å–å·¥ç¨‹ç›®å½•ä¸‹çš„eslinté…ç½®æ–‡ä»¶æ—¶ï¼Œ</span><br><span class="hljs-comment"># ESlintæ‰©å±•ä¼šæ ¹æ®.eslintrcä¸­é…ç½®çš„è§„åˆ™å¯¹å·¥ç¨‹ç›®å½•ä¸‹çš„æ–‡ä»¶è¿›è¡Œæ£€æŸ¥ï¼Œ</span><br><span class="hljs-comment"># åŒæ—¶è·³è¿‡.eslintignoreæŒ‡å®šçš„æ–‡ä»¶åŒºåŸŸ</span><br><br><span class="hljs-regexp">/dist/</span><br><span class="hljs-regexp">/node_modules/</span><br></code></pre></td></tr></table></figure>


<h2 id="å‹ç¼©é™æ€èµ„æº"><a href="#å‹ç¼©é™æ€èµ„æº" class="headerlink" title="å‹ç¼©é™æ€èµ„æº"></a>å‹ç¼©é™æ€èµ„æº</h2><h3 id="å‹ç¼©JS"><a href="#å‹ç¼©JS" class="headerlink" title="å‹ç¼©JS"></a>å‹ç¼©JS</h3><p>åœ¨Webpack4åŠå…¶ä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œåœ¨<code>production</code>æ¨¡å¼ä¸‹ï¼ŒWebpackä¼šè‡ªåŠ¨å°†æ‰“åŒ…åçš„JSä»£ç è¿›è¡Œå‹ç¼©ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  mode: <span class="hljs-string">&#x27;produciton&#x27;</span>,<br>  <span class="hljs-comment">//....</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="å‹ç¼©CSS"><a href="#å‹ç¼©CSS" class="headerlink" title="å‹ç¼©CSS"></a>å‹ç¼©CSS</h3><p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œwebpackä¼šè‡ªåŠ¨å‹ç¼©jsï¼Œä½†ä¸ä¼šå‹ç¼©cssèµ„æºã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬è¦ä½¿ç”¨<code>optimize-css-assets-webpack-plugin</code>æ’ä»¶æ¥å¸®åŠ©å‹ç¼©cssä»£ç ã€‚</p>
<p><strong>1. é¦–å…ˆå®‰è£…æ’ä»¶</strong></p>
<p><code>npm install optimize-css-assets-webpack-plugin</code></p>
<p><strong>2. ä½¿ç”¨æ’ä»¶</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-keyword">const</span> OptimizeCssAssetsWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;optimize-css-assets-webpack-plugin&#x27;</span>);<br><span class="hljs-comment">//...</span><br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  plugins: [<br>    <span class="hljs-keyword">new</span> OptimizeCssAssetsWebpackPlugin(), <span class="hljs-comment">// åœ¨è¿™é‡Œä½¿ç”¨æ’ä»¶å³å¯</span><br>  ],<br>  mode: <span class="hljs-string">&#x27;production&#x27;</span>, <span class="hljs-comment">// ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ ï¼ˆå¼€å‘ç¯å¢ƒä¸‹ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œé…ç½®å³å¯ï¼‰</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="å‹ç¼©HTML"><a href="#å‹ç¼©HTML" class="headerlink" title="å‹ç¼©HTML"></a>å‹ç¼©HTML</h3><p>åœ¨<strong>Webpack5</strong>ä¸­ï¼Œåœ¨<code>production</code>æ¨¡å¼ä¸‹ï¼ŒWebpackä¼šå‹ç¼©ç¼–è¯‘åçš„HTMLæ–‡ä»¶ï¼ˆæ¸…é™¤ç©ºç™½å­—ç¬¦+æ³¨é‡Šï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  mode: <span class="hljs-string">&#x27;produciton&#x27;</span>,<br>  <span class="hljs-comment">//....</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>è€Œåœ¨<strong>Webpack4</strong>ä¸­ï¼ŒWebpackæ˜¯ä¸ä¼šè‡ªåŠ¨æ‰“åŒ…HTMLçš„ï¼Œéœ€è¦ç”¨åˆ°æ‰“åŒ…æ—¶ç”¨åˆ°çš„æ’ä»¶<code>html-webpack-plugin</code>ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¦å¯¹æ‰“åŒ…HTMLçš„æ’ä»¶è¿›è¡Œé…ç½®ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-keyword">const</span> HTMLWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  mode: <span class="hljs-string">&#x27;produciton&#x27;</span>,<br>  <span class="hljs-comment">//....</span><br>  plugins: [<br>    <span class="hljs-keyword">new</span> HTMLWebpackPlugin(&#123;<br>      template: <span class="hljs-string">&#x27;./src/index.html&#x27;</span>,<br>      <span class="hljs-comment">//â­ é…ç½® minifyå‚æ•°</span><br>      minify: &#123;<br>        collapseWhitespace: <span class="hljs-literal">true</span>, <span class="hljs-comment">// å‹ç¼©ç©ºç™½å­—ç¬¦</span><br>        removeComments: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ¸…é™¤æ³¨é‡Š</span><br>      &#125;<br>    &#125;),<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="å‹ç¼©å›¾ç‰‡"><a href="#å‹ç¼©å›¾ç‰‡" class="headerlink" title="å‹ç¼©å›¾ç‰‡"></a>å‹ç¼©å›¾ç‰‡</h3><p>å‹ç¼©å›¾ç‰‡åï¼Œå›¾ç‰‡çš„è´¨é‡ä¼šä¸‹é™ã€‚</p>
<p><strong>ä½¿ç”¨loaderï¼š</strong><code>image-webpack-loader</code></p>
<p><strong>1. é¦–å…ˆå®‰è£…loader</strong></p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">npm install <span class="hljs-built_in">image</span>-webpack-loader -D<br></code></pre></td></tr></table></figure>
<blockquote>
<p>â— æ³¨æ„ï¼šè¿™ä¸ªåŒ…ä¸‹çš„ä¼šæœ‰ç‚¹æ…¢</p>
</blockquote>
<p><strong>2. å¯¹å›¾ç‰‡ä½¿ç”¨loader</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-comment">// åˆ†ç¦»å‡ºimage-webpack-loaderçš„é…ç½®</span><br><span class="hljs-comment">// ä»¥ä¸‹ä¸ºå®˜æ–¹å®ä¾‹çš„é…ç½® https://www.npmjs.com/package/image-webpack-loader</span><br><span class="hljs-keyword">const</span> imageWebpackLoaderOptions = &#123;<br>  mozjpeg: &#123;<br>    progressive: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-comment">// optipng.enabled: false will disable optipng</span><br>  optipng: &#123;<br>    enabled: <span class="hljs-literal">false</span>,<br>  &#125;,<br>  pngquant: &#123;<br>    quality: [<span class="hljs-number">0.65</span>, <span class="hljs-number">0.90</span>],<br>    speed: <span class="hljs-number">4</span><br>  &#125;,<br>  gifsicle: &#123;<br>    interlaced: <span class="hljs-literal">false</span>,<br>  &#125;,<br>  <span class="hljs-comment">// the webp option will enable WEBP</span><br>  webp: &#123;<br>    quality: <span class="hljs-number">75</span><br>  &#125;<br>&#125;<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      &#123;<br>        test: <span class="hljs-regexp">/\.(jpe?g|png|gif|svg|bmp)/</span>,<br>        use: [<br>          <span class="hljs-string">&#x27;file-loader&#x27;</span>,<br>          <span class="hljs-comment">// ğŸ‘‡ ä½¿ç”¨è¯¥loader</span><br>          &#123;<br>            loader: <span class="hljs-string">&#x27;image-webpack-loader&#x27;</span>,<br>            options: imageWebpackLoaderOptions<br>          &#125;,<br>        ]<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>






<h1 id="Webpacké«˜çº§åŠŸèƒ½"><a href="#Webpacké«˜çº§åŠŸèƒ½" class="headerlink" title="Webpacké«˜çº§åŠŸèƒ½"></a>Webpacké«˜çº§åŠŸèƒ½</h1><h2 id="devServer-â­"><a href="#devServer-â­" class="headerlink" title="devServer â­"></a>devServer â­</h2><h3 id="å¼€å¯devServer"><a href="#å¼€å¯devServer" class="headerlink" title="å¼€å¯devServer"></a>å¼€å¯devServer</h3><p>é…ç½®æœ¬åœ°å¼€å‘æœåŠ¡å™¨ï¼ŒåŸç†æ˜¯å°†æ‰“åŒ…çš„ç»“æœä¿å­˜åˆ°å†…å­˜ä¸­ã€‚</p>
<ol>
<li><p>é¦–å…ˆå®‰è£…<code>npm i webpack-dev-server -D</code></p>
</li>
<li><p>åœ¨<code>webpack.config.js</code>ä¸­é…ç½®<code>devServer</code>å­—æ®µï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  devServer: &#123;<br>    <span class="hljs-comment">//ğŸ‘‡ æ­¤æ¡æ˜¯é…ç½®devServeræœåŠ¡å™¨æ ¹ç›®å½•ï¼Œè¿™é‡Œå®šä½åˆ°æ‰“åŒ…åçš„distï¼Œè¦ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚</span><br>    contentBase: resolve(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>),<br>    <span class="hljs-comment">// ä»¥ä¸‹å†…å®¹ä¸ºå¯é€‰</span><br>    compress: <span class="hljs-literal">true</span>, <span class="hljs-comment">// ä¸€åˆ‡èµ„æºä½¿ç”¨gzipå‹ç¼©</span><br>    port: <span class="hljs-number">8080</span>, <span class="hljs-comment">// ç«¯å£å·</span><br>    open: <span class="hljs-literal">true</span> <span class="hljs-comment">// å¯åŠ¨æœåŠ¡åè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼Œé…ç½®åå°±ä¸éœ€è¦åœ¨è¿è¡ŒdevServeræ—¶è¾“å…¥--openå‚æ•°</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>åœ¨<code>package.json</code>ä¸­é…ç½®<code>scripts</code>è„šæœ¬</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json"># package.json<br>&#123;<br>  <span class="hljs-comment">/*....*/</span><br> 	<span class="hljs-attr">&quot;scripts&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;build&quot;</span>: <span class="hljs-string">&quot;webpack&quot;</span>,<br>    <span class="hljs-attr">&quot;dev&quot;</span>: <span class="hljs-string">&quot;webpack-dev-server --open&quot;</span>,<span class="hljs-comment">/* å¦‚æœé…ç½®äº†openä¸ºtrueï¼Œå°±ä¸éœ€è¦--open */</span><br>    <span class="hljs-comment">/* &quot;start&quot;: &quot;webpack serve --open&quot;  ğŸ‘ˆ webpack5 ä¸­çš„å‘½ä»¤è„šæœ¬ */</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>â—â— <strong>æ³¨æ„</strong>ï¼šåœ¨<code> webpack5</code> ä¸­ï¼Œè¿è¡Œ<code>webpack-dev-server</code>çš„å‘½ä»¤å‘ç”Ÿäº†å˜åŒ–ï¼Œéœ€è¦ç”¨<code>webpack serve</code>ä»£æ›¿åŸæ¥çš„<code>webpack-dev-server</code>å‘½ä»¤ã€‚</p>
</blockquote>
</li>
</ol>
<h3 id="proxy-ä»£ç†"><a href="#proxy-ä»£ç†" class="headerlink" title="proxy ä»£ç†"></a>proxy ä»£ç†</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-keyword">const</span> &#123; resolve &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  devServer: &#123;<br>    contentBase: resolve(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>),<br>    host: <span class="hljs-string">&#x27;localhost&#x27;</span>,<br>    port: <span class="hljs-number">8080</span>,<br>    compress: <span class="hljs-literal">true</span>,<br>    <span class="hljs-comment">// è½¬å‘å†™æ³•ï¼š</span><br>    proxy: &#123;<br>      <span class="hljs-string">&quot;/api&quot;</span>: <span class="hljs-string">&#x27;http://127.0.0.1:5000&#x27;</span>, <span class="hljs-comment">// å¦‚æœpathéƒ¨åˆ†ä»¥/apiå¼€å¤´ï¼Œå°†è¯·æ±‚è½¬å‘åˆ°æœ¬åœ°çš„5000ç«¯å£ã€‚</span><br>    &#125;,<br>    <span class="hljs-comment">// é‡å†™å†™æ³•ï¼š</span><br>    proxy: &#123;<br>      <span class="hljs-string">&quot;/api&quot;</span>: &#123;<br>        target: <span class="hljs-string">&#x27;http://127.0.0.1:5000&#x27;</span>,<br>        pathRewrite: &#123;<br>          <span class="hljs-string">&quot;^/api&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment">// ğŸ‘ˆ å°†å¼€å¤´çš„apiå»é™¤</span><br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>




<h3 id="æ¨¡æ‹Ÿæ¥å£"><a href="#æ¨¡æ‹Ÿæ¥å£" class="headerlink" title="æ¨¡æ‹Ÿæ¥å£"></a>æ¨¡æ‹Ÿæ¥å£</h3><p>ä½¿ç”¨devServerä¸­çš„beforeé’©å­æ¥ä¸ºå†…ç½®çš„expressæœåŠ¡å™¨æ·»åŠ è·¯ç”±ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-keyword">const</span> &#123; resolve &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><br><span class="hljs-keyword">const</span> mockUsers = [<br>  &#123;<span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;ley&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">24</span>&#125;,<br>  &#123;<span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;mz&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">23</span>&#125;,<br>]<br><span class="hljs-keyword">const</span> mockObj = &#123;<br>  foo: <span class="hljs-string">&#x27;bar&#x27;</span><br>&#125;<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  devServer: &#123;<br>    contentBase: resolve(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>),<br>    host: <span class="hljs-string">&#x27;localhost&#x27;</span>,<br>    port: <span class="hljs-number">8080</span>,<br>    compress: <span class="hljs-literal">true</span>,<br>	<span class="hljs-function"><span class="hljs-title">before</span>(<span class="hljs-params">app</span>)</span> &#123;<br>      app.get(<span class="hljs-string">&#x27;/api/home&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> res.redirect(<span class="hljs-string">&#x27;/&#x27;</span>));<br>      <span class="hljs-comment">// åœ¨è¿™é‡Œå°±å¯ä»¥åœ¨ä¸€äº›è·¯ç”±ä¸­è¿”å›mockæ•°æ®ã€‚</span><br>      app.get(<span class="hljs-string">&#x27;/api/users&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> res.json(mockUsers));<br>      app.get(<span class="hljs-string">&#x27;/api/obj&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> res.end(<span class="hljs-built_in">JSON</span>.stringify(mockObj)));<br>    &#125;,<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>webpack-dev-serverå®é™…æ˜¯ä¸€ä¸ªåŸºäºExpressæ¡†æ¶çš„æœåŠ¡å™¨ï¼Œbeforeé’©å­å‡½æ•°ä¼šåœ¨æœåŠ¡å™¨å¯åŠ¨å‰æ‰§è¡Œã€‚</p>
<p>å¯ä»¥åœ¨beforeé’©å­ä¸­æ‰©å±•devServeræœåŠ¡å™¨çš„åŠŸèƒ½ã€‚</p>
</blockquote>
<h2 id="one-of"><a href="#one-of" class="headerlink" title="one-of"></a>one-of</h2><p>webpackå¯¹å„ä¸ªæ¨¡å—çš„æ–‡ä»¶åè¿›è¡Œæ¨¡å¼åŒ¹é…æ—¶ï¼Œä¼šå°†æ¯ä¸ªæ–‡ä»¶ä¸module.rulesä¸­è®¾ç½®çš„æ¯æ¡è§„åˆ™è¿›è¡ŒåŒ¹é…ï¼Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹æ˜¯å¤šä½™çš„ã€‚æ¯”å¦‚è¯´cssæ–‡ä»¶åªä¼šäº¤ç”±ä¸€ç»„loaderå¤„ç†ï¼ˆstyle-loader, css-loaderï¼‰ï¼Œè€Œä¸ä¼šäº¤ç»™babel-loaderå¤„ç†ï¼Œæ‰€ä»¥æœ‰äº›æ¨¡å¼åŒ¹é…æ˜¯å¤šä½™çš„ã€‚</p>
<p>æ‰€ä»¥webpackæä¾›äº†one-ofåŠŸèƒ½ï¼Œå¯¹äºæŸäº›ç±»å‹æ–‡ä»¶ï¼ŒåªåŒ¹é…æŸä¸€æ¡è§„åˆ™ï¼Œå³åªäº¤ç”±ä¸€ç»„loaderå¤„ç†ï¼ŒåŒ¹é…æˆåŠŸåå°±ä¸å†ä¸å‰©ä½™çš„æ¨¡å¼è¿›è¡ŒåŒ¹é…ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// webpack.config.js</span><br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-built_in">module</span>: &#123;<br>        rules: [<br>            &#123;<br>                test: <span class="hljs-regexp">/\.js$/</span>,<br>                exclude: <span class="hljs-regexp">/node_modules/</span>,<br>                loader: <span class="hljs-string">&#x27;eslint-loader&#x27;</span>,<br>                enforce: <span class="hljs-string">&#x27;pre&#x27;</span><br>            &#125;,<br>            <br>            one-<span class="hljs-keyword">of</span>: [<br>            	&#123;<br>            		test: <span class="hljs-regexp">/\.css$/</span>,<br>            		use: [<span class="hljs-string">&#x27;style-loader&#x27;</span>, <span class="hljs-string">&#x27;css-loader&#x27;</span>]<br>        		&#125;, &#123;<br>    				test: <span class="hljs-regexp">/\.(jpe?g|png|gif|svg|bmp)/</span>,<br>    				use: <span class="hljs-string">&#x27;url-loader&#x27;</span><br>				&#125;,&#123;<br>    				test: <span class="hljs-regexp">/\.js$/</span>,<br>    				exclude: <span class="hljs-regexp">/node_modules/</span>,<br>    				loader: <span class="hljs-string">&#x27;babel-loader&#x27;</span><br>				&#125;<br>				<span class="hljs-comment">//....</span><br>            ]<br>        ]<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>






<h2 id="watch"><a href="#watch" class="headerlink" title="watch"></a>watch</h2><p>å¼€å¯webpackçš„watchåŠŸèƒ½ï¼Œå¯ä»¥åœ¨ä»£ç ä¿®æ”¹æ—¶è‡ªåŠ¨é‡æ–°ç¼–è¯‘</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  watch: <span class="hljs-literal">true</span>,<br>  watchOptions: &#123;<br>    ignored: <span class="hljs-regexp">/node_modules/</span>, <span class="hljs-comment">// ä¸éœ€è¦ç›‘å¬çš„å†…å®¹ï¼Œæ”¯æŒæ­£åˆ™</span><br>    aggregate: <span class="hljs-number">300</span>, <span class="hljs-comment">// èŠ‚æµæ—¶é—´ï¼Œå¼€å§‹é‡æ–°ç¼–è¯‘åï¼Œ300mså†…ä¸å†é‡æ–°ç¼–è¯‘</span><br>    poll: <span class="hljs-number">10</span>, <span class="hljs-comment">// watchæ˜¯é€šè¿‡ä¸æ–­è¯¢é—®æ–‡ä»¶æŒ‡é’ˆæ¥åˆ¤æ–­æ˜¯å¦è¦é‡æ–°ç¼–è¯‘çš„ï¼Œpollä¸º1ç§’å†…è¯¢é—®çš„æ¬¡æ•°</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h2 id="context"><a href="#context" class="headerlink" title="context"></a>context</h2><p>webpacké…ç½®ä¸­å¦‚æœé…ç½®äº†<code>context</code>å­—æ®µï¼Œåˆ™é…ç½®å¯¹è±¡å†…çš„æ‰€æœ‰ç›¸å¯¹è·¯å¾„éƒ½æ˜¯åŸºäº<code>context</code>çš„å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  context: __dirname, <span class="hljs-comment">// é»˜è®¤å°±æ˜¯å·¥ç¨‹é¡¹ç›®ç›®å½•</span><br>  entry: <span class="hljs-string">&#x27;./src/main.js&#x27;</span>,<br>  ouput: &#123;<br>    filename: <span class="hljs-string">&#x27;bundle.js&#x27;</span>,<br>    path: <span class="hljs-string">&#x27;./dist&#x27;</span>, <span class="hljs-comment">// è¿™é‡Œä¸å†ä½¿ç”¨ç»å¯¹è·¯å¾„</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>




<h2 id="devtool-â€œsource-mapâ€-â­"><a href="#devtool-â€œsource-mapâ€-â­" class="headerlink" title="devtool: â€œsource-mapâ€ â­"></a>devtool: â€œsource-mapâ€ â­</h2><p>SourceMapæ˜¯ä¸€ç§æä¾›æºä»£ç åˆ°æ„å»ºåä»£ç æ˜ å°„çš„æŠ€æœ¯ï¼Œå¦‚æœæ„å»ºåæºä»£ç å‡ºé”™äº†ï¼Œé€šè¿‡æ˜ å°„å¯ä»¥è¿½è¸ªåˆ°æºä»£ç é”™è¯¯ã€‚åœ¨æµè§ˆå™¨ä¸­è¿è¡ŒWebpackæ‰“åŒ…åçš„JSå’ŒCSSï¼Œå¦‚æœå­˜åœ¨é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡SourceMapæ‰¾åˆ°æ‰“åŒ…å‰å‡ºé”™çš„ä½ç½®ã€‚</p>
<h3 id="å…³é”®å­—è§£æ"><a href="#å…³é”®å­—è§£æ" class="headerlink" title="å…³é”®å­—è§£æ"></a>å…³é”®å­—è§£æ</h3><p>åœ¨<code>webpack.config.js</code>çš„<code>devtool</code>å±æ€§ä¸­å¯ä»¥é…ç½®SourceMapé€‰é¡¹ï¼Œå¯é€‰çš„å€¼æœ‰ï¼š</p>
<p><code>[inline-|hidden-|eval-][nosources-][cheap-[module-]]source-map</code></p>
<p><strong>ä¸æ·»åŠ å…³é”®å­—</strong></p>
<ul>
<li><p><code>source-map</code></p>
<p><font color='cornflowerblue'>ä½œç”¨</font>ï¼šæ„å»ºé¡¹ç›®ä»£ç æ—¶ï¼Œä¸ºæ¯ä¸ªchunkæ‰“åŒ…çš„ç»“æœå’Œcssæ–‡ä»¶ç”Ÿæˆä¸€ä¸ªmapæ–‡ä»¶ã€‚</p>
<p><font color='cornflowerblue'>æ•ˆæœ</font>ï¼šå¯ä»¥è¿½è¸ªåˆ°é”™è¯¯å‘ç”Ÿåœ¨å“ªä¸ªæºä»£ç æ–‡ä»¶çš„å“ªä¸€è¡Œå“ªä¸€åˆ—ã€‚</p>
</li>
</ul>
<p><strong>è§£é‡Šç¬¬ä¸€ç»„å…³é”®å­—</strong></p>
<blockquote>
<p>â— ä»¥ä¸‹å…³é”®å­—ä¸èƒ½äº’ç›¸ç»„åˆï¼Œä½†æ˜¯èƒ½å¤Ÿåé¢ä¸¤ç»„å…³é”®å­—ç»„åˆã€‚</p>
</blockquote>
<ul>
<li><p><code>inline</code></p>
<p><font color='cornflowerblue'>ä½œç”¨</font>ï¼šè®©source-mapæ˜ å°„ä¿¡æ¯å†…è”åˆ°æ„å»ºåçš„æ–‡ä»¶ä¸­ï¼Œä¸å•ç‹¬å½¢æˆä¸€ä¸ªæ–‡ä»¶ã€‚</p>
<p><font color='cornflowerblue'>æ•ˆæœ</font>ï¼šæ˜ å°„ä¿¡æ¯å†…è”ï¼Œæ¯”<code>source-map</code>ç¼–è¯‘é€Ÿåº¦å¿«ï¼Œä½†å› ä¸ºå†…è”ï¼Œæœ€ç»ˆæ‰“åŒ…åçš„æ–‡ä»¶ä½“ç§¯å¤§ã€‚</p>
</li>
<li><p><code>eval</code></p>
<p><font color='cornflowerblue'>ä½œç”¨</font>ï¼šä½¿ç”¨evalå‡½æ•°åŒ…è£¹æ„å»ºåçš„ä»£ç å’Œæ˜ å°„ä¿¡æ¯ï¼ŒåŒæ—¶æ¯ä¸€ä¸ªæ¨¡å—çš„æ˜ å°„ä¿¡æ¯å†™åœ¨è‡ªå·±çš„ä»£ç å—ä¸­ã€‚</p>
<p><font color='cornflowerblue'>æ•ˆæœ</font>ï¼šæ˜ å°„ä¿¡æ¯å†…è”ï¼Œé€Ÿåº¦æ¯”<code>inline-source-map</code>è¿˜å¿«ã€‚</p>
</li>
<li><p><code>hidden</code></p>
<p><font color='cornflowerblue'>ä½œç”¨</font>ï¼šæ˜ å°„ä¿¡æ¯å•ç‹¬æˆç«‹ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸å†æ˜ å°„åˆ°æºä»£ç ï¼Œè€Œæ˜¯æ˜ å°„åˆ°webpackæ„å»ºåçš„ä»£ç ã€‚</p>
<p><font color='cornflowerblue'>æ•ˆæœ</font>ï¼šå¦‚æœä»£ç å‡ºé”™ï¼Œèƒ½å¤Ÿåæ˜ é”™è¯¯å‘ç”Ÿåœ¨æ„å»ºåçš„ä»£ç ä¸­çš„ä½ç½®ã€‚</p>
<blockquote>
<p>hidden-source-mapä¸å†æ˜¾ç¤ºå¼€å‘æºä»£ç ç›®å½•çš„å†…å®¹ï¼Œåªæ˜¾ç¤ºdistä¸­çš„å†…å®¹ã€‚ä¸€èˆ¬åªåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œæ˜ å°„åˆ°çš„æ˜¯webpackè½¬æ¢ã€å‹ç¼©åçš„ä»£ç ã€‚ç”±äºæ˜¯æ˜ å°„åˆ°æ„å»ºåçš„ä»£ç ï¼Œç”Ÿäº§ç¯å¢ƒä¸‹ç›¸å½“äºæ²¡æœ‰æä¾›ä»»ä½•ä¸æºä»£ç æœ‰å…³çš„ä¿¡æ¯ã€‚</p>
</blockquote>
</li>
</ul>
<p><strong>è§£é‡Šç¬¬äºŒç»„å…³é”®å­—</strong></p>
<blockquote>
<p>nosourceså…³é”®å­—å¯ä»¥å’Œå…¶ä»–ä¸¤ç»„å…³é”®å­—ç»„åˆã€‚</p>
</blockquote>
<ul>
<li><p><code>nosources</code></p>
<p><font color='cornflowerblue'>ä½œç”¨</font>ï¼šä¸å†æ˜¾ç¤ºä»»ä½•æºä»£ç ã€‚</p>
<p><font color='cornflowerblue'>æ•ˆæœ</font>ï¼šæ„å»ºä»£ç å‘ç”Ÿçš„é”™è¯¯ï¼Œåªèƒ½å®šä½é”™è¯¯å‘ç”Ÿåœ¨æºä»£ç ä¸­çš„ä½ç½®ï¼Œä½†çœ‹ä¸åˆ°ç›¸åº”ä»£ç å†…å®¹ã€‚<font color='red'>ä¼šå‘å®¢æˆ·ç«¯æš´éœ²æºä»£ç ç›®å½•ç»“æ„ã€‚</font></p>
<p><font color='red'>æ³¨æ„</font>ï¼šä¸€èˆ¬ä¸å’Œ<code>hidden</code>ç»“åˆä½¿ç”¨ã€‚</p>
</li>
</ul>
<p><strong>è§£é‡Šç¬¬ä¸‰ç»„å…³é”®å­—</strong></p>
<blockquote>
<p>ä»¥ä¸‹å…³é”®å­—å¯ä»¥å’Œå‰ä¸¤ç»„ä¸­çš„å…³é”®å­—ç»„åˆã€‚</p>
</blockquote>
<ul>
<li><p><code>cheap</code></p>
<p><font color='cornflowerblue'>ä½œç”¨</font>ï¼šç®€åŒ–<code>source-map</code>çš„è¡Œä¸ºï¼Œç”Ÿæˆmapæ–‡ä»¶ï¼Œä½†ä¸å†åŒ…å«<code>loader</code>çš„source-mapï¼Œä¸å†è®¡ç®—åˆ—å·ã€‚</p>
<p><font color='cornflowerblue'>æ•ˆæœ</font>ï¼šåªèƒ½è¿½è¸ªåˆ°<code>loader</code>å¤„ç†åçš„ä¸­é—´ä»£ç çš„ä½ç½®ï¼ŒåŒæ—¶ä¸èƒ½ç²¾ç¡®åˆ°åˆ—ï¼Œä½†æ¯”<code>source-map</code>ç¼–è¯‘æ›´å¿«ã€‚</p>
</li>
<li><p><code>cheap-module</code></p>
<p>ä½œç”¨ï¼šåœ¨<code>cheap-source-map</code>å’Œ<code>source-map</code>ä¹‹é—´æŠ˜è¡·ï¼Œå›Šæ‹¬<code>loader</code>çš„source-mapï¼Œä½†ä¹Ÿä¸è®¡ç®—åˆ—å·ã€‚</p>
<p>æ•ˆæœï¼šèƒ½è¿½è¸ªåˆ°æºä»£ç ä½ç½®ï¼Œä½†åŒæ ·ä¸èƒ½ç²¾ç¡®åˆ°åˆ—ã€‚ç”Ÿæˆçš„mapæ–‡ä»¶æ¯”<code>cheap-source-map</code>å¤§ã€‚</p>
</li>
</ul>
<h3 id="å¼€å‘ç¯å¢ƒ-devtoolé…ç½®"><a href="#å¼€å‘ç¯å¢ƒ-devtoolé…ç½®" class="headerlink" title="å¼€å‘ç¯å¢ƒ devtoolé…ç½®"></a>å¼€å‘ç¯å¢ƒ devtoolé…ç½®</h3><p>å¯¹å¼€å‘ç¯å¢ƒçš„ä»£ç è¿›è¡Œè°ƒè¯•æ—¶ï¼Œè¦è€ƒè™‘<strong>ç¼–è¯‘çš„é€Ÿåº¦</strong>å’Œ<strong>è°ƒè¯•å‹å¥½ç¨‹åº¦</strong>ã€‚</p>
<blockquote>
<p>è°ƒè¯•å‹å¥½ç¨‹åº¦æ— éå°±æ˜¯èƒ½å¦å‡†ç¡®å®šä½åˆ°é”™è¯¯åœ¨æºä»£ç ä¸­çš„ä½ç½®ã€‚    </p>
<p>ç”±äºå†…è”æ¨¡å¼ç¼–è¯‘é€Ÿåº¦å¿«äºéå†…è”ï¼Œæ‰€ä»¥å¼€å‘ç¯å¢ƒåªè€ƒè™‘å†…è”æ¨¡å¼ã€‚</p>
</blockquote>
<p><strong>æŒ‰ç¼–è¯‘é€Ÿåº¦æ’åï¼š</strong></p>
<ol>
<li><code>eval-cheap-source-map</code></li>
<li><code>eval-cheap-module-source-map</code>å’Œ<code>eval-source-map</code></li>
<li><code>cheap-source-map</code></li>
</ol>
<p><strong>æŒ‰è°ƒè¯•å‹å¥½ç¨‹åº¦æ’å</strong></p>
<ol>
<li><code>eval-source-map</code> å’Œ <code>inline-source-map</code> ç²¾ç¡®åˆ°æŸæ–‡ä»¶ä¸­çš„æŸè¡ŒæŸåˆ—</li>
<li><code>[inline-|eval-]cheap-module-source-map</code> ç²¾ç¡®åˆ°æŸæ–‡ä»¶ä¸­çš„æŸè¡Œ</li>
</ol>
<p><strong>ç»¼ä¸Šæ‰€è¿°ï¼š</strong></p>
<p>ä¸€èˆ¬å¼€å‘ç¯å¢ƒæ¨èä½¿ç”¨<code>eval-source-map</code>æˆ–<code>eval-cheap-module-source-map</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  devtool: <span class="hljs-string">&#x27;eval-source-map&#x27;</span> <span class="hljs-comment">// åœ¨vueå’Œreactè„šæ‰‹æ¶ä¸­ï¼Œå¼€å‘ç¯å¢ƒé»˜è®¤ä½¿ç”¨çš„æ˜¯eval-source-map</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="ç”Ÿäº§ç¯å¢ƒ-devtoolé…ç½®"><a href="#ç”Ÿäº§ç¯å¢ƒ-devtoolé…ç½®" class="headerlink" title="ç”Ÿäº§ç¯å¢ƒ devtoolé…ç½®"></a>ç”Ÿäº§ç¯å¢ƒ devtoolé…ç½®</h3><p>å¯¹ç”Ÿäº§ç¯å¢ƒçš„ä»£ç è¿›è¡Œè°ƒè¯•æ—¶ï¼Œè¦è€ƒè™‘<strong>æ˜¯å¦éšè—æºä»£ç </strong>å’Œ<strong>è°ƒè¯•å‹å¥½ç¨‹åº¦</strong>ã€‚</p>
<blockquote>
<p>SourceMapingURLå¦‚æœå†…è”ä¼šå¯¼è‡´å•ä¸ªæ–‡ä»¶ä½“ç§¯è¿‡å¤§ï¼Œæ‰€ä»¥ç”Ÿäº§ç¯å¢ƒä¸è€ƒè™‘SourceMapå†…è”æ¨¡å¼ã€‚</p>
</blockquote>
<p><strong>æŒ‰ç…§è°ƒè¯•å‹å¥½ç¨‹åº¦æ’å</strong></p>
<ol>
<li><code>source-map</code> ä¼šæš´éœ²æºç </li>
<li><code>cheap-module-source-map</code> ä¼šæš´éœ²æºç </li>
<li><code>nosources-source-map</code> ğŸ‘ˆ èƒ½å¤Ÿå®šä½é”™è¯¯å‘ç”Ÿåœ¨æºä»£ç ä¸­çš„ä½ç½®ï¼Œä½†æ— æ³•åœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°æºç </li>
</ol>
<p><strong>æŒ‰å¯¹æºç çš„ä¿æŠ¤ç¨‹åº¦æ’å</strong></p>
<ol>
<li><p><code>ä¸ä½¿ç”¨SourceMapï¼Œå³ä¸é…ç½®devtool</code></p>
</li>
<li><p><code>hidden-source-map</code></p>
</li>
<li><p><code>nosources-source-map</code> </p>
</li>
</ol>
<p><strong>ç»¼ä¸Šæ‰€è¿°ï¼š</strong></p>
<p>å¦‚æœæ—¢è¦ä¿æŠ¤æºä»£ç ï¼Œåˆè¦èƒ½å¤Ÿå®šä½åˆ°é”™è¯¯å‘ç”Ÿåœ¨æºä»£ç ä¸­çš„ä½ç½®ï¼š</p>
<p>â€‹    æ–¹æ³•1 ä½¿ç”¨<code>nosources-source-map</code>ã€‚</p>
<p>â€‹    æ–¹æ³•2 ä½¿ç”¨<code>source-map</code>æ‰“åŒ…åï¼Œä¸Šçº¿æ—¶è§„å®šä¸å…è®¸å‰ç«¯åŠ è½½mapæ–‡ä»¶ã€‚</p>
<p>å¦‚æœä¸éœ€è¦ä¿æŠ¤æºä»£ç ï¼Œå¯ä»¥ä½¿ç”¨<code>source-map</code>ã€‚</p>
<p>å¦‚æœä¸éœ€è¦è¿›è¡Œç”Ÿäº§ç¯å¢ƒä¸‹çš„è°ƒè¯•ï¼Œåˆ™ä¸éœ€è¦é…ç½®<code>devtool</code>ã€‚</p>
<h3 id="å®˜æ–¹æŒ‡å—"><a href="#å®˜æ–¹æŒ‡å—" class="headerlink" title="å®˜æ–¹æŒ‡å—"></a>å®˜æ–¹æŒ‡å—</h3><p><a target="_blank" rel="noopener" href="http://doc.codingdict.com/webpack-cn-doc/configuration/devtool/">http://doc.codingdict.com/webpack-cn-doc/configuration/devtool/</a></p>
<h2 id="resolve-è§£ææŸ¥æ‰¾æ¨¡å—å’ŒåŒ…-â­"><a href="#resolve-è§£ææŸ¥æ‰¾æ¨¡å—å’ŒåŒ…-â­" class="headerlink" title="resolve è§£ææŸ¥æ‰¾æ¨¡å—å’ŒåŒ… â­"></a>resolve è§£ææŸ¥æ‰¾æ¨¡å—å’ŒåŒ… â­</h2><p><strong>webpack.config.jsä¸­å¯ä»¥é…ç½®resolveå­—æ®µå¸®åŠ©æˆ‘ä»¬ä¼˜åŒ–å¯¹æ–‡ä»¶æ¨¡å—è§£ææŸ¥æ‰¾çš„è¿‡ç¨‹ã€‚</strong></p>
<h3 id="extensions"><a href="#extensions" class="headerlink" title="extensions"></a>extensions</h3><p><code>resolove.extensions</code>ä¸­åŒ…å«çš„æ‰©å±•åå¯ä»¥åœ¨ä½¿ç”¨<code>require</code>å’Œ<code>import</code>è¯­å¥æ—¶çœç•¥ï¼Œwebpackä¼šä¾æ¬¡å°è¯•æ·»åŠ æ‰©å±•åè¿›è¡ŒåŒ¹é…ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  resolve: &#123;<br>    extensions: [<span class="hljs-string">&#x27;.js&#x27;</span>, <span class="hljs-string">&#x27;.json&#x27;</span>, <span class="hljs-string">&#x27;vue&#x27;</span>, <span class="hljs-string">&#x27;css&#x27;</span>],<br>  &#125;, <br>&#125;<br><span class="hljs-comment">//============================</span><br># .src/main.js<br><span class="hljs-keyword">import</span> webpackConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../webpack.config&#x27;</span>); <span class="hljs-comment">// çœç•¥ &quot;.js&quot;</span><br><br></code></pre></td></tr></table></figure>
<h3 id="alias"><a href="#alias" class="headerlink" title="alias"></a>alias</h3><p><code>resolve.alias</code>å¯ä»¥å®šä¹‰è·¯å¾„åˆ«åã€‚</p>
<p>å¦‚æœåœ¨<code>require</code>å’Œ<code>import</code>åŠ è½½çš„è·¯å¾„ä¸­ä½¿ç”¨åˆ«åï¼ŒçœŸæ­£çš„è·¯å¾„æ˜¯å°†<font color='red'>åˆ«å</font>å’Œ<font color='red'>è¢«åˆ«ååˆ†å‰²çš„å­—ç¬¦ä¸²</font>ä¼ å…¥åˆ°<code>path.join</code>æ–¹æ³•å¾—åˆ°çš„ç»“æœã€‚</p>
<p>å¦‚æœä½¿ç”¨åˆ«åæ²¡æœ‰åŒ¹é…åˆ°ï¼Œé‚£ä¹ˆä¼šå°†åˆ«åä½œä¸ºçœŸåå†å»åŒ¹é…ä¸€æ¬¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-keyword">const</span> &#123; resolve &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  resolve: &#123;<br>    extensions: [<span class="hljs-string">&#x27;.js&#x27;</span>, <span class="hljs-string">&#x27;.json&#x27;</span>, <span class="hljs-string">&#x27;vue&#x27;</span>, <span class="hljs-string">&#x27;css&#x27;</span>],<br>    alias: &#123;<br>      <span class="hljs-string">&#x27;@&#x27;</span>: resolve(__dirname, <span class="hljs-string">&#x27;src&#x27;</span>),<br>      <span class="hljs-string">&#x27;@components&#x27;</span>: resolve(__dirname, <span class="hljs-string">&#x27;src&#x27;</span>, <span class="hljs-string">&#x27;component&#x27;</span>),<br>    &#125;<br>  &#125;, <br>&#125;<br><span class="hljs-comment">//============================</span><br># .src/main.js<br><span class="hljs-keyword">import</span> indexJS = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@/foo&#x27;</span>); <br><br></code></pre></td></tr></table></figure>
<h3 id="modules"><a href="#modules" class="headerlink" title="modules"></a>modules</h3><p>å¯¹äºåœ¨æ–‡ä»¶æ¨¡å—ä¾èµ–çš„åŒ…ï¼ˆå¦‚vueï¼Œjqueryï¼‰ï¼Œwebpackä¼šæŒ‰ç…§Node.jsçš„è§„åˆ™ä¸€è·¯å‘ä¸ŠæŸ¥æ‰¾<code>node_modules</code>ç›®å½•ã€‚</p>
<p>è€Œ<code>resolve.modules</code>æä¾›äº†ä¸€ç§æ–¹å¼è®©webpackå»æŒ‡å®šçš„ç›®å½•ä¸­æŸ¥æ‰¾æ¨¡å—æ‰€ä¾èµ–çš„åŒ…ã€‚</p>
<p>è¿™æ ·åšæœ‰ä¸¤ä¸ªå¥½å¤„ï¼šâ‘  å‡å°‘æœç´¢çš„ç›®å½•ï¼Œæé«˜æŸ¥è¯¢é€Ÿåº¦ ï¼Œâ‘¡ å¯ä»¥è‡ªå®šä¹‰æ·»åŠ æŸ¥è¯¢ç›®å½•ã€‚</p>
<blockquote>
<p>â— ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåˆ°è‡ªå®šä¹‰çš„æŸ¥è¯¢ç›®å½•å»æŸ¥æ‰¾åŒ…æ—¶ï¼Œä»æ—§æŒ‰ç…§Node.jsè§„èŒƒå»åŠ è½½åŒ…çš„å…¥å£æ¨¡å—ã€‚</p>
<p>æ¢å¥è¯è¯´ï¼Œæœ¬åœ°å¼€å‘ç›®å½•ä¸‹ï¼Œè¦å…ˆå°†è‡ªå®šä¹‰çš„åŒ…æŒ‰ç…§Node.jsçš„è§„èŒƒæ•´ç†å¥½ï¼Œç„¶åå°†åŒ…çš„æ–‡ä»¶å¤¹æ”¾åœ¨è‡ªå®šä¹‰æŸ¥è¯¢ç›®å½•ä¸‹ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># ç›®å½•ç»“æ„<br>.<br>|  src<br>|  |  modules<br>|  |  |  bar<br>|  |  |  |--index.js<br>|  |--main.js<br>|--webpack.config.js<br><br><span class="hljs-comment">// =======================================================================</span><br><br># webpack.config.js<br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  resolve: &#123;<br>    <span class="hljs-comment">/* è®¾ç½®æœå¯»ç›®å½•ä¸ºå·¥ç¨‹ç›®å½•ä¸‹çš„node_modulesä»¥åŠsrcç›®å½•ä¸‹çš„modulesï¼Œ</span><br><span class="hljs-comment">    *  è¯¥ç›®å½•å­˜æ”¾è‡ªå®šä¹‰çš„åŒ…ã€‚</span><br><span class="hljs-comment">    */</span><br>    modules: [<span class="hljs-string">&#x27;node_modules&#x27;</span>, <span class="hljs-string">&#x27;src/modules&#x27;</span>], <br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// ======================================================================</span><br><br># .src/main.js<br><span class="hljs-comment">// å‡è®¾æ­¤æ—¶åœ¨src/modulesç›®å½•ä¸‹å­˜åœ¨è‡ªå®šä¹‰çš„åŒ…barï¼Œä»¥æ–‡ä»¶å¤¹å½¢å¼å­˜å‚¨ï¼Œå…¶ä¸­å«æœ‰index.jsæ–‡ä»¶</span><br><span class="hljs-keyword">import</span> bar <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;bar&#x27;</span>; <span class="hljs-comment">// å¦‚æœnode_modulesä¸‹ä¸å­˜åœ¨baråŒ…ï¼Œåˆ™å›åˆ°src/modulesåŠ è½½bar</span><br><br></code></pre></td></tr></table></figure>


<h3 id="mainFileds"><a href="#mainFileds" class="headerlink" title="mainFileds"></a>mainFileds</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨å¯¼å…¥ä¸€ä¸ªåŒ…æ—¶ï¼Œä¼šæŸ¥æ‰¾è¯¥åŒ…ç›®å½•ä¸‹<code>package.json</code>çš„<code>main</code>å­—æ®µæ ‡è®°çš„è·¯å¾„ä½œä¸ºå…¥å£æ¨¡å—çš„è·¯å¾„ã€‚</p>
<p>ä½†æ˜¯è¿™ä¸ªå…¥å£å­—æ®µæ˜¯å¯ä»¥é…ç½®çš„ï¼Œä¸ä¸€å®šéè¦æ˜¯<code>main</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.configs.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  resolve: &#123;<br>    mainFields: [<span class="hljs-string">&#x27;my-entry&#x27;</span>, <span class="hljs-string">&#x27;main&#x27;</span>], <span class="hljs-comment">// å…ˆçœ‹my-entryï¼Œå†çœ‹main</span><br>    <span class="hljs-comment">// é…ç½® target === web æˆ–è€… target ==== webworkeræ—¶ï¼ŒmainFieldsçš„å€¼ï¼š</span><br>    mainFields: [<span class="hljs-string">&#x27;browser&#x27;</span>, <span class="hljs-string">&#x27;module&#x27;</span>, <span class="hljs-string">&#x27;main&#x27;</span>],<br>    <span class="hljs-comment">// targetçš„å€¼ä¸ºå…¶ä»–æ—¶ï¼Œmainfieldsé»˜è®¤å€¼ä¸ºï¼š</span><br>    mainFields: [<span class="hljs-string">&#x27;module&#x27;</span>, <span class="hljs-string">&#x27;main&#x27;</span>]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="mainFiles"><a href="#mainFiles" class="headerlink" title="mainFiles"></a>mainFiles</h3><p>å½“ä¸€ä¸ªåŒ…çš„ä¸»ç›®å½•ä¸‹æ²¡æœ‰<code>package.json</code>æ–‡ä»¶ï¼Œæˆ–<code>package.json</code>æ²¡æœ‰æŒ‡ç¤ºå…¥å£æ–‡ä»¶æ—¶ï¼Œé»˜è®¤å…¥å£ä¸ºåŒ…çš„ä¸»ç›®å½•ä¸‹çš„<code>index.js</code>æ–‡ä»¶ï¼Œå…¶å®è¿™ä¸ªä¹Ÿæ˜¯å¯ä»¥é…ç½®çš„ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.configs.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  resolve: &#123;<br>    mainFiles: [<span class="hljs-string">&#x27;index&#x27;</span>, <span class="hljs-string">&#x27;entry&#x27;</span>, <span class="hljs-string">&#x27;main&#x27;</span> ],<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>




<h2 id="resolveLoader-è§£ææŸ¥æ‰¾loader"><a href="#resolveLoader-è§£ææŸ¥æ‰¾loader" class="headerlink" title="resolveLoader è§£ææŸ¥æ‰¾loader"></a>resolveLoader è§£ææŸ¥æ‰¾loader</h2><p><code>resolve</code>æ˜¯ç”¨æ¥æŒ‡å®šå¦‚ä½•è§£ææŸ¥æ‰¾æ¨¡å—å’ŒåŒ…ï¼Œè€Œ<code>resolveLoader</code>ç”¨äºæŒ‡å®šå¦‚ä½•æŸ¥æ‰¾loaderã€‚</p>
<p>è¿™ä¸ªå­—æ®µçš„é…ç½®ä¸<code>resolve</code>é…ç½®ç±»ä¼¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      &#123;<br>        test: <span class="hljs-regexp">/\.js$/</span>,<br>        loader: <span class="hljs-string">&#x27;my-loader&#x27;</span>, <span class="hljs-comment">// ğŸ‘ˆ è‡ªå®šä¹‰loader</span><br>      &#125;<br>    ]<br>  &#125;<br>  <span class="hljs-comment">//ğŸ‘‡  é…ç½®loaderå¦‚ä½•æŸ¥æ‰¾</span><br>  resolveLoader: &#123;<br>    extensions: [<span class="hljs-string">&#x27;.js&#x27;</span>],<br>    modules: [<span class="hljs-string">&#x27;node_modules&#x27;</span>, <span class="hljs-string">&#x27;loaders&#x27;</span>, <span class="hljs-string">&#x27;src/loaders&#x27;</span>],<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>




<h2 id="module-noParse"><a href="#module-noParse" class="headerlink" title="module.noParse"></a>module.noParse</h2><p><code>module.noParse</code>å­—æ®µå¯ä»¥ç”¨äºé…ç½®å“ªäº›æ¨¡å—æ–‡ä»¶çš„å†…å®¹ä¸éœ€è¦è§£æä¾èµ–ã€‚</p>
<p>ä¸€äº›ç¬¬ä¸‰æ–¹åº“æ¯”è¾ƒç‹¬ç«‹ï¼Œä¸ä¾èµ–äºåˆ«çš„æ¨¡å—ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>module.noParse</code>å‘Šè¯‰webpackä¸å»è§£æè¿™äº›æ¨¡å—çš„ä¾èµ–ï¼Œä»è€Œä¸€å®šç¨‹åº¦ä¸Š<font color='red'>æé«˜æ„å»ºé€Ÿåº¦</font>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [],<br>    <span class="hljs-comment">// ğŸ‘‡ ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼</span><br>    noParse: <span class="hljs-regexp">/jquery|lodash/</span>,<br>    <span class="hljs-comment">// ğŸ‘‡ æˆ–è€…æ”¹ç”¨å‡½æ•°</span><br>    <span class="hljs-function"><span class="hljs-title">noParse</span>(<span class="hljs-params">id</span>)</span> &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-regexp">/jquery|lodash/</span>.test(id);<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h2 id="stats-æ—¥å¿—ä¼˜åŒ–"><a href="#stats-æ—¥å¿—ä¼˜åŒ–" class="headerlink" title="stats æ—¥å¿—ä¼˜åŒ–"></a>stats æ—¥å¿—ä¼˜åŒ–</h2><p>webpackç¼–è¯‘æ—¶ï¼Œæ§åˆ¶å°æ—¥å¿—å¤ªå¤šæˆ–å¤ªå°‘éƒ½ä¸ç¾è§‚ã€‚é€šè¿‡é…ç½®<code>stats</code>å­—æ®µå¯ä»¥ä¼˜åŒ–æ—¥å¿—çš„è¾“å‡ºã€‚</p>
<table>
<thead>
<tr>
<th>å±æ€§å€¼</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td><code>&quot;normal&quot;</code></td>
<td>é»˜è®¤å€¼ï¼Œæ ‡å‡†è¾“å‡º</td>
</tr>
<tr>
<td><code>&quot;none&quot;</code></td>
<td>æ²¡æœ‰æ—¥å¿—è¾“å‡º</td>
</tr>
<tr>
<td><code>&quot;errors-only&quot;</code></td>
<td>åªæœ‰å‘ç”Ÿé”™è¯¯æ—¶è¾“å‡º</td>
</tr>
<tr>
<td><code>&quot;minimal&quot;</code></td>
<td>å‘ç”Ÿé”™è¯¯æˆ–æœ‰æ–°çš„ç¼–è¯‘å†…å®¹æ—¶è¾“å‡º</td>
</tr>
<tr>
<td><code>&quot;verbose&quot;</code></td>
<td>å…¨éƒ¨è¾“å‡º</td>
</tr>
</tbody></table>
<h2 id="tree-shaking-â­"><a href="#tree-shaking-â­" class="headerlink" title="tree-shaking â­"></a>tree-shaking â­</h2><p>å½“ Javascript é¡¹ç›®è¾¾åˆ°ä¸€å®šä½“ç§¯æ—¶ï¼Œå°†ä»£ç åˆ†æˆæ¨¡å—ä¼šæ›´æ˜“äºç®¡ç†ã€‚ä½†æ˜¯å½“è¿™æ ·åšæ—¶ï¼Œæˆ‘ä»¬æœ€ç»ˆå¯èƒ½ä¼šå¯¼å…¥å®é™…ä¸Šæœªä½¿ç”¨çš„ä»£ç (<code>dead code</code>)ã€‚Tree Shaking æ˜¯ä¸€ç§é€šè¿‡æ¶ˆé™¤æœ€ç»ˆæ–‡ä»¶ä¸­æœªä½¿ç”¨çš„ä»£ç æ¥ä¼˜åŒ–ä½“ç§¯çš„æ–¹æ³•ã€‚</p>
<h3 id="ä¾èµ–äºES6æ¨¡å—åŒ–"><a href="#ä¾èµ–äºES6æ¨¡å—åŒ–" class="headerlink" title="ä¾èµ–äºES6æ¨¡å—åŒ–"></a>ä¾èµ–äºES6æ¨¡å—åŒ–</h3><p>Tree-shakingä¸»è¦ä¾èµ–äº<code>ES6çš„æ¨¡å—åŒ–importå’Œexport</code>ã€‚</p>
<p>æˆ‘ä»¬éƒ½çŸ¥é“ES6çš„moduleåªèƒ½æ˜¯åœ¨æ¨¡å—é¡¶éƒ¨å‡ºç°ï¼Œå’Œè¿è¡Œæ—¶æ— å…³ï¼Œä¸èƒ½è¿è¡Œæ—¶åŠ è½½ï¼ŒTree-shakingä¸»è¦å°±æ˜¯ä¾é è¿™ä¸ªåŸºç¡€è¿›è¡Œé™æ€åˆ†æï¼Œä¸æ‰§è¡Œä»£ç å°±èƒ½å¯¹æ¨¡å—ä¾èµ–å…³ç³»è¿›è¡Œåˆ¤å®šã€‚</p>
<p>è€Œ<code>commonJSæ¨¡å—åŒ–è§„èŒƒ</code>æ”¯æŒåŠ¨æ€å¯¼å…¥ï¼Œéœ€è¦æ‰§è¡Œæ¨¡å—ä»£ç åæ‰çŸ¥é“æœ‰æ²¡æœ‰è¿è¡ŒæŸä¸ª<code>require</code>è¯­å¥ã€‚CommonJS æ¨¡å—çš„è¿™ç§ <code>dynamic</code> æ€§è´¨æ„å‘³ç€æ— æ³• Tree Shakingï¼Œå› ä¸ºåœ¨å®é™…è¿è¡Œä»£ç ä¹‹å‰æ— æ³•ç¡®å®šéœ€è¦å“ªäº›æ¨¡å—ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> myDynamicModule;<br><br><span class="hljs-keyword">if</span> (condition) &#123;<br>    myDynamicModule = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;foo&quot;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    myDynamicModule = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;bar&quot;</span>);<br>&#125; <br></code></pre></td></tr></table></figure>
<p>åœ¨ ES6 ä¸­ï¼Œå¼•å…¥äº†æ¨¡å—çš„æ–°è¯­æ³•ï¼Œè¿™æ˜¯ <code>static</code> çš„ã€‚ä½¿ç”¨<code>import</code>è¯­æ³•ï¼Œæˆ‘ä»¬ä¸å†èƒ½å¤ŸåŠ¨æ€å¯¼å…¥æ¨¡å—ã€‚</p>
<p>å¦‚ä¸‹æ‰€ç¤ºçš„ä»£ç æ˜¯ä¸è¢«å…è®¸çš„ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">if</span> (condition) &#123;<br>    <span class="hljs-keyword">import</span> foo <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;foo&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">import</span> bar <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;bar&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ç›¸åï¼Œæˆ‘ä»¬å¿…é¡»åœ¨ä»»ä½•æ¡ä»¶ä¹‹å¤–å®šä¹‰å…¨å±€èŒƒå›´å†…çš„æ‰€æœ‰å¯¼å…¥ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> foo <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;foo&quot;</span>;<br><span class="hljs-keyword">import</span> bar <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;bar&quot;</span>;<br><br><span class="hljs-keyword">if</span> (condition) &#123;<br>    <span class="hljs-comment">// do stuff with foo</span><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">// do stuff with bar</span><br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="å…³é—­babelçš„æ¨¡å—åŒ–è½¬è¯‘"><a href="#å…³é—­babelçš„æ¨¡å—åŒ–è½¬è¯‘" class="headerlink" title="å…³é—­babelçš„æ¨¡å—åŒ–è½¬è¯‘"></a>å…³é—­babelçš„æ¨¡å—åŒ–è½¬è¯‘</h3><p>å…ˆè¦äº†è§£ï¼ŒTree Shaking å®ç°çš„å‰æï¼Œæ˜¯åŸºäº ã€Œå¿…é¡»ç”¨ ES Modules ç»„ç»‡ä»£ç ã€ã€‚</p>
<p>å³äº¤ç»™webpackå¤„ç†çš„ä»£ç ï¼Œå¿…é¡»ä½¿ç”¨ <code>ES6 modules</code>æ–¹å¼å®ç°æ¨¡å—åŒ–ã€‚</p>
<blockquote>
<p>MDNï¼šTree shaking ä¾èµ–äºES6ä¸­çš„importå’Œexportè¯­å¥ï¼Œç”¨æ¥æ£€æµ‹ä»£ç æ¨¡å—æ˜¯å¦è¢«å¯¼å‡ºã€å¯¼å…¥ï¼Œä¸”è¢«Javascriptæ–‡ä»¶ä½¿ç”¨ã€‚</p>
</blockquote>
<p>webpackä¼˜åŒ–çš„è¿‡ç¨‹æ˜¯å…ˆå°†ä»£ç äº¤ç»™loaderå»å¤„ç†ï¼Œç„¶åå†å°†å¤„ç†ç»“æœä¼˜åŒ–è¾“å‡ºã€‚</p>
<p>è€Œä¸ºäº†è½¬æ¢ä»£ç ä¸­çš„ ECMAScript æ–°ç‰¹æ€§ï¼Œä¸€èˆ¬ä¼šé€‰æ‹©<code>babel-loader</code>å»å¤„ç†JSã€‚</p>
<p><font color='red'>è€Œåœ¨<code>babel-loader</code>å¤„ç†ä»£ç æ—¶ï¼Œå°±æœ‰å¯èƒ½å°†ä»£ç ä¸­çš„ <code>ES6 modules</code> è½¬æ¢ä¸º <code>CommonJS</code>ã€‚</font></p>
<blockquote>
<p>PSï¼šå®é™…ä¸Šè¿™å–å†³äºæ˜¯å¦ä½¿ç”¨äº†è½¬æ¢ESMçš„babelæ’ä»¶ï¼Œè€Œå¸¸ç”¨çš„æ’ä»¶é›†åˆ @babel/preset-env å°±åŒ…å«è½¬æ¢ESMçš„æ’ä»¶ã€‚</p>
</blockquote>
<p><font color='red'>æ‰€ä»¥å½“ @babel/preset-env å·¥ä½œæ—¶ï¼Œä»£ç ä¸­çš„ ESM å°±åº”è¯¥è¢«è½¬æ¢ä¸º CommonJSã€‚</font></p>
<p>å› æ­¤webpackåœ¨æ‰“åŒ…æ—¶ï¼Œæ‹¿åˆ°çš„å°±æ˜¯ CommonJS ç»„ç»‡çš„ä»£ç ï¼Œä»è€Œ Tree Shaking ä¹Ÿå°±ä¸èƒ½ç”Ÿæ•ˆã€‚</font></p>
<p><strong>ä½†æ˜¯ç°åœ¨çš„æ•ˆæœå¹¶ä¸æ˜¯è¿™æ ·ã€‚</strong></p>
<p>åœ¨é¡¹ç›®ä¸­ä½¿ç”¨babel-loaderï¼Œå¹¶ä»…å¼€å¯usedExportsï¼ŒæŸ¥çœ‹æ‰“åŒ…ç»“æœã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = &#123;<br>  mode: <span class="hljs-string">&#x27;none&#x27;</span>,<br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      &#123;<br>        test: <span class="hljs-regexp">/\.js$/</span>,<br>        use: &#123;<br>          loader: <span class="hljs-string">&#x27;babel-loader&#x27;</span>,<br>          options: &#123;<br>            presets: [<span class="hljs-string">&#x27;@babel/preset-env&#x27;</span>],<br>          &#125;,<br>        &#125;,<br>      &#125;,<br>    ],<br>  &#125;,<br>  optimization: &#123;<br>    usedExports: <span class="hljs-literal">true</span>,<br>  &#125;,<br>&#125;<br><br>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-built_in">module</span>, __webpack_exports__, __webpack_require__</span>) </span>&#123;<br><br><span class="hljs-meta">&quot;use strict&quot;</span>;<br><span class="hljs-comment">/* harmony export (binding) */</span> __webpack_require__.d(__webpack_exports__, <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123; <span class="hljs-keyword">return</span> Button; &#125;);<br>  <br><span class="hljs-comment">// usedExports ç”Ÿæ•ˆäº†ï¼Œä¹Ÿå°±æ˜¯Tree Shaking ç”Ÿæ•ˆäº†</span><br>  <br><span class="hljs-comment">/* unused harmony export Link */</span><br><span class="hljs-comment">/* unused harmony export Heading */</span><br>  <br><span class="hljs-keyword">var</span> Button = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Button</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&#x27;button&#x27;</span>);<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;dead-code&#x27;</span>);<br>&#125;;<br><span class="hljs-keyword">var</span> Link = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Link</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&#x27;a&#x27;</span>);<br>&#125;;<br><span class="hljs-keyword">var</span> Heading = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Heading</span>(<span class="hljs-params">level</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&#x27;h&#x27;</span> + level);<br>&#125;;<br><br>&#125;)<br><br></code></pre></td></tr></table></figure>
<p>å‘ç° usedExports ç”Ÿæ•ˆäº†ï¼Œä¹Ÿå°±è¡¨ç¤º Tree Shaking å¹¶æ²¡æœ‰å¤±æ•ˆã€‚</p>
<p><strong>è¿™æ˜¯å› ä¸ºåœ¨æœ€æ–°ç‰ˆæœ¬çš„ babel-loader ä¸­è‡ªåŠ¨å…³é—­äº† è½¬æ¢ESM çš„æ’ä»¶ã€‚</strong></p>
<hr>
<p>å¯ä»¥é€šè¿‡ä¿®æ”¹æ’ä»¶é›†åˆçš„é…ç½®ï¼Œå¼€å¯ ESM è½¬æ¢ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-built_in">module</span>: &#123;<br>  optimization: &#123;<br>    usedExports: <span class="hljs-literal">true</span>  <br>  &#125;,<br>  rules: [<br>    &#123;<br>      test: <span class="hljs-regexp">/\.js$/</span>,<br>      use: &#123;<br>        loader: <span class="hljs-string">&#x27;babel-loader&#x27;</span>,<br>        options: &#123;<br>          <span class="hljs-comment">// æ³¨æ„ï¼šä»…ä½¿ç”¨æ—¶ï¼Œæ˜¯å°†æ’ä»¶é›†åˆåç§°æ”¾åˆ°ä¸€ä¸ªæ•°ç»„ä¸­</span><br>          <span class="hljs-comment">// presets: [&#x27;@babel/preset-env&#x27;],</span><br><br>          <span class="hljs-comment">// å½“å¯¹æ’ä»¶é›†åˆç¼–å†™é…ç½®æ—¶ï¼Œå°±éœ€è¦å†å¥—ä¸€ä¸ªæ•°ç»„</span><br>          <span class="hljs-comment">// æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æ’ä»¶é›†åˆçš„åç§°</span><br>          <span class="hljs-comment">// ç¬¬äºŒä¸ªå…ƒç´ æ˜¯å®ƒçš„é…ç½®å¯¹è±¡</span><br>          presets: [<br>            [<br>              <span class="hljs-string">&#x27;@babel/preset-env&#x27;</span>,<br>              &#123;<br>                <span class="hljs-comment">// modulesé»˜è®¤æ˜¯autoï¼Œå³æ ¹æ®ç¯å¢ƒå»åˆ¤æ–­æ˜¯å¦å¼€å¯è½¬æ¢ESMæ’ä»¶</span><br>                <span class="hljs-comment">// è¿™é‡Œè®¾ç½®ä¸ºå¼ºåˆ¶è½¬æ¢ä¸ºcommonjs</span><br>                modules: <span class="hljs-string">&#x27;commonjs&#x27;</span>,<br>              &#125;,<br>            ],<br>          ],<br>        &#125;,<br>      &#125;,<br>    &#125;,<br>  ],<br>&#125;,<br><br></code></pre></td></tr></table></figure>
<p>å†æ¬¡æ‰“åŒ…æŸ¥çœ‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs js">(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-built_in">module</span>, <span class="hljs-built_in">exports</span>, __webpack_require__</span>) </span>&#123;<br><br><span class="hljs-meta">&quot;use strict&quot;</span>;<br><br><br><span class="hljs-built_in">Object</span>.defineProperty(<span class="hljs-built_in">exports</span>, <span class="hljs-string">&quot;__esModule&quot;</span>, &#123;<br>  value: <span class="hljs-literal">true</span><br>&#125;);<br><span class="hljs-built_in">exports</span>.Heading = <span class="hljs-built_in">exports</span>.Link = <span class="hljs-built_in">exports</span>.Button = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<br><br><span class="hljs-keyword">var</span> Button = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Button</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&#x27;button&#x27;</span>);<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;dead-code&#x27;</span>);<br>&#125;;<br><br><span class="hljs-built_in">exports</span>.Button = Button;<br><br><span class="hljs-keyword">var</span> Link = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Link</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&#x27;a&#x27;</span>);<br>&#125;;<br><br><span class="hljs-built_in">exports</span>.Link = Link;<br><br><span class="hljs-keyword">var</span> Heading = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Heading</span>(<span class="hljs-params">level</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&#x27;h&#x27;</span> + level);<br>&#125;;<br><br><span class="hljs-built_in">exports</span>.Heading = Heading;<br><br>&#125;)<br><br></code></pre></td></tr></table></figure>
<p>3ä¸ªæˆå‘˜éƒ½è¢«å¯¼å‡ºï¼Œä»è€Œå‹ç¼©ä¼˜åŒ–æ—¶ï¼Œä¹Ÿä¸ä¼šå°†å®ƒä»¬åˆ é™¤ã€‚</p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><ul>
<li><p>é€šè¿‡ä»¥ä¸Šå®éªŒå‘ç°ï¼Œæœ€æ–°ç‰ˆæœ¬çš„babel-loaderï¼Œå¹¶ä¸ä¼šå¯¼è‡´Tree Shakingå¤±æ•ˆã€‚å³ä¸éœ€è¦é…ç½®<code>modules</code>ï¼Œé»˜è®¤ä¸º<code>auto</code>ã€‚</p>
</li>
<li><p>å¦‚æœè¿˜ä¸ç¡®å®šï¼Œä¹Ÿå¯ä»¥å°è¯•å°†<code>@babel/preset-env</code>é…ç½®ä¸­çš„<code>modules</code>ï¼Œè®¾ç½®ä¸º<code>false</code>ã€‚è¿™æ ·å°±ä¼šç¡®ä¿ï¼Œpreset-envä¸ä¼šå¼€å¯ è½¬æ¢ESM çš„æ’ä»¶ã€‚åŒæ—¶ç¡®ä¿äº†Tree Shakingå·¥ä½œçš„å‰æã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-built_in">module</span>.exports = &#123;<br>  mode: <span class="hljs-string">&#x27;production&#x27;</span>,<br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      &#123;<br>        test: <span class="hljs-regexp">/\.js$/</span>,<br>        loader: <span class="hljs-string">&#x27;babel-loader&#x27;</span>,<br>        options: &#123;<br>          presets: [<br>            [<span class="hljs-string">&#x27;@babel/preset-env&#x27;</span>, &#123;<br>              <span class="hljs-comment">// ğŸ‘‡ æ ‡è®°ä¸å…è®¸å°†ES6è½¬æ¢ä¸ºcommonjsï¼Œæœ€æ–°ç‰ˆæœ¬çš„babel-loaderä¸éœ€è¦é…ç½®è¯¥é¡¹</span><br>              modules: <span class="hljs-literal">false</span>, <br>              useBuiltIns: <span class="hljs-string">&#x27;usage&#x27;</span>,<br>              corejs: &#123;<br>              	version: <span class="hljs-number">3</span>,<br>            	&#125;,<br>              targets: <span class="hljs-string">&#x27;&gt; 0.25%&#x27;</span>,<br>            &#125;],<br>          ]<br>        &#125;<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


</li>
</ul>
<h3 id="æ¨¡å—çš„å‰¯ä½œç”¨"><a href="#æ¨¡å—çš„å‰¯ä½œç”¨" class="headerlink" title="æ¨¡å—çš„å‰¯ä½œç”¨"></a>æ¨¡å—çš„å‰¯ä½œç”¨</h3><p>å‰¯ä½œç”¨æ˜¯ï¼šæœ‰ä¸€äº›ä»£ç ï¼Œæ˜¯åœ¨ <code>import</code> æ—¶æ‰§è¡Œäº†ä¸€äº›è¡Œä¸ºï¼Œè¿™äº›è¡Œä¸ºä¸ä¸€å®šå’Œä»»ä½•å¯¼å‡ºç›¸å…³ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œå¦‚æœæ¨¡å—ä»…ä»…åœ¨å¯¼å…¥åå°±ä¼šå¯¹å…¨å±€ã€å¤–éƒ¨ç¯å¢ƒäº§ç”Ÿå½±å“ï¼Œé‚£ä¹ˆå®ƒå°±å±äºå…·æœ‰å‰¯ä½œç”¨çš„æ¨¡å—ã€‚</p>
<p>ä¾‹å¦‚ <code>polyfill</code> ï¼ŒPolyfills é€šå¸¸æ˜¯åœ¨é¡¹ç›®ä¸­å‘å…¨å±€æ³¨å…¥æ–°çš„å†…å®¹ï¼Œè€Œä¸æ˜¯åœ¨å¯¼å…¥åè°ƒç”¨ã€‚</p>
<h3 id="å¼€å¯tree-shaking"><a href="#å¼€å¯tree-shaking" class="headerlink" title="å¼€å¯tree-shaking"></a>å¼€å¯tree-shaking</h3><h4 id="ç”Ÿäº§æ¨¡å¼ä¸‹è‡ªåŠ¨å¼€å¯"><a href="#ç”Ÿäº§æ¨¡å¼ä¸‹è‡ªåŠ¨å¼€å¯" class="headerlink" title="ç”Ÿäº§æ¨¡å¼ä¸‹è‡ªåŠ¨å¼€å¯"></a>ç”Ÿäº§æ¨¡å¼ä¸‹è‡ªåŠ¨å¼€å¯</h4><p>å°†webpackçš„<code>mode</code>è®¾ç½®ä¸º<code>production</code>ï¼Œå°†è‡ªåŠ¨å¼€å¯tree-shakingï¼Œ<font color='red'>ä½†è¦è€ƒè™‘æ¨¡å—çš„å‰¯ä½œç”¨é—®é¢˜ã€‚</font></p>
<ul>
<li><p>åœ¨<code>package.json</code>ä¸­å…¨å±€æ ‡è®°æˆ–åœ¨<code>module.rules</code>ä¸­å¯¹æ¯ç§è§„åˆ™çš„æ–‡ä»¶æ ‡è®°æ˜¯å¦æœ‰å‰¯ä½œç”¨<code>sideEffects</code>ã€‚</p>
<p>å¦‚æœç¡®å®šå…¨éƒ¨æ–‡ä»¶æ²¡æœ‰å‰¯ä½œç”¨ï¼Œåˆ™åœ¨<code>package.json</code>è®¾ç½®<code>&quot;sideEffect&quot;: false</code>ï¼Œé¡¹ç›®å†…æ‰€æœ‰å¼•ç”¨çš„æ–‡ä»¶éƒ½ä¼šè¢«<code>tree-shaking</code>ï¼›</p>
<p>å¦‚æœæŸäº›æ–‡ä»¶ä¼šå­˜åœ¨å‰¯ä½œç”¨ï¼Œåˆ™åœ¨<code>package.json</code>ä¸­æ ‡æ˜å“ªäº›æ–‡ä»¶å­˜åœ¨å‰¯ä½œç”¨ã€‚</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json"># package.json<br>&#123;<br>  <span class="hljs-comment">//...</span><br>  <span class="hljs-attr">&quot;sideEffects&quot;</span>: [<span class="hljs-string">&quot;./src/some-side-effectful-file.js&quot;</span>, <span class="hljs-string">&quot;*.css&quot;</span>] <span class="hljs-comment">//ğŸ‘ˆ ä¸€èˆ¬cssæ–‡ä»¶éƒ½æœ‰å‰¯ä½œç”¨ </span><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>å¦‚æœæŸäº›è§„åˆ™çš„æ–‡ä»¶ä¼šå­˜åœ¨å‰¯ä½œç”¨ï¼Œæ¯”å¦‚cssæ–‡ä»¶ï¼Œåˆ™åœ¨<code>module.rules</code>ä¸­æ ‡è®°<code>sideEffects: true</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      &#123;<br>        test: <span class="hljs-regexp">/\.css$/</span>,<br>        use: [<br>          MiniCSSExtractPlugin.loader,<br>          <span class="hljs-string">&#x27;css-loader&#x27;</span>,<br>        ],<br>        sideEffects: <span class="hljs-literal">true</span>,<span class="hljs-comment">// ğŸ‘ˆ æ ‡è®°å­˜åœ¨å‰¯ä½œç”¨ï¼Œä¼˜å…ˆçº§é«˜äºpackage.jsonä¸­çš„sideEffects</span><br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


</li>
</ul>
<h4 id="å¼€å‘æ¨¡å¼ä¸‹æ‰‹åŠ¨å¼€å¯"><a href="#å¼€å‘æ¨¡å¼ä¸‹æ‰‹åŠ¨å¼€å¯" class="headerlink" title="å¼€å‘æ¨¡å¼ä¸‹æ‰‹åŠ¨å¼€å¯"></a>å¼€å‘æ¨¡å¼ä¸‹æ‰‹åŠ¨å¼€å¯</h4><blockquote>
<p>Tree Shakingå¹¶ä¸æ˜¯ webpack çš„æŸä¸ªé…ç½®é€‰é¡¹ã€‚å®ƒæ˜¯ä¸€ç»„åŠŸèƒ½æ­é…ä½¿ç”¨åçš„ä¼˜åŒ–æ•ˆæœã€‚è¿™ç»„åŠŸèƒ½ä¼šåœ¨ç”Ÿäº§æ¨¡å¼productionä¸‹è‡ªåŠ¨ä½¿ç”¨ã€‚</p>
</blockquote>
<p>åœ¨å¼€å‘æ¨¡å¼ä¸‹<code>mode: &#39;development&#39;</code>ï¼Œé€šè¿‡é…ç½®optimizationä¸­çš„<code>usedExports</code>ã€<code>minimize</code>ä»¥åŠ<code>minimizer</code>ï¼Œèƒ½å¤Ÿæ¨¡ä»¿Tree Shakingçš„å¼€å¯ã€‚</p>
<p><code>usedExports: true</code> è¡¨ç¤ºåœ¨è¾“å‡ºç»“æœä¸­æ¨¡å—åªå¯¼å‡ºå¤–éƒ¨ä½¿ç”¨äº†çš„æˆå‘˜ã€‚</p>
<p>æ‰“åŒ…æŸ¥çœ‹è¾“å‡ºæ–‡ä»¶ï¼š</p>
<p><img src="/webpack4.assets/image-20210222182858889.png" srcset="/img/loading.gif" alt="image-20210222182858889"></p>
<p>æ­¤æ—¶å°±å¯ä»¥é€šè¿‡å‹ç¼©ä¼˜åŒ–ï¼Œåˆ é™¤æ‰ã€Œæ²¡æœ‰ç”¨åˆ°çš„ä»£ç ã€ã€‚</p>
<p><code>minimize: true</code>ï¼š è¡¨ç¤ºè¦åˆ é™¤è¢«æ ‡è®°ä¸º<code>unused</code>çš„ä»£ç å—ã€‚</p>
<p>åˆ é™¤æ³¨é‡Šã€åˆ é™¤æ²¡æœ‰ç”¨åˆ°çš„ä»£ç ã€åˆ é™¤ç©ºç™½ã€æ›¿æ¢å˜é‡åä¸ºç®€çŸ­çš„åç§°ç­‰ã€‚</p>
<blockquote>
<p>å®ƒé»˜è®¤ä½¿ç”¨çš„æ˜¯TerserPluginï¼Œ é™¤éåœ¨optimization .minimizerä¸­æŒ‡å®šä½¿ç”¨å“ªä¸ªæ’ä»¶ã€‚</p>
</blockquote>
<p>å†æ¬¡æ‰“åŒ…ï¼š</p>
<p><img src="/webpack4.assets/image-20210222183217915.png" srcset="/img/loading.gif" alt="image-20210222183217915"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  mode: <span class="hljs-string">&#x27;development&#x27;</span>,<br>  optimization: &#123;<br>    usedExports: <span class="hljs-literal">true</span>,<br>    minimize: <span class="hljs-literal">true</span>,<br>    <span class="hljs-comment">// ä»¥ä¸‹ä¸ºå¯é€‰</span><br>    minimizer: [....]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>






<h3 id="æ­£ç¡®ç¼–å†™å¯ä»¥tree-shakingçš„æ¨¡å—"><a href="#æ­£ç¡®ç¼–å†™å¯ä»¥tree-shakingçš„æ¨¡å—" class="headerlink" title="æ­£ç¡®ç¼–å†™å¯ä»¥tree-shakingçš„æ¨¡å—"></a>æ­£ç¡®ç¼–å†™å¯ä»¥tree-shakingçš„æ¨¡å—</h3><ol>
<li>ä½¿ç”¨<code>ES6 modules</code>è¿›è¡Œå¯¼å‡ºå’Œå¯¼å…¥ã€‚</li>
<li>ç¬¬ä¸‰æ–¹å†…å®¹æŒ‰éœ€åŠ è½½ã€‚</li>
<li>é¿å…åœ¨æ¨¡å—é¡¶å±‚ä½œç”¨åŸŸå†™å…·æœ‰å‰¯ä½œç”¨çš„ä»£ç ã€‚</li>
<li>å¦‚æœæŸä¸ªæ¨¡å—å…·æœ‰å‰¯ä½œç”¨ï¼Œå¯¼å…¥è¯¥æ¨¡å—åˆæ²¡æœ‰è®¿é—®è¯¥æ¨¡å—çš„å†…å®¹ï¼Œåˆ™å¿…é¡»æ³¨æ˜è¯¥æ¨¡å—æœ‰å‰¯ä½œç”¨ã€‚</li>
</ol>
<h2 id="Scope-Hoisting-ä½œç”¨åŸŸæå‡"><a href="#Scope-Hoisting-ä½œç”¨åŸŸæå‡" class="headerlink" title="Scope Hoisting ä½œç”¨åŸŸæå‡"></a>Scope Hoisting ä½œç”¨åŸŸæå‡</h2><p>Scope Hoistingå¯ä»¥è®©webpackæ‰“åŒ…å‡ºæ¥çš„ä»£ç æ–‡ä»¶æ›´å°ã€è¿è¡Œçš„æ›´å¿«ï¼Œæ˜¯Webpack3æ–°æ¨å‡ºçš„åŠŸèƒ½ã€‚</p>
<p>å¼€å‘ç¯å¢ƒä¸‹ï¼Œwebpackä¼šå¯¹è½¬æ¢åçš„æ¨¡å—åŒ…è£¹ä¸Šä¸€å±‚å‡½æ•°ï¼Œè¿™æ ·çš„å¼Šç«¯åœ¨äºï¼š</p>
<ul>
<li>å¤§é‡çš„å‡½æ•°å£°æ˜è¯­å¥å¢å¤§äº†ä»£ç é‡ã€‚ </li>
<li>è¿è¡Œæ—¶åµŒå¥—çš„å‡½æ•°ä½œç”¨åŸŸå˜å¤šï¼Œå†…å­˜å¼€é”€å˜å¤§ã€‚</li>
</ul>
<p>Scope HoistingåŠŸèƒ½ä¼šå°†æ‰€æœ‰çš„æ¨¡å—æŒ‰ç…§å¼•ç”¨é¡ºåºæ”¾åœ¨ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸé‡Œï¼Œç„¶åé€‚å½“çš„é‡å‘½åä¸€äº›å˜é‡ä»¥é˜²æ­¢å‘½åå†²çªã€‚</p>
<p><strong>å¦‚ä½•å¼€å¯ï¼Ÿ</strong></p>
<p>è¿™ä¸ªåŠŸèƒ½åœ¨<code>mode: &#39;production&#39;</code>ä¸‹é»˜è®¤å¼€å¯ã€‚</p>
<p>è€Œå¼€å‘ç¯å¢ƒè¦ç”¨åˆ°<code>wepack.optimize.ModuleConcatenationPlugin</code>æ’ä»¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.dev.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  resolve: &#123;<br>    <span class="hljs-comment">// é’ˆå¯¹nomä¸­çš„ç¬¬ä¸‰æ–¹æ¨¡å—ä¼˜å…ˆé‡‡ç”¨ jsnext:mainä¸­æŒ‡å‘çš„ES6æ¨¡å—åŒ–è¯­æ³•çš„æ’ä»¶</span><br>    mainFields: [<span class="hljs-string">&#x27;jsnext:main&#x27;</span>, <span class="hljs-string">&#x27;browser&#x27;</span>, <span class="hljs-string">&#x27;main&#x27;</span>],<br>  &#125;,<br>  plugins: [<br>    <span class="hljs-comment">// å¼€å¯ Scope Hoisting</span><br>    <span class="hljs-keyword">new</span> webpack.optimize.ModuleConcatenationPlugin(),<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>


<h2 id="splitChunks"><a href="#splitChunks" class="headerlink" title="splitChunks"></a>splitChunks</h2><p><a target="_blank" rel="noopener" href="https://webpack.docschina.org/plugins/split-chunks-plugin/">å®˜æ–¹æ–‡æ¡£é“¾æ¥</a></p>
<p>ç®€å•çš„æ¥è¯´splitChunkså°±æ˜¯Webpackä¸­ä¸€ä¸ªæå–æˆ–åˆ†ç¦»ä»£ç çš„æ’ä»¶ï¼Œ<strong>ä¸»è¦ä½œç”¨æ˜¯æå–å…¬å…±ä»£ç ï¼Œé˜²æ­¢ä»£ç è¢«é‡å¤æ‰“åŒ…ï¼Œæ‹†åˆ†è¿‡å¤§çš„jsæ–‡ä»¶ï¼Œåˆå¹¶é›¶æ•£çš„jsæ–‡ä»¶ã€‚</strong></p>
<p>æåˆ°å‰ç«¯ä¼˜åŒ–ï¼Œæå–å…¬å…±ä»£ç æ˜¯å¿…ä¸å¯å°‘çš„æ‰‹æ®µã€‚åœ¨Webpackå‡ºç°å‰ï¼Œæå–å…¬å…±ä»£ç æ˜¯äººä¸ºå»å¤„ç†ï¼Œè€ŒSplitChunksæ’ä»¶çš„ä½œç”¨å°±æ˜¯é€šè¿‡é…ç½®è®©Webpackå»å¸®ä½ æå–å…¬å…±ä»£ç ã€‚Webpackåˆ›å§‹äººçš„åˆè¡·ä¹Ÿæ˜¯å¸Œæœ›èƒ½æœ‰æ›´å¤šæ—¶é—´å†™æ›´å¤šä»£ç ï¼Œæ‰€ä»¥è¿™ç§çº¯ä½“åŠ›çš„åŠ³åŠ¨äº¤ç»™Webpackå»å®Œæˆã€‚</p>
<h3 id="åŸºæœ¬é…ç½®é¡¹"><a href="#åŸºæœ¬é…ç½®é¡¹" class="headerlink" title="åŸºæœ¬é…ç½®é¡¹"></a>åŸºæœ¬é…ç½®é¡¹</h3><ul>
<li><p><code>chunks</code>é€‰é¡¹ï¼Œå†³å®šè¦æå–é‚£äº›æ¨¡å—ã€‚</p>
</li>
<li><ul>
<li><p>é»˜è®¤æ˜¯<code>async</code>ï¼šå°†æ¯ä¸ªå¼‚æ­¥æ¨¡å—æå–æˆä¸€ä¸ªchunkï¼Œå†æå–ä¸åŒå¼‚æ­¥æ¨¡å—çš„ç›¸åŒä¾èµ–ï¼Œå¹¶æ‰“åŒ…åˆ°ä¸€ä¸ªæ–°çš„chunkä¸­ã€‚</p>
</li>
<li><blockquote>
<p>å¼‚æ­¥åŠ è½½çš„æ¨¡å—ï¼šé€šè¿‡<code>import(&#39;xxx&#39;)</code>æˆ–<code>require([&#39;xxx&#39;],() =&gt;&#123;&#125;)</code>åŠ è½½çš„æ¨¡å—ã€‚</p>
</blockquote>
</li>
</ul>
</li>
<li><ul>
<li><p><code>initial</code>ï¼šä»æ¯ä¸ªå…¥å£è¿›è¡Œæ·±åº¦éå†ï¼Œå°†ä¸€ä¸ªå…¥å£ä¾èµ–çš„æ‰€æœ‰åŒæ­¥æ¨¡å—ç”Ÿæˆä¸€ä¸ªinitial chunkï¼Œç„¶åå¯¹ä¸åŒçš„initial chunkçš„ç›¸åŒä¾èµ–è¿›è¡Œæå–å¹¶æ‰“åŒ…åˆ°æ–°çš„chunkä¸­ã€‚ï¼ˆæ¯ä¸ªå¼‚æ­¥æ¨¡å—ä¹Ÿä¼šæ‰“åŒ…æˆå•ç‹¬chunkã€‚ï¼‰</p>
</li>
<li><blockquote>
<p>åŒæ­¥åŠ è½½çš„æ¨¡å—ï¼šé€šè¿‡ <code>import xxx</code>æˆ–<code>require(&#39;xxx&#39;)</code>åŠ è½½çš„æ¨¡å—ã€‚</p>
</blockquote>
</li>
</ul>
</li>
<li><ul>
<li><code>all</code>ï¼šå°†æ‰€æœ‰initial chunkä»¥åŠæ‰€æœ‰å¼‚æ­¥æ¨¡å—ç”Ÿæˆçš„non-initial chunkæ”¾åœ¨ä¸€èµ·è¿›è¡Œåˆ†ææå–ã€‚</li>
</ul>
</li>
</ul>
<ul>
<li><p><code>minSize</code>é€‰é¡¹ï¼šè§„å®šè¢«æå–çš„æ¨¡å—åœ¨å‹ç¼©å‰çš„å¤§å°æœ€å°å€¼ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œé»˜è®¤ä¸º30000ï¼Œåªæœ‰è¶…è¿‡äº†30000å­—èŠ‚æ‰ä¼šè¢«æå–ã€‚</p>
</li>
<li><p><code>maxSize</code>é€‰é¡¹ï¼šæŠŠæå–å‡ºæ¥çš„æ¨¡å—æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡maxSizeå€¼ï¼Œå¦‚æœè¶…è¿‡äº†ï¼Œè¦å¯¹å…¶è¿›è¡Œåˆ†å‰²å¹¶æ‰“åŒ…ç”Ÿæˆæ–°çš„æ–‡ä»¶ã€‚å•ä½ä¸ºå­—èŠ‚ï¼Œé»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºä¸é™åˆ¶å¤§å°ã€‚</p>
</li>
<li><p><code>minChunks</code>é€‰é¡¹ï¼šè¡¨ç¤ºè¦è¢«æå–çš„æ¨¡å—æœ€å°è¢«å¼•ç”¨æ¬¡æ•°ï¼Œå¼•ç”¨æ¬¡æ•°è¶…è¿‡æˆ–ç­‰äºminChunkså€¼ï¼Œæ‰èƒ½è¢«æå–ã€‚</p>
</li>
<li><p><code>maxAsyncRequests</code>é€‰é¡¹ï¼šæœ€å¤§çš„æŒ‰éœ€(å¼‚æ­¥)åŠ è½½æ¬¡æ•°ï¼Œé»˜è®¤ä¸º 6ã€‚</p>
</li>
<li><p><code>maxInitialRequests</code>é€‰é¡¹ï¼šæ‰“åŒ…åçš„å…¥å£æ–‡ä»¶åŠ è½½æ—¶ï¼Œè¿˜èƒ½åŒæ—¶åŠ è½½jsæ–‡ä»¶çš„æ•°é‡ï¼ˆåŒ…æ‹¬å…¥å£æ–‡ä»¶ï¼‰ï¼Œé»˜è®¤ä¸º4ã€‚</p>
<blockquote>
<p>ä¼˜å…ˆçº§ ï¼š</p>
<ul>
<li>webpack5ä¸­ maxInitialRequests / maxAsyncRequests&lt; maxSize &lt; minSizeã€‚</li>
<li>webpack4ä¸­å¥½åƒå­˜åœ¨bugï¼ŒminSize/maxSizeçš„ä¼˜å…ˆçº§æ²¡æœ‰maxInitialRequests / maxAsyncRequestsé«˜ã€‚</li>
</ul>
</blockquote>
</li>
<li><p><code>automaticNameDelimiter</code>é€‰é¡¹ï¼šæ‰“åŒ…ç”Ÿæˆçš„jsæ–‡ä»¶åçš„åˆ†å‰²ç¬¦ï¼Œé»˜è®¤ä¸º<code>~</code>ã€‚</p>
</li>
<li><p><code>name</code>é€‰é¡¹ï¼šæ‰“åŒ…ç”Ÿæˆjsæ–‡ä»¶çš„åç§°ã€‚</p>
</li>
<li><p><code>cacheGroups</code>é€‰é¡¹ï¼Œæ ¸å¿ƒé‡ç‚¹ï¼Œ<strong>é…ç½®æå–æ¨¡å—çš„æ–¹æ¡ˆ</strong>ã€‚é‡Œé¢æ¯ä¸€é¡¹ä»£è¡¨ä¸€ä¸ªæå–æ¨¡å—çš„æ–¹æ¡ˆã€‚ä¸‹é¢æ˜¯<code>cacheGroups</code>æ¯é¡¹ä¸­ç‰¹æœ‰çš„é€‰é¡¹ï¼Œå…¶ä½™é€‰é¡¹å’Œå¤–é¢ä¸€è‡´ï¼Œè‹¥<code>cacheGroups</code>æ¯é¡¹ä¸­æœ‰ï¼Œå°±æŒ‰é…ç½®çš„ï¼Œæ²¡æœ‰å°±ä½¿ç”¨å¤–é¢é…ç½®çš„ã€‚</p>
</li>
<li><ul>
<li><code>test</code>é€‰é¡¹ï¼šç”¨æ¥åŒ¹é…è¦æå–çš„æ¨¡å—çš„èµ„æºè·¯å¾„æˆ–åç§°ã€‚å€¼æ˜¯æ­£åˆ™æˆ–å‡½æ•°ã€‚</li>
<li><code>priority</code>é€‰é¡¹ï¼šæ–¹æ¡ˆçš„ä¼˜å…ˆçº§ï¼Œå€¼è¶Šå¤§è¡¨ç¤ºæå–æ¨¡å—æ—¶ä¼˜å…ˆé‡‡ç”¨æ­¤æ–¹æ¡ˆã€‚é»˜è®¤å€¼ä¸º0ã€‚</li>
<li><code>reuseExistingChunk</code>é€‰é¡¹ï¼š<code>true</code>/<code>false</code>ã€‚ä¸º<code>true</code>æ—¶ï¼Œå¦‚æœå½“å‰è¦æå–çš„æ¨¡å—ï¼Œåœ¨å·²ç»åœ¨æ‰“åŒ…ç”Ÿæˆçš„<em>js</em>æ–‡ä»¶ä¸­å­˜åœ¨ï¼Œåˆ™å°†é‡ç”¨è¯¥æ¨¡å—ï¼Œè€Œä¸æ˜¯æŠŠå½“å‰è¦æå–çš„æ¨¡å—æ‰“åŒ…ç”Ÿæˆæ–°çš„<em>js</em>æ–‡ä»¶ã€‚</li>
<li><code>enforce</code>é€‰é¡¹ï¼š<code>true</code>/<code>false</code>ã€‚ä¸º<code>true</code>æ—¶ï¼Œå¿½ç•¥<code>minSize</code>ï¼Œ<code>minChunks</code>ï¼Œ<code>maxAsyncRequests</code>å’Œ<code>maxInitialRequests</code>å¤–é¢é€‰é¡¹</li>
</ul>
</li>
</ul>
<h3 id="è‡ªå·±åˆ†æå‡ºçš„é»˜è®¤åˆ†å‰²ç­–ç•¥"><a href="#è‡ªå·±åˆ†æå‡ºçš„é»˜è®¤åˆ†å‰²ç­–ç•¥" class="headerlink" title="è‡ªå·±åˆ†æå‡ºçš„é»˜è®¤åˆ†å‰²ç­–ç•¥"></a>è‡ªå·±åˆ†æå‡ºçš„é»˜è®¤åˆ†å‰²ç­–ç•¥</h3><p>ç®€å•æƒ…å†µä¸‹ï¼ŒWebpackçš„splitChunksæ’ä»¶<strong>åŸºæœ¬ç­–ç•¥</strong>ï¼ˆpriorityä¸º0ï¼Œå³é»˜è®¤ç­–ç•¥ï¼‰ï¼š</p>
<ol>
<li><p>ä»ä¾èµ–å›¾çš„æ‹“æ‰‘é¡¶ç‚¹<code>vi</code>å¼€å§‹å¯¹<code>vi</code>æ‰€ä¾èµ–çš„node_modulesç›®å½•ä¸‹çš„æ‰€æœ‰ç¬¬ä¸‰æ–¹æ¨¡å—è¿›è¡Œåˆ†ç¦»ï¼Œå‘½åä¸º<code>vendors~vi</code>ã€‚</p>
</li>
<li><p>å¦‚æœä¸åŒçš„æ‹“æ‰‘é¡¶ç‚¹<code>v1ã€v2</code>ä¾èµ–ç›¸åŒçš„<strong>ä¸€ä¸ªæˆ–å¤šä¸ªnode_modulesä¸‹çš„ç¬¬ä¸‰æ–¹æ¨¡å—</strong>ï¼Œåˆ™å¯¹<code>vendors~v1ã€vendors~v2</code>è¿›ä¸€æ­¥åˆ†ç¦»ä¸º<code>vendors~v1~v2</code>å’Œ<code>vendor~v1ã€vendors~v2</code>ï¼Œè¿™ç§åˆ†ç¦»ä¿è¯äº†<code>vendors~v1</code>å’Œ<code>vendors~v2</code>ä¸å†å…·æœ‰äº¤é›†ã€‚</p>
<p>ä¾‹å¦‚ï¼šv1ã€v2åŒæ—¶ä¾èµ–äº†lodashå’Œvueï¼Œåˆ™lodashå’Œvueä¼šè¢«æ‰“åŒ…åˆ°<code>vendors~v1~v2</code>çš„chunkä¸­ã€‚</p>
</li>
<li><p>æ‰¾åˆ°è¢«<code>v1ã€v2...vn</code>ä¾èµ–äº†ä¸¤æ¬¡åŠå…¶ä¸Šï¼Œä¸”å‹ç¼©å‰æ¨¡å—å¤§äºç­‰äº30000bï¼ˆçº¦ç­‰äº30kbï¼‰çš„<strong>æ–‡ä»¶æ¨¡å—</strong>ï¼Œæ­¤ç±»æ¨¡å—ä¼šè¢«ä¸€èµ·æ‰“åŒ…åˆ°åä¸º<code>v1~v2~...vn</code>çš„chunkã€‚å°äº30kbçš„æ¨¡å—ï¼Œå³ä½¿æ˜¯è¢«å¤šä¸ªinitial chunkä¾èµ–ï¼Œä¹Ÿåªä¼šæ‰“åŒ…åˆ°initial chunkä¸­ï¼Œä¸ä¼šå•ç‹¬åˆ†ç¦»ï¼Œ<strong>è¿™æ ·è™½ç„¶é‡å¤æ‰“åŒ…äº†ï¼Œä½†å¯ä»¥å‡å°‘è¯·æ±‚æ¬¡æ•°</strong>ã€‚</p>
<p>ä¾‹å¦‚ï¼šå¦‚æœv1ã€v2ã€v3åŒæ—¶ä¾èµ–äº†src/lib/a.jsã€src/lib/b.jsï¼Œä¸”è¿™ä¸¤ä¸ªæ–‡ä»¶éƒ½å¤§äº30kbï¼Œåˆ™src/lib/a.jsã€src/lib/b.jsä¼šè¢«æ‰“åŒ…åˆ°åä¸º<code>v1~v2~v3</code>çš„chunkä¸­ã€‚</p>
</li>
<li><p>å¯¹åŠ¨æ€å¯¼å…¥çš„æ‡’åŠ è½½æ¨¡å—ï¼ˆå¼‚æ­¥/æ‡’åŠ è½½ï¼‰å•ç‹¬åˆ†ç¦»ï¼Œå¦‚æœæ‡’åŠ è½½æ¨¡å—ä¸­ä¾èµ–äº†intial chunkä¸­å·²ç»æ‰“åŒ…äº†çš„åŒæ­¥æ¨¡å—ï¼Œåˆ™æ‡’åŠ è½½æ¨¡å—ä¸­ä¸ä¼šå†æ‰“åŒ…è¿™äº›æ¨¡å—ï¼Œè€Œæ˜¯åªè®°å½•å¼•ç”¨ã€‚</p>
</li>
</ol>
<blockquote>
<p>ç”±äºsplitChunks.chunks é»˜è®¤å€¼ä¸ºâ€asyncâ€ï¼Œæ‰€ä»¥åªä¼šå¯¹ä¸åŒçš„æ‡’åŠ è½½æ¨¡å—è¿›è¡Œä¸Šè¿°åˆ†ç¦»æ“ä½œï¼Œè€Œä¸ä¼šå¯¹ä¸åŒçš„å…¥å£æ¨¡å—initial chunkè¿›è¡Œä¾èµ–åˆ†ç¦»ã€‚ä¸‹é¢å°±æ¥è¯´è¯´å¦‚ä½•é€‰å–éœ€è¦è¿›è¡Œåˆ†å‰²æ“ä½œçš„æ¨¡å—ã€‚</p>
</blockquote>
<h3 id="chunkså±æ€§"><a href="#chunkså±æ€§" class="headerlink" title="chunkså±æ€§"></a>chunkså±æ€§</h3><p>åœ¨splitChunksä¸­ï¼Œchunksæ˜¯ä¸€ä¸ªå¯é…ç½®çš„å±æ€§ï¼Œå®ƒç”¨äºæŒ‡ç¤ºæ’ä»¶å¯¹å“ªäº›chunkåˆ†ç¦»ç›¸åŒçš„ä¾èµ–ï¼Œè¯¥å±æ€§æ—¢å¯ä»¥åœ¨splitChunks.chunksä¸­å…¨å±€é…ç½®ï¼Œä¹Ÿå¯ä»¥åœ¨cacheGroups[group].chunksä¸­é…ç½®å¹¶è¦†ç›–å…¨å±€çš„é…ç½®ã€‚</p>
<p>è¯¥å±æ€§çš„å¯é€‰å€¼æœ‰ï¼š</p>
<ol>
<li><p>â€œasyncâ€ï¼šé»˜è®¤å€¼ï¼Œå°†æ‡’åŠ è½½æ¨¡å—è¿›è¡Œåˆ†ç¦»ï¼Œç„¶ååªå¯¹æ‡’åŠ è½½æ¨¡å—è¿›è¡Œé»˜è®¤çš„åˆ†å‰²å¤„ç†ã€‚</p>
<p>ä¾‹å¦‚å•å…¥å£çš„æƒ…å†µï¼š</p>
<p><img src="/webpack4.assets/image-20210329155145451.png" srcset="/img/loading.gif" alt="image-20210329155145451"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// å•å…¥å£</span><br>entry: <span class="hljs-string">&#x27;./src/main.js&#x27;</span><br>optimization: &#123;<br>    splitChunks: &#123;<br>        chunks: <span class="hljs-string">&#x27;async&#x27;</span>, <span class="hljs-comment">// ğŸ‘ˆ é»˜è®¤å°±ä¸º&#x27;async&#x27;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// main.jså†…åŠ¨æ€å¯¼å…¥äº†ä¸¤ä¸ªæ¨¡å—</span><br><span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;./async.js&#x27;</span>).then( <span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(m.default));<br><span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;./lazy.js&#x27;</span>).then( <span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(m.default));<br>    <br><span class="hljs-comment">// ğŸ‘† æ­¤æ—¶ï¼Œwebpackåªä¼šå¯¹ src/async.js å’Œ src/lazy.jsè¿›è¡Œä¾èµ–åˆ†æã€‚å¹¶åˆ†ç¦»å‡ºä»–ä»¬çš„å…±åŒä¾èµ–ã€‚</span><br><span class="hljs-comment">// åœ¨ModuleGraphä¸­ src/async.jså°±æ˜¯v1é¡¶ç‚¹ï¼Œsrc/lazyå°±æ˜¯v2é¡¶ç‚¹</span><br></code></pre></td></tr></table></figure>
<p><img src="/webpack4.assets/image-20210329155225599.png" srcset="/img/loading.gif" alt="åˆ†æasync"></p>
</li>
</ol>
<p>   åˆä¾‹å¦‚å¤šå…¥å£çš„æƒ…å†µï¼š</p>
<p>   <img src="/webpack4.assets/image-20210329154956362.png" srcset="/img/loading.gif" alt="Module Graph"></p>
   <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// å¤šå…¥å£</span><br><span class="hljs-comment">// ================= webpack.config.js ==================</span><br>entry: &#123;<br>	main: <span class="hljs-string">&#x27;./src/main.js&#x27;</span>,<br>    index: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>&#125;,<br>optimization: &#123;<br>    splitChunks: &#123;<br>        chunks: <span class="hljs-string">&#x27;async&#x27;</span>, <span class="hljs-comment">// ğŸ‘ˆ é»˜è®¤å°±ä¸º&#x27;async&#x27;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// =============== main.jså†…åŠ¨æ€å¯¼å…¥äº†ä¸¤ä¸ªæ¨¡å— ==================</span><br><span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;./async.js&#x27;</span>).then( <span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(m.default));<br><span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;./lazy.js&#x27;</span>).then( <span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(m.default));<br>    <br><span class="hljs-comment">// ================ index.jså†…åŠ¨æ€å¯¼å…¥äº†ä¸€ä¸ªæ¨¡å— ==================</span><br><span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;./index-lazy.js&#x27;</span>).then( <span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(m.default));<br>    <br><span class="hljs-comment">// ğŸ‘† æ­¤æ—¶ï¼Œwebpackåªä¼šå¯¹ src/async.jsã€src/lazy.jsã€src/index-lazyè¿›è¡Œä¾èµ–åˆ†æã€‚å¹¶åˆ†ç¦»å‡ºä»–ä»¬çš„å…±åŒä¾èµ–ã€‚</span><br><span class="hljs-comment">// åœ¨ModuleGraphä¸­ src/async.jså°±æ˜¯v1é¡¶ç‚¹ï¼Œsrc/lazyå°±æ˜¯v2é¡¶ç‚¹ï¼Œsrc/index-lazyå°±æ˜¯v3é¡¶ç‚¹ã€‚</span><br></code></pre></td></tr></table></figure>
<p>   <img src="/webpack4.assets/image-20210329155347635.png" srcset="/img/loading.gif" alt="å¤šå…¥å£asyncä¾èµ–å›¾"></p>
<ol start="2">
<li><p>â€œinitialâ€ï¼šåªå¯¹initial chunkè¿›è¡Œåˆ†å‰²å¤„ç†ï¼Œå³åœ¨<code>Module Graph</code>ä¸­å°†<strong>æ‡’åŠ è½½æ¨¡å—åŠå…¶ç‹¬ç«‹ä¾èµ–çš„æ¨¡å—ç§»é™¤å</strong>å†è¿›è¡Œä¾èµ–åˆ†æã€‚</p>
<p>å•å…¥å£ä¾èµ–å›¾ï¼š</p>
<p><img src="/webpack4.assets/image-20210329155522181.png" srcset="/img/loading.gif" alt="image-20210329155522181"></p>
<p>å•å…¥å£initial chunkä¾èµ–åˆ†æï¼š</p>
<p><img src="/webpack4.assets/image-20210329155613618.png" srcset="/img/loading.gif" alt="image-20210329155613618"></p>
<p>å¤šå…¥å£ä¾èµ–å›¾ï¼š</p>
<p><img src="/webpack4.assets/image-20210329154956362.png" srcset="/img/loading.gif" alt="Module Graph"></p>
<p>å¤šå…¥å£initial chunksä¾èµ–åˆ†æï¼š</p>
<p><img src="/webpack4.assets/image-20210329155813684.png" srcset="/img/loading.gif" alt="image-20210329155813684"></p>
</li>
<li><p>â€œallâ€ï¼šé…ç½®chunkä¸ºè¯¥å€¼æ—¶ï¼Œ<strong>ä¼šå¯¹initial chunkå’Œnon-initial chunkåŒæ—¶åˆ†æä¾èµ–ï¼Œåˆ†ç¦»å‡ºå…±æœ‰çš„ä¾èµ–é¡¹ã€‚</strong></p>
<p>å•å…¥å£æƒ…å†µä¸‹ï¼Œé‡‡å–é»˜è®¤ç­–ç•¥æ—¶ï¼ŒsplitChunks.chunks = â€œallâ€<strong>åªæœ‰ä¸€ä¸ªä½œç”¨</strong>ï¼Œå°±æ˜¯æå–å‡ºæ‡’åŠ è½½æ¨¡å—ä¾èµ–çš„node_modulesç›®å½•ä¸‹ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œå¹¶æ‰“åŒ…åˆ°intial chunkä¸­ã€‚</p>
<p>å¤šå…¥å£æƒ…å†µä¸‹ï¼Œé‡‡å–é»˜è®¤ç­–ç•¥æ—¶ï¼ŒsplitChunks.chunks = â€œallâ€<strong>è¿˜æœ‰å¦å¤–ä¸€ä¸ªä½œç”¨</strong>ï¼Œå°±æ˜¯æå–å‡ºmain.jså…¥å£çš„æ‡’åŠ è½½æ¨¡å—ä¸index.jsçš„initial chunkçš„ç›¸åŒä¾èµ–é¡¹ï¼Œå¹¶æ‰“åŒ…æˆå•ç‹¬çš„chunkã€‚</p>
<blockquote>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨splitChunks.chunks = â€œallâ€æ—¶ï¼Œæ‰“åŒ…å‡ºçš„æ€»ä½“ç§¯æ˜¯æœ€å°çš„ï¼Œåˆ†ç¦»å‡ºçš„æ–‡ä»¶æ•°é‡æ˜¯æœ€å¤šçš„ã€‚</p>
</blockquote>
</li>
</ol>
<h3 id="cacheGroups"><a href="#cacheGroups" class="headerlink" title="cacheGroups"></a>cacheGroups</h3><p>splitChunks.cacheGroupså¯ä»¥ç”¨äºæå–ä¸€äº›æ¨¡å—æ‰“åŒ…æˆä¸€ä¸ªchunkã€‚</p>
<p>é…ç½®è¯¥å±æ€§æœ‰ä»¥ä¸‹ç”¨å¤„ï¼š</p>
<ol>
<li><p>â­ å°†è¿‡å¤§çš„chunkåˆ†å‰²ï¼Œæå–ä¸€äº›é¦–å±ä¾èµ–çš„ç¬¬ä¸‰æ–¹ä»£ç ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = &#123;<br>    optimization: &#123;<br>        splitChunks: &#123;<br>            chunks: <span class="hljs-string">&#x27;initial&#x27;</span>,<br>            <span class="hljs-comment">// ğŸ‘‡ å°†element-ui æå–æˆå•ç‹¬ä¸€ä¸ªchunk</span><br>            cacheGroups: &#123;<br>                elementUI: &#123;<br>                    chunks: <span class="hljs-string">&#x27;all&#x27;</span>,<br>                    name: <span class="hljs-string">&#x27;element-ui&#x27;</span>,<br>                    test: <span class="hljs-regexp">/[\\/]node_modules[\\/].*element-ui/</span>,<br>                    priority: <span class="hljs-number">1</span><br>                &#125;,<br>                jquery: &#123;<br>                    chunks: <span class="hljs-string">&#x27;all&#x27;</span>,<br>                    name: <span class="hljs-string">&#x27;jquery&#x27;</span>,<br>                    test: <span class="hljs-regexp">/[\\/]node_modules[\\/].*jquery/</span>,<br>                    priority: <span class="hljs-number">1</span><br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


</li>
</ol>
<ol start="2">
<li><p>åˆå¹¶å¤ªè¿‡çç¢çš„chunkï¼Œå‡å°‘è¯·æ±‚æ¬¡æ•°ã€‚</p>
<p>ä¾‹å¦‚ï¼šåœ¨å•å…¥å£ä¸”splitChunks.chunks = â€˜allâ€™æ—¶ï¼Œæ‡’åŠ è½½ä¼šåˆ†ç¦»å‡ºç¬¬ä¸‰æ–¹ä¾èµ–<code>vendors~lazy</code>ï¼Œå¦‚æœä¸æƒ³è®©å®ƒå’Œ<code>vendors~initial-chunk</code>å‰²è£‚å¼€æ¥ï¼Œå¯ä»¥å°†å¼‚æ­¥æ¨¡å—ä¾èµ–çš„ç¬¬ä¸‰æ–¹æ¨¡å—æå‰åŠ è½½ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = &#123;<br>    optimization: &#123;<br>        splitChunks: &#123;<br>            chunks: <span class="hljs-string">&#x27;initial&#x27;</span>,<br>            cacheGroups: &#123;<br>                <span class="hljs-string">&quot;vendors&quot;</span>: &#123;<br>                    name: <span class="hljs-string">&quot;vendors&quot;</span>,<br>                    test: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>,<br>                    priority: <span class="hljs-number">1</span><br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>






</li>
</ol>
<h3 id="chunkNameå’ŒfileName"><a href="#chunkNameå’ŒfileName" class="headerlink" title="chunkNameå’ŒfileName"></a>chunkNameå’ŒfileName</h3><p>åœ¨Webpackä¸­ï¼Œæ¨¡å—æ‰“åŒ…æˆchunkï¼Œchunkåˆ†ç¦»æˆchunkç»„ï¼Œæ¯ä¸€ä¸ªchunkåº”è¯¥æ‹¥æœ‰ä¸€ä¸ªåå­—ï¼Œchunkæ‰“åŒ…å‡ºçš„æ–‡ä»¶ä¹Ÿåº”è¯¥æ‹¥æœ‰ä¸€ä¸ªåå­—ã€‚</p>
<p>åœ¨ä¹‹å‰æåˆ°ï¼Œchunkåˆ†ä¸º<code>initial chunk</code>å’Œ<code>no-initial chunk</code>ã€‚</p>
<ul>
<li><p><code>initial chunk</code>å³ä¸»chunkï¼Œæ˜¯æ ¹æ®å…¥å£æ¨¡å—çš„ä¾èµ–ç”Ÿæˆçš„ä¸»çº¿ã€‚è¯¥ç±»å‹çš„chunkåå­—æ˜¯åœ¨å®šä¹‰<code>entry</code>æ—¶è®¾å®šçš„ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = &#123;<br>    entry: &#123;<br>        main: <span class="hljs-string">&#x27;./src/main.js&#x27;</span>, <span class="hljs-comment">// æ­¤å…¥å£ç”Ÿæˆçš„intial chunkçš„chunkNameä¸ºmain</span><br>        index: <span class="hljs-string">&#x27;./src/index.js&#x27;</span> <span class="hljs-comment">// æ­¤å…¥å£ç”Ÿæˆçš„initial chunkçš„chunkNameä¸ºindex</span><br>    &#125;,<br>    output: &#123;<br>        path: path.resolve(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>),<br>        filename: <span class="hljs-string">&quot;initial-chunk-[name].[hash].js&quot;</span> <span class="hljs-comment">// intial chunkæ‰“åŒ…ç»“æœæ–‡ä»¶å</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>initial chunkæ‰“åŒ…åçš„æ–‡ä»¶åï¼ˆ<code>asset</code>ï¼‰æ˜¯åœ¨output.filenameé…ç½®çš„ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js">output: &#123;<br> filename: <span class="hljs-string">&quot;[name].[hash:8].js&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>


</blockquote>
</li>
<li><p><code>non-initial chunk</code>ä¸€èˆ¬ç”±ä¸‰ç§æƒ…å†µç”Ÿæˆã€‚â‘  å¼‚æ­¥å¯¼å…¥ï¼ˆæ‡’åŠ è½½ï¼‰ã€‚ â‘¡ ç”±splitChunksé»˜è®¤çš„åˆ†å‰²ç­–ç•¥ç”Ÿæˆã€‚â‘¢ ç”±splitChunks.cacheGroupsè‡ªå®šä¹‰çš„åˆ†å‰²ç­–ç•¥ç”Ÿæˆã€‚</p>
<p>å¯¹äºå¼‚æ­¥å¯¼å…¥çš„æ¨¡å—ç”Ÿæˆçš„chunkå‘½åï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span>(<span class="hljs-comment">/* webpackChunkName: &quot;lazy&quot; */</span><span class="hljs-string">&#x27;./lib/lazy.js&#x27;</span>) <span class="hljs-comment">// ä½¿ç”¨é­”æ³•æ³¨é‡Šä¸ºchunkå‘½åã€‚</span><br></code></pre></td></tr></table></figure>
<p>å¯¹äºnode_modulesæˆ–è€…&gt; 30kbçš„å…±åŒä¾èµ–é¡¹å‘½åè§„åˆ™ï¼š</p>
<ul>
<li><p><code>vendors-v1~v2</code> ğŸ‘ˆ node_modules</p>
</li>
<li><p><code>v1~v2</code>  &gt; 30kbå…±åŒä¾èµ–é¡¹ã€‚</p>
</li>
</ul>
<p>å¯¹splitChunks.cacheGroupsåˆ†å‰²å‡ºçš„chunkå‘½åï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-comment">//....</span><br>    optimization: &#123;<br>        <span class="hljs-comment">//....</span><br>        splitChunks: &#123;<br>            cacheGroups: &#123;<br>                lodash: &#123;  <span class="hljs-comment">// ğŸ‘ˆ keyçš„ä½œç”¨åœ¨äº å‡å¦‚v1å’Œv2ä¾èµ–äº†lodash</span><br>                    	  <span class="hljs-comment">// Webpack4 é»˜è®¤çš„chunkNameä¸º key~v1~v2</span><br>                    name: <span class="hljs-string">&#x27;lodash&#x27;</span>,  <span class="hljs-comment">// nameçš„ä½œç”¨åœ¨äºæ›¿æ¢æ‰é»˜è®¤çš„chunkName</span><br>                    test: <span class="hljs-regexp">/lodash/</span>,<br>                    chunks: <span class="hljs-string">&#x27;initial&#x27;</span>,<br>                    priority: <span class="hljs-number">1</span><br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>â­ non-initial chunkæ‰“åŒ…å‡ºçš„æ–‡ä»¶ååœ¨output.chunkFilenameä¸­é…ç½®ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">output: &#123;<br> <span class="hljs-comment">//...</span><br> chunkFilename: <span class="hljs-string">&quot;non-initial-[name].js&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>


</blockquote>
</li>
</ul>
<h2 id="HMR"><a href="#HMR" class="headerlink" title="HMR"></a>HMR</h2><p>HMRåŠŸèƒ½å°±æ˜¯çƒ­æ›´æ–°åŠŸèƒ½ã€‚å¼€å‘ç¯å¢ƒä¸‹ï¼Œå½“æˆ‘ä»¬ä¿®æ”¹äº†jsä»£ç ï¼Œwebpackä¼šé‡æ–°æ‰“åŒ…ï¼ŒdevServerä¼šåˆ·æ–°é¡µé¢ã€‚è€Œå½“æˆ‘ä»¬å¼€å¯HMRåï¼Œwebpackä¸ä¼šå°†æ‰€æœ‰èµ„æºé‡æ–°æ‰“åŒ…ï¼Œè€Œæ˜¯åªæ›´æ–°ä¿®æ”¹äº†çš„æ¨¡å—ï¼Œä»è€Œ<strong>æé«˜æ„å»ºé€Ÿåº¦ï¼Œè€Œä¸”èƒ½å¤Ÿåœ¨ä¿ç•™é¡µé¢åŸæœ‰æ•°æ®çŠ¶æ€çš„åŸºç¡€ä¸Šï¼Œå¿«é€Ÿåœ°å°†ä¿®æ”¹äº†çš„å†…å®¹ä½“ç°åˆ°é¡µé¢ä¸Šã€‚</strong></p>
<p>CSSçš„HMRï¼šstyle-loaderå·²ç»å†…éƒ¨å®ç°äº†~</p>
<p>JSçš„HMRï¼šéœ€è¦åœ¨devServerä¸­é…ç½®ï¼ŒåŒæ—¶éœ€è¦æ‰‹å†™æ¯ä¸ªæ¨¡å—æ›´æ–°çš„é€»è¾‘ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-comment">//...</span><br>    devServer: &#123;<br>        <span class="hljs-comment">//...</span><br>        hot: <span class="hljs-literal">true</span> <span class="hljs-comment">// ğŸ‘ˆ å¼€å¯HMR</span><br>    &#125;<br>&#125;<br><span class="hljs-comment">// main.js</span><br><br><span class="hljs-keyword">import</span> A <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./lib/a.js&#x27;</span><br><br><span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&#x27;#app&#x27;</span>).innerHTML = A.msg;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-built_in">module</span>.hot) &#123;<br>    <span class="hljs-comment">// ğŸ‘‡ æ‰‹å†™å½“ src/lib/a.jsä¿®æ”¹æ—¶çƒ­æ›´æ–°çš„é€»è¾‘</span><br>    <span class="hljs-built_in">module</span>.hot.accept(<span class="hljs-string">&#x27;./lib/a.js&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&#x27;#app&#x27;</span>).innerHTML = A.msg;<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>â—â—   ä»¥ä¸Šæ˜¯webpack4çš„é…ç½®ï¼Œwebpack5ä¸­ï¼ŒHMRçš„é…ç½®æœ‰ç‚¹ä¸ä¸€æ ·ã€‚</p>
</blockquote>
<h2 id="preFetch"><a href="#preFetch" class="headerlink" title="preFetch"></a>preFetch</h2><p>æ‡’åŠ è½½çš„æ¨¡å—ä¸€èˆ¬åœ¨çœŸæ­£éœ€è¦æ—¶æ‰ä¼šå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè€Œä½•æ—¶æ‰æ˜¯æ‡’åŠ è½½æ¨¡å—è¢«çœŸæ­£éœ€è¦äº†å‘¢ï¼Ÿ</p>
<p>ï¼šå½“çœŸæ­£æ‰§è¡Œ<code>import(&#39;./lazy.js&#39;)</code>æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šå‘æœåŠ¡å™¨è¯·æ±‚æ‡’åŠ è½½æ¨¡å—ã€‚</p>
<p>æ‰€ä»¥ä¸€èˆ¬<code>import(./lazy.js)</code>ä¼šå°è£…åˆ°UIäº¤äº’çš„å›è°ƒå‡½æ•°ä¸­ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&#x27;button&#x27;</span>).onclick = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.lazyLoaded) &#123;<br>        <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;./lazy.js&#x27;</span>).then( <span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> &#123;<span class="hljs-built_in">this</span>.innerHTML = m.default.text&#125; );<br>        <span class="hljs-built_in">this</span>.lazyLoaded = <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>åªæœ‰å½“buttonçš„clickäº‹ä»¶ç¬¬ä¸€æ¬¡è§¦å‘æ—¶æ‰ä¼šå‘æœåŠ¡å™¨è¯·æ±‚ lazy.jsã€‚</p>
<p>ä½†æ˜¯webpackæä¾›å¦å¤–ä¸€ç§æŠ€æœ¯ï¼Œå½“æµè§ˆå™¨ç©ºé—²æ—¶ä¼šè‡ªåŠ¨è¯·æ±‚è®¾ç½®äº†prefetchçš„æ‡’åŠ è½½æ¨¡å—ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&#x27;button&#x27;</span>).onclick = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.lazyLoaded) &#123;<br>        <span class="hljs-comment">// ğŸ‘‡ åœ¨é­”æ³•æ³¨é‡Šä¸­è®¾ç½®prefetchä¸ºtrue</span><br>        <span class="hljs-keyword">import</span>(<span class="hljs-comment">/* webpackChunkName: &#x27;lazy&#x27;, webpackPrefetch: true */</span><span class="hljs-string">&#x27;./lazy.js&#x27;</span>)<br>            .then( <span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> &#123;<span class="hljs-built_in">this</span>.innerHTML = m.default.text&#125; );<br>        <span class="hljs-built_in">this</span>.lazyLoaded = <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ­¤æ—¶ï¼Œæµè§ˆå™¨ç©ºé—²æ—¶å·²ç»æŠŠlazy.jsè¯·æ±‚åˆ°äº†ï¼Œå½“buttonç¬¬ä¸€æ¬¡è§¦å‘ç‚¹å‡»äº‹ä»¶æ—¶ï¼Œlazy.jsä¼šä»ç¼“å­˜è·å–ã€‚</p>
<h1 id="å…¶ä»–å¸¸è§æ“ä½œä¸ç›¸å…³æ’ä»¶"><a href="#å…¶ä»–å¸¸è§æ“ä½œä¸ç›¸å…³æ’ä»¶" class="headerlink" title="å…¶ä»–å¸¸è§æ“ä½œä¸ç›¸å…³æ’ä»¶"></a>å…¶ä»–å¸¸è§æ“ä½œä¸ç›¸å…³æ’ä»¶</h1><h2 id="æ„å»ºå‰è‡ªåŠ¨æ¸…ç©ºæ‰“åŒ…ç›®å½•-â­"><a href="#æ„å»ºå‰è‡ªåŠ¨æ¸…ç©ºæ‰“åŒ…ç›®å½•-â­" class="headerlink" title="æ„å»ºå‰è‡ªåŠ¨æ¸…ç©ºæ‰“åŒ…ç›®å½• â­"></a>æ„å»ºå‰è‡ªåŠ¨æ¸…ç©ºæ‰“åŒ…ç›®å½• â­</h2><p><strong>ä½¿ç”¨çš„æ’ä»¶ï¼š</strong><code>clean-webpack-plugin</code> <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/clean-webpack-plugin">å‚è€ƒé“¾æ¥https://www.npmjs.com/package/clean-webpack-plugin</a></p>
<p>è¯¥æ’ä»¶ä¼šå¸®åŠ©æˆ‘ä»¬åœ¨é‡æ–°æ‰“åŒ…é¡¹ç›®æ—¶ï¼Œæ¸…ç©º<code>output.path</code>ä¸­è®¾å®šçš„è¾“å‡ºç›®å½•çš„å†…å®¹ã€‚</p>
<p><strong>å®‰è£…æ’ä»¶</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">npm <span class="hljs-keyword">install</span> clean-webpack-<span class="hljs-keyword">plugin</span> -D<br></code></pre></td></tr></table></figure>
<p><strong>ä½¿ç”¨æ’ä»¶</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-comment">// </span><br><span class="hljs-keyword">const</span> &#123; resolve &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><span class="hljs-keyword">const</span> &#123; CleanWebpackPlugin &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;clean-webpack-plugin&#x27;</span>); â—â— <span class="hljs-comment">// éœ€è¦è§£æ„ï¼</span><br><br><span class="hljs-comment">// â­ è¯¥æ’ä»¶çš„optionså¯¹è±¡</span><br><span class="hljs-keyword">const</span> CleanPluginOptions = &#123;<br>  <br>  <span class="hljs-comment">// ä¸‹é¢è¿™ä¸ªé€‰é¡¹ç”¨äºé…ç½®åˆ é™¤å“ªäº›æ–‡ä»¶ï¼Œ **ä»£è¡¨ä»»æ„çº§ç›®å½•</span><br>  <span class="hljs-comment">// å¦‚ï¼š&#x27;**/foo&#x27; å¯ä»¥åŒ¹é… /bar/fooã€/fooç­‰ã€‚</span><br>  cleanOnceBeforeBuildPatterns: [<span class="hljs-string">&#x27;**/*&#x27;</span>],<br>  <br>  <span class="hljs-comment">// â— å¦‚æœå¸Œæœ›æ’é™¤æŸäº›ç›®å½•ï¼Œåˆ™è¦ç”¨`!`æ„Ÿå¹å·æ’é™¤ã€‚</span><br>  dry: <span class="hljs-literal">true</span>, <span class="hljs-comment">//ğŸ‘ˆ å¿…é¡»è®¾ç½®è¯¥å­—æ®µä¸ºtrueï¼Œæ„Ÿå¹å·æ‰èµ·ä½œç”¨</span><br>  cleanOnceBeforeBuildPatterns: [<span class="hljs-string">&#x27;**/*&#x27;</span>, <span class="hljs-string">&#x27;!dll/*&#x27;</span>],<br>&#125;<br><br><span class="hljs-built_in">module</span>.exports =  &#123;<br>  entry: <span class="hljs-string">&#x27;./src/main.js&#x27;</span>,<br>  output: &#123;<br>    filename: <span class="hljs-string">&#x27;js/[name].[hash:10].js&#x27;</span>,<br>    path: resolve(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>), <span class="hljs-comment">// ğŸ‘ˆ é»˜è®¤ä¼šæƒ…å†µè¯¥ç›®å½•ä¸‹çš„å†…å®¹</span><br>  &#125;,<br>  plugins: [<br>    <span class="hljs-keyword">new</span> CleanWebpackPlugin(CleanPluginOptions), <span class="hljs-comment">// ğŸ‘ˆ ä½¿ç”¨æ’ä»¶å³å¯</span><br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>


<h2 id="å¤šè¿›ç¨‹æ‰“åŒ…"><a href="#å¤šè¿›ç¨‹æ‰“åŒ…" class="headerlink" title="å¤šè¿›ç¨‹æ‰“åŒ…"></a>å¤šè¿›ç¨‹æ‰“åŒ…</h2><p><strong>ä½¿ç”¨loaderï¼š</strong><code>thread-loader</code></p>
<p>ä½¿ç”¨æ–¹æ³•ï¼šmodule.rulesä¸­è§„å®šäº†å„ç§ç±»å‹æ–‡ä»¶ä½¿ç”¨çš„è½¬æ¢loaderï¼Œå½“éœ€è¦ä½¿ç”¨å¤šè¿›ç¨‹åŠ å¿«æ‰“åŒ…é€Ÿåº¦æ—¶ï¼Œåªéœ€è¦åœ¨æŸä¸ªç±»å‹çš„æ–‡ä»¶å¤„ç†æµç¨‹çš„æœ€åä½¿ç”¨ä¸€ä¸‹<code>thread-loader</code>ã€‚</p>
<p>ä¾‹å¦‚å¤šè¿›ç¨‹æ‰“åŒ…jsæ–‡ä»¶ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-comment">//...</span><br>    <span class="hljs-built_in">module</span>: &#123;<br>        rules: [<br>            &#123;<br>                test: <span class="hljs-regexp">/\.js$/</span>,<br>                exclude: <span class="hljs-regexp">/node_modules/</span>,<br>                use: [<br>                    <span class="hljs-string">&#x27;thread-loader&#x27;</span>,<br>                    <span class="hljs-string">&#x27;babel-loader&#x27;</span><br>                ]<br>            &#125;<br>        ]<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// ğŸ‘‡ è¿›ä¸€æ­¥é…ç½®æ‰“åŒ…çš„è¿›ç¨‹æ•°</span><br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-comment">//...</span><br>    <span class="hljs-built_in">module</span>: &#123;<br>        rules: [<br>            &#123;<br>                test: <span class="hljs-regexp">/\.js$/</span>,<br>                use: [<br>                    &#123;<br>                        loader: <span class="hljs-string">&#x27;thread-loader&#x27;</span>,<br>                        options: &#123;<br>                            workers: <span class="hljs-number">2</span> <span class="hljs-comment">// ğŸ‘ˆä½¿ç”¨ä¸¤ä¸ªæ ¸å¿ƒ</span><br>                        &#125;<br>                    &#125;<br>                ]<br>            &#125;<br>        ]<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p><strong>ä½¿ç”¨thread-loaderçš„ä¼˜ç‚¹æ˜¯æå‡æ‰“åŒ…é€Ÿåº¦ï¼Œç¼ºç‚¹æ˜¯æ¯ä¸ªè¿›ç¨‹çš„å¼€å¯å’Œäº¤æµéƒ½ä¼šæœ‰å¼€é”€</strong>ï¼ˆbabel-loaderæ¶ˆè€—æ—¶é—´æœ€ä¹…ï¼Œæ‰€ä»¥ä½¿ç”¨thread-loaderé’ˆå¯¹å…¶è¿›è¡Œä¼˜åŒ–ï¼‰ã€‚</p>
</blockquote>
<h2 id="å‘HTMLæ¨¡æ¿ä¸­æ·»åŠ æœ¬åœ°èµ„æºé“¾æ¥"><a href="#å‘HTMLæ¨¡æ¿ä¸­æ·»åŠ æœ¬åœ°èµ„æºé“¾æ¥" class="headerlink" title="å‘HTMLæ¨¡æ¿ä¸­æ·»åŠ æœ¬åœ°èµ„æºé“¾æ¥"></a>å‘HTMLæ¨¡æ¿ä¸­æ·»åŠ æœ¬åœ°èµ„æºé“¾æ¥</h2><p><strong>ä½¿ç”¨æ’ä»¶ï¼š</strong><code>add-asset-html-webpack-plugin</code></p>
<p>è¯¥æ’ä»¶èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å°†æºç åŒºåŸŸçš„æŸäº›JSæˆ–CSSèµ„æºå¤åˆ¶åˆ°æ‰“åŒ…è¾“å‡ºç›®å½•ï¼Œå¹¶åœ¨æŒ‡å®šçš„HTMLæ¨¡æ¿æ’å…¥è¿™äº›èµ„æºçš„å¼•ç”¨æ ‡ç­¾ã€‚ï¼ˆ<strong>å¤åˆ¶èµ„æºã€æ’å…¥å¼•ç”¨æ ‡ç­¾</strong>ï¼‰</p>
<p><strong><a target="_blank" rel="noopener" href="https://github.com/SimenB/add-asset-html-webpack-plugin">å¯é…ç½®é¡¹</a></strong></p>
<ul>
<li><p><strong>filepath</strong>ï¼šæŒ‡ç¤ºéœ€è¦å°†å“ªäº›JS/CSSä»¥æ ‡ç­¾çš„å½¢å¼æ·»åŠ åˆ°HTMLä¸­ã€‚</p>
<p>Type: <code>string|Glob</code>, mandatory</p>
<p>The absolute path of the file you want to add to the compilation, and resulting HTML file. Also support globby string.</p>
</li>
<li><p><strong>files</strong>ï¼šä¸ºå“ªäº›æ¨¡æ¿æ·»åŠ filepathä¸­åŒ…å«çš„æ‰€æœ‰æ–‡ä»¶ã€‚</p>
<p>Type: <code>string|Array&lt;string&gt;</code>, default `[]</p>
<p>Files that the assets will be added to.</p>
<p>By default the assets will be included in all files. If files are defined, the assets will only be included in specified file globs.</p>
</li>
<li><p><strong>hash</strong>ï¼šæ˜¯å¦ä¸ºèµ„æºæ–‡ä»¶ååæ·»åŠ hashå€¼ã€‚</p>
<p>Type: <code>boolean</code>, default: <code>false</code></p>
<p>If <code>true</code>, will append a unique hash of the file to the filename. This is useful for cache busting.</p>
</li>
<li><p><strong>includeRelatedFiles</strong>ï¼šä¸€èˆ¬ä¸ç”¨ï¼Œç›´æ¥åœ¨filepathä¸­ä½¿ç”¨globè¯­æ³•å³å¯ã€‚</p>
<p>Type: <code>boolean</code>, default: <code>true</code></p>
<p>If <code>true</code>, will add <code>filepath + &#39;.*&#39;</code> to the compilation as well. E.g <code>filepath.map</code> and <code>filepath.gz</code>.</p>
</li>
<li><p><strong>outputPath</strong>ï¼šèµ„æºå¤åˆ¶åˆ°å“ªä¸ªç›®å½•ä¸‹ï¼Œé»˜è®¤ä¸ºoutput.pathã€‚</p>
<p>Type: <code>string</code></p>
<p>If set, will be used as the output directory of the file.</p>
</li>
<li><p><strong>publicPath</strong>ï¼šæ ‡ç­¾çš„å…¬å…±è·¯å¾„ã€‚</p>
<p>Type: <code>string</code></p>
<p>If set, will be used as the public path of the script or link tag.</p>
</li>
<li><p><strong>typeOfAsset</strong>ï¼šå¯ä»¥æŒ‡ç¤ºæ˜¯ä¸ºèµ„æºæ·»åŠ CSSè¿˜æ˜¯JSæ ‡ç­¾ã€‚</p>
<p>Type: <code>string</code>, default: <code>js</code></p>
<p>Can be set to <code>css</code> to create a <code>link</code>-tag instead of a <code>script</code>-tag.</p>
</li>
<li><p><strong>attributes</strong>ï¼šå¯ä»¥ç”¨äºä¸ºæ ‡ç­¾æ·»åŠ é¢å¤–å±æ€§ã€‚</p>
<p>Type: <code>object</code>, default: <code>&#123;&#125;</code></p>
<p>Extra attributes to be added to the generated tag. Useful to for instance add <code>nomodule</code> to a polyfill script. The <code>attributes</code> object uses the key as the name of the attribute, and the value as the value of it. If value is simply <code>true</code> no value will be added.</p>
<p>An example of this is included in the repository.</p>
<p>Currently only supports script tags.</p>
</li>
</ul>
<p><strong>æ·»åŠ JSèµ„æº</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> AddAssetHTMLWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;add-asset-html-webpack-plugin&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-comment">//...</span><br>    plugins: [<br>        <span class="hljs-keyword">new</span> AddAssetHTMLWebpackPlugin(&#123;<br>            filepath: <span class="hljs-string">&quot;./dll/*.dll.js&quot;</span>, <span class="hljs-comment">// ğŸ‘ˆ ä½¿ç”¨globè¯­æ³•ï¼Œæ·»åŠ å¼€å‘ç›®å½•ä¸‹çš„dllè„šæœ¬ã€‚</span><br>            files: [<span class="hljs-string">&#x27;index.html&#x27;</span>], <span class="hljs-comment">// ğŸ‘ˆ åªä¸ºdistç›®å½•ä¸­çš„è¯¥æ¨¡æ¿æ·»åŠ èµ„æº</span><br>            <span class="hljs-comment">// typeOfAsseté»˜è®¤ä¸º&#x27;js&#x27;</span><br>        &#125;),<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure>


<p><strong>æ·»åŠ CSSèµ„æº</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> AddAssetHTMLWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;add-asset-html-webpack-plugin&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-comment">//...</span><br>    plugins: [<br>        <span class="hljs-keyword">new</span> AddAssetHTMLWebpackPlugin(&#123;<br>            typeOfAsset: <span class="hljs-string">&#x27;css&#x27;</span>, <span class="hljs-comment">// ğŸ‘ˆ ä¸€å®šè¦æŒ‡æ˜css</span><br>            filepath: <span class="hljs-string">&quot;src/static/**/*.css&quot;</span>, <br>            files: [<span class="hljs-string">&#x27;index.html&#x27;</span>], <br>        &#125;),<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure>


<p><strong>åŒæ—¶æ·»åŠ JSå’ŒCSSèµ„æº</strong></p>
<p>éœ€è¦ä½¿ç”¨ä¸¤æ¬¡æ’ä»¶ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> AddAssetHTMLWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;add-asset-html-webpack-plugin&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-comment">//...</span><br>    plugins: [<br>        <span class="hljs-keyword">new</span> AddAssetHTMLWebpackPlugin(&#123;<br>            filepath: <span class="hljs-string">&quot;./dll/*.dll.js&quot;</span>,<br>            files: [<span class="hljs-string">&#x27;index.html&#x27;</span>],<br>        &#125;),<br>		<span class="hljs-keyword">new</span> AddAssetHTMLWebpackPlugin(&#123;<br>            typeOfAsset: <span class="hljs-string">&#x27;css&#x27;</span>,<br>            publicPath: <span class="hljs-string">&#x27;/static/&#x27;</span>, <span class="hljs-comment">// â­ publicPathéœ€è¦å’ŒoutputPathé…åˆä½¿ç”¨ï¼Œ</span><br>            outputPath: <span class="hljs-string">&#x27;static&#x27;</span>,  <span class="hljs-comment">// outputPathç›¸å¯¹äºdist</span><br>            filepath: <span class="hljs-string">&quot;src/static/**/*.css&quot;</span>, <br>            files: [<span class="hljs-string">&#x27;index.html&#x27;</span>], <br>        &#125;),        <br>    ]<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>â— <strong>æ³¨æ„ï¼š</strong></p>
<p><strong>add-asset-html-webpack-pluginä¼šå°†CSSçš„linkæ ‡ç­¾æ’å…¥åˆ°headä¸­ï¼Œè€ŒJSæ ‡ç­¾çš„æ’å…¥ä½ç½®ä¸html-webpack-pluginçš„é…ç½®æœ‰å…³ã€‚</strong></p>
</blockquote>
<h2 id="å¤§å‹æ¡†æ¶æ‰“åŒ…æˆDll-js"><a href="#å¤§å‹æ¡†æ¶æ‰“åŒ…æˆDll-js" class="headerlink" title="å¤§å‹æ¡†æ¶æ‰“åŒ…æˆDll.js"></a>å¤§å‹æ¡†æ¶æ‰“åŒ…æˆDll.js</h2><p><strong>ä½¿ç”¨æ’ä»¶ï¼š</strong><code>webpack/lib/DllPlugin</code>   ğŸ‘‰ ç”ŸæˆDll.jså’Œæ¥å£æ–‡ä»¶manifest.json</p>
<p><strong>ä½¿ç”¨æ’ä»¶ï¼š</strong><code>webpack/lib/DllReferencePlugin</code> ğŸ‘‰ å¼•ç”¨Dllå†…å®¹</p>
<p><strong>æ³¨æ„ï¼š</strong></p>
<p>æ­¤ç§åšæ³•è¿˜éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å°†ç”Ÿæˆåçš„dllæ–‡ä»¶ä»¥scriptæ ‡ç­¾çš„æ–¹å¼æ’å…¥åˆ°æ¨¡æ¿ä¸­ï¼Œæ‰€ä»¥è¿˜ä¸æ˜¯å¾ˆå®Œå–„ã€‚</p>
<p><font color="red">å¼€å‘ç¯å¢ƒä¸‹ä¸ºäº†æé«˜æ‰“åŒ…é€Ÿåº¦ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšã€‚</font></p>
<p><strong>å‰è¨€ï¼š</strong></p>
<p>åƒ<code>react</code>è¿™ç§å¤§å‹æ¡†æ¶ï¼Œåœ¨åå¤æ‰“åŒ…æ—¶ä¼šå¤šæ¬¡åˆ†æä¾èµ–ï¼Œä¼šæ¶ˆè€—å¤§é‡ç¼–è¯‘æ—¶é—´ã€‚</p>
<p>å¯¹äºæ­¤ç±»åŒ…æˆ–ä¾èµ–ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°†å…¶æ‰“åŒ…æˆDllï¼Œé€šè¿‡æ¥å£è®¿é—®å…¶å†…å®¹ã€‚</p>
<p>ç”±äº<code>react</code>è¦è½¬ä¹‰<code>jsx</code>ï¼Œæ‰€ä»¥æ–¹ä¾¿èµ·è§ï¼Œä¸‹é¢ä»¥å°†<code>Vue</code>æ‰“åŒ…æˆ<code>Dll</code>ä¸ºä¾‹ï¼š</p>
<p><strong>æ€»ä½“æµç¨‹ï¼š</strong></p>
<p>é¦–å…ˆå»ºç«‹å•ç‹¬çš„webpacké…ç½®ï¼Œç”¨äºå°†æŸä¸ªå¤§å‹ç¬¬ä¸‰æ–¹åŒ…æ‰“åŒ…æˆdllã€‚</p>
<p>ç„¶ååœ¨æ„å»ºé¡¹ç›®çš„webpacké…ç½®ä¸­å¼•ç”¨è¯¥dllã€‚</p>
<p><strong>1. æ–°å»ºç”¨äºæ‰“åŒ…dllçš„webpack.config.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># æ–°å»º webpack.dll.js<br><br><span class="hljs-keyword">const</span> &#123; resolve &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><span class="hljs-keyword">const</span> DllPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack/lib/DllPlugin&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  entry: &#123;<br>    vue: [<span class="hljs-string">&#x27;vue&#x27;</span>]<br>  &#125;,<br>  output: &#123;<br>    filename: <span class="hljs-string">&#x27;[name].dll.js&#x27;</span>,<br>    path: resolve(__dirname, <span class="hljs-string">&#x27;Dll&#x27;</span>),<br>    library: <span class="hljs-string">&#x27;__dll__[name]&#x27;</span>,<br>  &#125;,<br>  plugins: [<br>    <span class="hljs-keyword">new</span> DllPlugin(&#123;<br>      name: <span class="hljs-string">&#x27;__dll__[name]&#x27;</span>,<br>      path: resolve(__dirname, <span class="hljs-string">&#x27;dll&#x27;</span>, <span class="hljs-string">&#x27;[name].manifest.json&#x27;</span>)<br>    &#125;)<br>  ],<br>&#125;<br><br><span class="hljs-comment">// ==========================</span><br># package.json<br><br>&#123;<br>  scripts: &#123;<br>    <span class="hljs-string">&quot;dll&quot;</span>: <span class="hljs-string">&quot;webpack --config ./webpack.dll.js&quot;</span> , <span class="hljs-comment">// ğŸ‘ˆ é…ç½®ä¸€æ¡æ„å»ºvue dllçš„è„šæœ¬</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<p><strong>2. å°†vueæ‰“åŒ…æˆDll</strong></p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">npm <span class="hljs-keyword">run</span><span class="bash"> dll</span><br></code></pre></td></tr></table></figure>
<p>æ­¤æ—¶dist/dllç›®å½•ä¸‹ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼š</p>
<p> <img src="/webpack4.assets/image-20210329232433059.png" srcset="/img/loading.gif" alt="image-20210329232433059"></p>
<p><strong>3. åœ¨æ„å»ºé¡¹ç›®çš„webpacké…ç½®ä¸­è¯»å–Dllæ¥å£ï¼Œå¹¶å‘æ¨¡æ¿ä¸­æ·»åŠ å¯¹vue.dll.jsçš„å¼•ç”¨</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.dev.js<br><span class="hljs-keyword">const</span> &#123; merge &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack-merge&#x27;</span>);<br><span class="hljs-keyword">const</span> CleanWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;clean-webpack-plugin&#x27;</span>);<br><span class="hljs-keyword">const</span> &#123; resolve &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><span class="hljs-keyword">const</span> baseConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./webpack.config.base&#x27;</span>);<br><br><br>â­ <span class="hljs-keyword">const</span> DllReferencePlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack/lib/DllReferencePlugin&#x27;</span>);<br>â­ <span class="hljs-keyword">const</span> AddAssetHTMLWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;add-asset-html-webpack-plugin&#x27;</span>);<br><br>process.env.BROWSERSLIST_ENV = <span class="hljs-string">&#x27;development&#x27;</span>;<br><br><span class="hljs-keyword">const</span> devConfig = &#123;<br>  mode: <span class="hljs-string">&#x27;development&#x27;</span>,<br>  devServer: &#123;<br>    contentBase: resolve(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>),<br>  &#125;,<br>  devtool: <span class="hljs-string">&#x27;source-map&#x27;</span>,<br>  plugins: [<br>    <span class="hljs-comment">// ğŸ‘‡ é…ç½®å¼•ç”¨DLLæ’ä»¶,è¯¥æ’ä»¶è¯»å–vue.mainfest.jsonåä¼šçŸ¥é“å“ªäº›ç¬¬ä¸‰æ–¹åŒ…æ˜¯ä¸éœ€è¦æ‰“åŒ…çš„ã€‚</span><br>    <span class="hljs-comment">// åŒæ—¶åœ¨æ‰“åŒ…æ„å»ºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœæŸäº›æ¨¡å—ä¾èµ–äº†è¿™äº›æ²¡æœ‰æ‰“åŒ…çš„ç¬¬ä¸‰æ–¹åŒ…çš„å†…å®¹æ—¶ï¼Œ</span><br>    <span class="hljs-comment">// æ’ä»¶é€šè¿‡è¯»å–mainifest.jsonï¼Œèƒ½å¤Ÿå‘Šè¯‰æ¨¡å—åˆ°å…¨å±€çš„å“ªä¸ªå±æ€§ä¸­è·å–ä¾èµ–çš„å†…å®¹ã€‚</span><br>    <span class="hljs-keyword">new</span> DllReferencePlugin(&#123;<br>      manifest: resolve(__dirname, <span class="hljs-string">&#x27;dll&#x27;</span>, <span class="hljs-string">&#x27;vue.manifest.json&#x27;</span>),<br>    &#125;),<br>    <span class="hljs-comment">// â­ å°†vue.dll.jså¤åˆ¶åˆ°distç›®å½•ï¼Œå¹¶å‘HTMLä¸­æ’å…¥vue.dll.jsçš„å¼•ç”¨æ ‡ç­¾</span><br>    <span class="hljs-keyword">new</span> AddAssetHTMLWebpackPlugin(&#123;<br>      filepath: <span class="hljs-string">&#x27;./dll/vue.dll.js&#x27;</span>,<br>      files: [<span class="hljs-string">&#x27;index.html&#x27;</span>]<br>    &#125;),<br>      <br>  ],<br>&#125;;<br><br><span class="hljs-built_in">module</span>.exports = merge(baseConfig, devConfig);<br><br></code></pre></td></tr></table></figure>


<h2 id="æ¨¡å—å…å¯¼å…¥"><a href="#æ¨¡å—å…å¯¼å…¥" class="headerlink" title="æ¨¡å—å…å¯¼å…¥"></a>æ¨¡å—å…å¯¼å…¥</h2><p><strong>ä½¿ç”¨æ’ä»¶ï¼š</strong><code>webpack.ProvidePlugin</code></p>
<p>webpacké…ç½®ProvidePluginåï¼Œåœ¨ä½¿ç”¨æ—¶å°†ä¸å†éœ€è¦importå’Œrequireè¿›è¡Œå¼•å…¥ï¼Œç›´æ¥ä½¿ç”¨å³å¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack&#x27;</span>);<br> <br><span class="hljs-built_in">module</span>.exports = &#123;<br>  plugins: [<br>    <span class="hljs-comment">//...</span><br>    <span class="hljs-keyword">new</span> webpack.ProvidePlugin(&#123;<br>      <span class="hljs-string">&#x27;$&#x27;</span>: <span class="hljs-string">&#x27;jquery&#x27;</span>,<br>      <span class="hljs-string">&#x27;Vue&#x27;</span>: <span class="hljs-string">&#x27;vue&#x27;</span><br>    &#125;),<br>   <span class="hljs-comment">// ...</span><br>	]<br>&#125;<br><br><span class="hljs-comment">//-------------------------------------</span><br># .src/index.js<br><br><span class="hljs-comment">// æ— éœ€å¯¼å…¥ï¼Œå°±å¯ä»¥ä½¿ç”¨è¯¥å˜é‡ã€‚ï¼ˆæ‰‹åŠ¨å¯¼å…¥äº†ä¹Ÿä¸å½±å“æ•ˆæœï¼‰</span><br><span class="hljs-built_in">console</span>.log($);<br><span class="hljs-built_in">console</span>.log(Vue);<br></code></pre></td></tr></table></figure>


<h2 id="åœ¨é¡µé¢ä¸­ä½¿ç”¨CDNå¼•å…¥ç¬¬ä¸‰æ–¹åŒ…"><a href="#åœ¨é¡µé¢ä¸­ä½¿ç”¨CDNå¼•å…¥ç¬¬ä¸‰æ–¹åŒ…" class="headerlink" title="åœ¨é¡µé¢ä¸­ä½¿ç”¨CDNå¼•å…¥ç¬¬ä¸‰æ–¹åŒ…"></a>åœ¨é¡µé¢ä¸­ä½¿ç”¨CDNå¼•å…¥ç¬¬ä¸‰æ–¹åŒ…</h2><h3 id="æ–¹æ³•1ï¼šä½¿ç”¨æ’ä»¶å¤„ç†"><a href="#æ–¹æ³•1ï¼šä½¿ç”¨æ’ä»¶å¤„ç†" class="headerlink" title="æ–¹æ³•1ï¼šä½¿ç”¨æ’ä»¶å¤„ç†"></a>æ–¹æ³•1ï¼šä½¿ç”¨æ’ä»¶å¤„ç†</h3><p><strong>ä½¿ç”¨çš„æ’ä»¶ï¼š</strong><code>html-webpack-externals-plugin</code></p>
<p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨æœ¬åœ°å¼€å‘æ—¶ä½¿ç”¨<code>import</code>æˆ–<code>require</code>å¯¼å…¥ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œéƒ½æ˜¯åˆ° <strong>node_modules</strong> ç›®å½•æˆ–ç¼“å­˜ä¸­å¯¼å…¥ã€‚<code>html-webpack-externals-plugin</code>ä¸ºæˆ‘ä»¬æä¾›äº†å¦å¤–ä¸€ç§å¯¼å…¥æ–¹å¼ï¼Œå³CDNå¼•å…¥ã€‚</p>
<p><font color='red'>è¯¥æ’ä»¶è‡ªåŠ¨å°†CDN scriptæ ‡ç­¾æ’å…¥åˆ°æ¨¡æ¿HTMLä¸­</font>ï¼Œç¬¬ä¸‰æ–¹å†…å®¹<code>foo</code>å°±æŒ‚è½½åˆ°äº†å…¨å±€å¯¹è±¡windowä¸‹ï¼ˆè¿™é‡Œå‡è®¾ç¬¬ä¸‰æ–¹åŒ…å°†è‡ªå·±æŒ‚è½½åˆ°<code>Foo</code>å±æ€§ä¸Šï¼‰ï¼Œåœ¨å…¶ä»–æ¨¡å—å¯¼å…¥<code>foo</code>æ—¶ï¼Œä¼šå°†<code>window.Foo</code>ä½œä¸ºå¯¼å…¥ã€‚</p>
<p><strong>ä¸‹é¢ä»¥CDNå¯¼å…¥jQueryä¸ºä¾‹ï¼š</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-keyword">const</span> &#123; resolve &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><span class="hljs-keyword">const</span> HTMLWebPackExternalsPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-externals-plugin&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  entry: <span class="hljs-string">&#x27;./src/main.js&#x27;</span>,<br>  output: &#123;<br>    filename: <span class="hljs-string">&#x27;js/[name].[hash].js&#x27;</span>,<br>    path: resolve(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>);<br>  &#125;,<br>  plugins: [<br>    <span class="hljs-comment">// ä½¿ç”¨æ’ä»¶</span><br>    <span class="hljs-keyword">new</span> HTMLWebpackExternalsPlugin(&#123;<br>      <span class="hljs-comment">// ğŸ‘‡ æ³¨æ„æ˜¯å¤æ•° externals</span><br>      externals: [ <span class="hljs-comment">// å¯ä»¥å®šä¹‰å¤šä¸ªCDNæ‰©å±•ï¼Œç”¨å¯¹è±¡æ•°ç»„çš„å½¢å¼</span><br>        &#123;<br>          <span class="hljs-built_in">module</span>: <span class="hljs-string">&#x27;jquery&#x27;</span>,<br>          entry: <span class="hljs-string">&#x27;https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js&#x27;</span> <span class="hljs-comment">// cdné“¾æ¥</span><br>          <span class="hljs-built_in">global</span>: <span class="hljs-string">&#x27;$&#x27;</span>, <span class="hljs-comment">// åˆ°å…¨å±€çš„è¯¥å±æ€§ä¸Šè·å–</span><br>        &#125;,<br>      ],<br>      <span class="hljs-comment">/* â­â­</span><br><span class="hljs-comment">      *	å¦‚æœæ˜¯å¤šé¡µé¢åº”ç”¨ï¼Œå°±ä¼šæœ‰å¤šä¸ªhtmlæ–‡ä»¶ï¼Œ`html-webpack-externals-plugin`é»˜è®¤å°†cdnæ’å…¥åˆ°æ‰€æœ‰é¡µé¢ä¸­</span><br><span class="hljs-comment">      * å¦‚æœå¼€å‘æ—¶åªéœ€è¦å°†cdnåŠ å…¥åˆ°æŸäº›htmlä¸­ã€‚åˆ™éœ€è¦æŒ‡å®š files: [...]ï¼Œæ¥æŒ‡ç¤ºéœ€è¦cdnçš„HTMLæ–‡ä»¶</span><br><span class="hljs-comment">      */</span><br>      files: [<span class="hljs-string">&#x27;index.html&#x27;</span>]  <span class="hljs-comment">// ğŸ‘ˆ filesæ•°ç»„ä¸­å¡«çš„æ˜¯æ‰“åŒ…åçš„htmlæ–‡ä»¶ç›¸å¯¹äºè¾“å‡ºç›®å½•çš„è·¯å¾„</span><br>			<span class="hljs-comment">// å¦‚æœhtmlæ‰“åŒ…åˆ°äº†dist/staticä¸­ï¼Œfiles: [&#x27;static/index.html&#x27;]</span><br>      <br>    &#125;)<br>  ]<br>&#125;<br><br><span class="hljs-comment">//====================================</span><br># .src/main.js<br><span class="hljs-keyword">import</span> $ <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;jquery&#x27;</span>; <span class="hljs-comment">// å°†ä¼šä»å…¨å±€è·å–jquery</span><br><br><span class="hljs-built_in">console</span>.log($);<br></code></pre></td></tr></table></figure>




<h3 id="æ–¹æ³•2ï¼šæ‰‹åŠ¨æ’å…¥é…åˆexternals"><a href="#æ–¹æ³•2ï¼šæ‰‹åŠ¨æ’å…¥é…åˆexternals" class="headerlink" title="æ–¹æ³•2ï¼šæ‰‹åŠ¨æ’å…¥é…åˆexternals"></a>æ–¹æ³•2ï¼šæ‰‹åŠ¨æ’å…¥é…åˆexternals</h3><blockquote>
<p>å½“æˆ‘ä»¬åœ¨å¼€å‘æ—¶ä¹Ÿå¯ä»¥ç›´æ¥åœ¨æ¨¡æ¿HTMLä¸­æ’å…¥äº†ç¬¬ä¸‰æ–¹åŒ…çš„CDN scriptæ ‡ç­¾ï¼Œä½†æˆ‘ä»¬éœ€è¦è®©webpackåœ¨æ‰“åŒ…æ—¶å‘Šè¯‰JSæ¨¡å—åˆ°å…¨å±€å»è·å–ã€‚</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- .src/index.html --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--åœ¨æ¨¡æ¿ä¸­ç›´æ¥cdnå¼•å…¥--&gt;</span><br>  	<span class="hljs-tag">&lt;<span class="hljs-name">scripts</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">scripts</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  externals: &#123;<br>    jquery: <span class="hljs-string">&#x27;$&#x27;</span>, <span class="hljs-comment">// æŒ‡ç¤ºå¼•å…¥jqueryæ—¶ï¼Œè®¿é—®å…¨å±€å¯¹è±¡çš„$å±æ€§</span><br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure>






<h2 id="å°†èµ„æºç›®å½•æ‹·è´åˆ°æ‰“åŒ…ç›®å½•"><a href="#å°†èµ„æºç›®å½•æ‹·è´åˆ°æ‰“åŒ…ç›®å½•" class="headerlink" title="å°†èµ„æºç›®å½•æ‹·è´åˆ°æ‰“åŒ…ç›®å½•"></a>å°†èµ„æºç›®å½•æ‹·è´åˆ°æ‰“åŒ…ç›®å½•</h2><p><strong>ä½¿ç”¨çš„æ’ä»¶ï¼š</strong><code>copy-webpack-plugin</code></p>
<p>åœ¨ä¸€å®šåœºåˆä¸‹éœ€è¦ä½¿ç”¨è¯¥åŠŸèƒ½ï¼Œæ¯”å¦‚å°†å¼€å‘ç›®å½•ä¸‹çš„mockæ•°æ®æ‹·è´åˆ°æ‰“åŒ…åçš„è¾“å‡ºç›®å½•ä¸­ã€‚</p>
<p>ç°åœ¨å‡è®¾å°†<code>.src/mock</code>æ‹·è´åˆ°<code>.dist/mock</code></p>
<p><strong>å®‰è£…æ’ä»¶</strong></p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">npm install <span class="hljs-keyword">copy</span><span class="bash">-webpack-plugin -D</span><br></code></pre></td></tr></table></figure>
<p><strong>ä½¿ç”¨æ’ä»¶</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-keyword">const</span> &#123; resolve &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><span class="hljs-keyword">const</span> CopyWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;copy-webpack-plugin&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  plugins: [<br>    <span class="hljs-comment">// è¯¥æ’ä»¶çš„é…ç½®æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­çš„å…ƒç´ è¦æ±‚å«æœ‰fromå’Œtoä¸¤ä¸ªå±æ€§ï¼Œåˆ†åˆ«ä»£è¡¨æºè·¯å¾„å’Œç›®æ ‡è·¯å¾„</span><br>    <span class="hljs-keyword">new</span> CopyWebpackPlugin([<br>      &#123;<br>        <span class="hljs-keyword">from</span>: resolve(__dirname, <span class="hljs-string">&#x27;src/mock&#x27;</span>), <span class="hljs-comment">// éœ€è¦ä½¿ç”¨ç»å¯¹è·¯å¾„</span><br>        to: resolve(__dirname, <span class="hljs-string">&#x27;dist/mock&#x27;</span>),<br>      &#125;,<br>    ]),<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>


<h2 id="æ¨¡æ‹Ÿå°†æ‰“åŒ…ç»“æœéƒ¨ç½²åˆ°ExpressæœåŠ¡å™¨"><a href="#æ¨¡æ‹Ÿå°†æ‰“åŒ…ç»“æœéƒ¨ç½²åˆ°ExpressæœåŠ¡å™¨" class="headerlink" title="æ¨¡æ‹Ÿå°†æ‰“åŒ…ç»“æœéƒ¨ç½²åˆ°ExpressæœåŠ¡å™¨"></a>æ¨¡æ‹Ÿå°†æ‰“åŒ…ç»“æœéƒ¨ç½²åˆ°ExpressæœåŠ¡å™¨</h2><p><strong>ä½¿ç”¨Expressä¸­é—´ä»¶</strong>ï¼š<code>webpack-dev-middleware</code></p>
<p><strong>1. å®‰è£…expresså’Œwebpack-dev-middleware</strong></p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">npm install <span class="hljs-built_in">express</span> webpack-dev-middleware --<span class="hljs-built_in">save</span><br></code></pre></td></tr></table></figure>
<p><strong>2. åœ¨å‰ç«¯é¡¹ç›®é¡µé¢ä¸‹æ–°å»ºserver.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># ./server.js<br><br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);<br><span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack&#x27;</span>);<br><span class="hljs-keyword">const</span> webpackDevMiddleware = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack-dev-middleware&#x27;</span>);<br><br><span class="hljs-keyword">const</span> webpackConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./webpack.config&#x27;</span>); <span class="hljs-comment">// å¼•å…¥webpacké…ç½®</span><br><br><span class="hljs-keyword">const</span> compiler = webpack(webpackConfig); <span class="hljs-comment">// æ‰§è¡Œwebpackå‡½æ•°ï¼Œç”Ÿæˆç¼–è¯‘å¯¹è±¡</span><br><br><span class="hljs-keyword">const</span> app = express(); <span class="hljs-comment">// æ–°å»ºExpressæœåŠ¡å™¨</span><br><br>app.use(webpackDevMiddleware(compiler, &#123;&#125;)); <span class="hljs-comment">// æ‰§è¡Œä¸­é—´ä»¶ï¼Œå°†ç¼–è¯‘å¯¹è±¡ä¼ å…¥</span><br><span class="hljs-comment">/* è¯¥ä¸­é—´ä»¶ä¼šåšä¸¤ä»¶äº‹ï¼š</span><br><span class="hljs-comment">* 1. è°ƒç”¨compiler.run()ï¼Œæ‰§è¡Œç¼–è¯‘ã€‚</span><br><span class="hljs-comment">* 2. ä½¿ç”¨ä¸€ä¸ªä¸­é—´ä»¶ï¼Œå“åº”å®¢æˆ·ç«¯å¯¹æ‰“åŒ…åçš„æ–‡ä»¶çš„è¯·æ±‚ã€‚</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-comment">// ä»¥ä¸‹å¼€å§‹expressé¡¹ç›®çš„æ­£å¸¸é€»è¾‘ï¼Œè¿™é‡Œæ¨¡æ‹Ÿä¸€ä¸ª&#x27;/api/mock&#x27; è·¯ç”±ã€‚</span><br>app.get(<span class="hljs-string">&#x27;/api/mock&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> res.json(&#123; <span class="hljs-attr">data</span>: <span class="hljs-string">&#x27;hello world&#x27;</span>, <span class="hljs-attr">msg</span>: <span class="hljs-string">&#x27;ok&#x27;</span> &#125;));<br><br>app.listen(<span class="hljs-number">3000</span>); <span class="hljs-comment">// ç›‘å¬3000ç«¯å£</span><br><br><span class="hljs-comment">// è¾“å…¥å‘½ä»¤ï¼šnode ./server.js å¯åŠ¨æœåŠ¡å™¨</span><br><br></code></pre></td></tr></table></figure>


<h2 id="å®šä¹‰å…¨å±€å˜é‡"><a href="#å®šä¹‰å…¨å±€å˜é‡" class="headerlink" title="å®šä¹‰å…¨å±€å˜é‡"></a>å®šä¹‰å…¨å±€å˜é‡</h2><p><strong>ä½¿ç”¨æ’ä»¶ï¼š</strong><code>webpack.DefinePlugin</code></p>
<p><a target="_blank" rel="noopener" href="https://webpack.js.org/plugins/define-plugin/">å‚è€ƒé“¾æ¥ï¼šhttps://webpack.js.org/plugins/define-plugin/</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">new</span> webpack.DefinePlugin(&#123;<br>  <span class="hljs-string">&#x27;process.env.NODE_ENV&#x27;</span>: <span class="hljs-built_in">JSON</span>.stringify(process.env.NODE_ENV),<br>  <span class="hljs-string">&#x27;SERVICE_URL&#x27;</span>: <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-string">&#x27;https://dev.example.com&#x27;</span>)<br>&#125;);<br></code></pre></td></tr></table></figure>


<h2 id="æ·»åŠ ç‰ˆæƒå£°æ˜"><a href="#æ·»åŠ ç‰ˆæƒå£°æ˜" class="headerlink" title="æ·»åŠ ç‰ˆæƒå£°æ˜"></a>æ·»åŠ ç‰ˆæƒå£°æ˜</h2><p><strong>ä½¿ç”¨æ’ä»¶ï¼š</strong><code>webpack.BannerPlugin</code></p>
<p><a target="_blank" rel="noopener" href="https://webpack.js.org/plugins/banner-plugin/">å‚è€ƒé“¾æ¥ï¼šhttps://webpack.js.org/plugins/banner-plugin/</a></p>
<h2 id="æ‹†åˆ†é…ç½®-â­"><a href="#æ‹†åˆ†é…ç½®-â­" class="headerlink" title="æ‹†åˆ†é…ç½® â­"></a>æ‹†åˆ†é…ç½® â­</h2><p><strong>å®‰è£…<code>webpack-merge</code>ï¼Œå°†<code>webpack.config.js</code>æ‹†åˆ†æˆï¼š</strong></p>
<ol>
<li><code>webpack.config.base.js</code></li>
<li><code>webpack.config.dev.js</code></li>
<li><code>webpack.config.prod.js</code></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.dev.js<br><span class="hljs-comment">// â­ éœ€è¦ä½¿ç”¨webpack-mergeçš„mergeæ–¹æ³•å»åˆå¹¶é…ç½®</span><br><span class="hljs-keyword">const</span> &#123; merge &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack-merge&#x27;</span>); <br><span class="hljs-keyword">const</span> &#123; resolve &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><br><span class="hljs-comment">// ğŸ‘‡å¯¼å…¥åŸºæœ¬é…ç½®å¯¹è±¡</span><br><span class="hljs-keyword">const</span> baseConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./webpack.config.base&#x27;</span>);<br><br>process.env.BROWSERSLIST_ENV = <span class="hljs-string">&#x27;development&#x27;</span>;<br><br><span class="hljs-keyword">const</span> devConfig = &#123;<br>  mode: <span class="hljs-string">&#x27;development&#x27;</span>,<br>  devServer: &#123;<br>    contentBase: resolve(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>),<br>  &#125;,<br>  devtool: <span class="hljs-string">&#x27;source-map&#x27;</span>,<br>&#125;;<br><br><span class="hljs-built_in">module</span>.exports = merge(baseConfig, devConfig);<br><br><span class="hljs-comment">//-----------------------------------------------------------</span><br># webpack.config.prod.js<br><span class="hljs-keyword">const</span> &#123; merge &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack-merge&#x27;</span>);<br><span class="hljs-keyword">const</span> OptimizeCssAssetsWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;optimize-css-assets-webpack-plugin&#x27;</span>);<br><span class="hljs-keyword">const</span> baseConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./webpack.config.base&#x27;</span>);<br><br>process.env.BROWSERSLIST_ENV = <span class="hljs-string">&#x27;production&#x27;</span>;<br><br><span class="hljs-keyword">const</span> prodConfig = &#123;<br>  mode: <span class="hljs-string">&#x27;production&#x27;</span>,<br>  devtool: <span class="hljs-string">&#x27;nosources-source-map&#x27;</span>,<br>  plugins: [<br>    <span class="hljs-keyword">new</span> OptimizeCssAssetsWebpackPlugin(),<br>  ],<br>&#125;;<br><br><span class="hljs-built_in">module</span>.exports = merge(baseConfig, prodConfig);<br><br><span class="hljs-comment">//------------------------------------------------------------</span><br># webpack.config.base.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">/*</span><br><span class="hljs-comment">  *    åŸºæœ¬é…ç½®å†…å®¹</span><br><span class="hljs-comment">  */</span><br>&#125;<br><br><span class="hljs-comment">//------------------------------------------------------------</span><br># package.json<br><span class="hljs-comment">// â­â­ é…ç½®è„šæœ¬</span><br>&#123;<br>  <span class="hljs-string">&quot;scripts&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;start&quot;</span>: <span class="hljs-string">&quot;webpack server --config ./webpack.config.dev.js&quot;</span>,<br>    <span class="hljs-string">&quot;build:dev&quot;</span>: <span class="hljs-string">&quot;webpack --config ./webpack.config.dev.js&quot;</span>,<br>    <span class="hljs-string">&quot;build:prod&quot;</span>: <span class="hljs-string">&quot;webpack --config ./webpack.config.prod.js&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h2 id="MPA-å¤šé¡µé¢æ‰“åŒ…"><a href="#MPA-å¤šé¡µé¢æ‰“åŒ…" class="headerlink" title="MPA å¤šé¡µé¢æ‰“åŒ…"></a>MPA å¤šé¡µé¢æ‰“åŒ…</h2><p>åœ¨æ¨¡å—çš„åˆçº§æ‰“åŒ…ä¸­æåˆ°è¿‡â€œå¤šå…¥å£â€å¦‚ä½•é…ç½®ã€‚å½“ä¸€ä¸ªé¡¹ç›®ä¸å†æ˜¯SPAï¼Œè€Œæ˜¯å¤šé¡µé¢åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬å°±è¦æ‰“åŒ…å¤šä¸ªHTMLå’Œæ¯ä¸ªé¡µé¢å¯¹åº”çš„å…¥å£JSã€‚</p>
<h3 id="å¤šæ¬¡ä½¿ç”¨æ’ä»¶"><a href="#å¤šæ¬¡ä½¿ç”¨æ’ä»¶" class="headerlink" title="å¤šæ¬¡ä½¿ç”¨æ’ä»¶"></a>å¤šæ¬¡ä½¿ç”¨æ’ä»¶</h3><p><strong>ä½¿ç”¨æ’ä»¶ï¼š</strong><code>html-webpack-plugin</code></p>
<p>æˆ‘ä»¬ä¾ç„¶æ˜¯ä½¿ç”¨è¯¥æ’ä»¶æ‰“åŒ…htmlå’Œå…¥å£æ–‡ä»¶ï¼Œå¤šé¡µé¢æ—¶ï¼Œæ¯ä¸ªé¡µé¢éƒ½è¦<code>new</code>ä¸€ä¸ª<code>html-webpack-plugin</code>ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><span class="hljs-keyword">const</span> HTMLWebpackPlugin = reuqire(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>	entry: &#123;<br>    <span class="hljs-comment">// ğŸ‘‡ å®šä¹‰ä¸¤ä¸ªå…¥å£ï¼Œä¸€ä¸ªå«homeï¼Œä¸€ä¸ªå«app</span><br>    main: <span class="hljs-string">&#x27;./src/main.js&#x27;</span>, <br>    app: <span class="hljs-string">&#x27;./src/app.js&#x27;</span>,<br>    vendor: [<span class="hljs-string">&#x27;jquery&#x27;</span>],<br>  &#125;,<br>  plugins: [<br>    <span class="hljs-keyword">new</span> HTMLWebpackPlugin(&#123;<br>      <span class="hljs-comment">// ä»¥src/pagesç›®å½•ä¸‹çš„index.htmlä¸ºæ¨¡æ¿</span><br>      template: <span class="hljs-string">&#x27;./src/pages/index.html&#x27;</span>,<br>       <span class="hljs-comment">// ğŸ‘ˆ æ ‡è®°è¯¥é¡µé¢ä¾èµ–äºjqueryï¼ŒåŒæ—¶å…¥å£ä¸ºhome</span><br>      chunks: [<span class="hljs-string">&#x27;vendor&#x27;</span>,<span class="hljs-string">&#x27;main&#x27;</span>],<br>      chunksSortMode: <span class="hljs-string">&#x27;manual&#x27;</span>,<br>      filename: <span class="hljs-string">&#x27;index.js&#x27;</span>, <span class="hljs-comment">// â—â­â— ä¸€å®šè¦ä¸ºæ¯ä¸ªæ‰“åŒ…çš„é¡µé¢æ³¨æ˜æ–‡ä»¶åï¼Œå¦åˆ™ä¼šæŠ¥é”™</span><br>      <span class="hljs-comment">// chunk: [&#x27;main&#x27;]</span><br>    &#125;),<br>    <span class="hljs-keyword">new</span> HTMLWebpackPlugin(&#123;<br>      <span class="hljs-comment">// ä»¥src/pagesç›®å½•ä¸‹çš„sub.htmlä¸ºæ¨¡æ¿</span><br>      template: <span class="hljs-string">&#x27;./src/pages/sub.html&#x27;</span>,<br>      <span class="hljs-comment">// æ ‡è®°è¯¥é¡µé¢çš„å…¥å£ä¸ºapp</span><br>      chunks: [<span class="hljs-string">&#x27;app&#x27;</span>],<br>      filename: <span class="hljs-string">&#x27;sub.html&#x27;</span> <span class="hljs-comment">// â—â­â— ä¸€å®šè¦ä¸ºæ¯ä¸ªæ‰“åŒ…çš„é¡µé¢æ³¨æ˜æ–‡ä»¶åï¼Œå¦åˆ™ä¼šæŠ¥é”™</span><br>    &#125;),<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>å¤šé¡µé¢æ—¶ï¼Œå¦‚æœé…ç½®äº†html-webpack-externals-pluginï¼Œéœ€è¦æŒ‡æ˜ä¾èµ–äºcdnçš„æ‰“åŒ…åçš„htmlæ–‡ä»¶ã€‚</p>
<p>å…·ä½“æŸ¥çœ‹ html-webpack-externals-plugin çš„ fileså­—æ®µé…ç½®ã€‚</p>
</blockquote>
<h3 id="é¡µé¢å’Œå…¥å£JSçš„çº¦å®š"><a href="#é¡µé¢å’Œå…¥å£JSçš„çº¦å®š" class="headerlink" title="é¡µé¢å’Œå…¥å£JSçš„çº¦å®š"></a>é¡µé¢å’Œå…¥å£JSçš„çº¦å®š</h3><p>å½“æˆ‘ä»¬çº¦å®šä¸€ä¸ªé¡µé¢æ¨¡æ¿å’Œå…¶å…¥å£JSæ–‡ä»¶åç›¸åŒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†é¡µé¢å’Œå…¥å£JSåˆ†åˆ«æ”¾åœ¨<code>pages</code>å’Œ<code>entries</code>ç›®å½•ä¸‹ï¼Œç„¶åæŒ‰æ–‡ä»¶åè¿›è¡Œä¸€ä¸€å¯¹åº”ï¼Œå¹¶é€šè¿‡<code>html-webpack-plugin</code>ç»‘å®šèµ·æ¥ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-keyword">const</span> &#123; resolve, basename &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><span class="hljs-comment">// é€šè¿‡globè¿™ä¸ªç¬¬ä¸‰æ–¹åº“å»è¯»å–ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„jsæ–‡ä»¶</span><br><span class="hljs-keyword">const</span> glob = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;glob&#x27;</span>);<br><br><span class="hljs-comment">// æ–°å»ºä¸€ä¸ªåŒ¹é…æ¨¡å¼ï¼Œå»åŒ¹é…src/entriesç›®å½•ä¸‹çš„å…¥å£jsæ–‡ä»¶</span><br><span class="hljs-keyword">const</span> entryFilesPattern = resolve(__dirname, <span class="hljs-string">&#x27;src/entries/*.js&#x27;</span>);<br><span class="hljs-keyword">const</span> entryFilePaths = glob.sync(entryFilesPattern);<br><br><span class="hljs-comment">// ğŸ‘‡ å¤šå…¥å£å¯¹è±¡</span><br><span class="hljs-keyword">const</span> entries = &#123;&#125;;<br>entryFilePaths.forEach(<span class="hljs-function">(<span class="hljs-params">entryPath</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> entryName = basename(entryPath, <span class="hljs-string">&#x27;.js&#x27;</span>); <span class="hljs-comment">// é€šè¿‡path.basenameæ–¹æ³•è·å¾—ä¸å¸¦æ‰©å±•å.jsçš„æ–‡ä»¶å</span><br>  entries[entryName] = entryPath;<br>&#125;);<br><br><span class="hljs-comment">// é¡µé¢æ¨¡æ¿æ‰€åœ¨ç›®å½•</span><br><span class="hljs-keyword">const</span> pagesDirPath = resolve(__dirname, <span class="hljs-string">&#x27;src/pages&#x27;</span>);<br><span class="hljs-comment">// ğŸ‘‡ ç”¨æ•°ç»„ä¿å­˜å¤šé¡µé¢å¯¹åº”çš„æ’ä»¶</span><br><span class="hljs-keyword">const</span> htmlWebpackPlugins = <span class="hljs-built_in">Object</span>.keys(entries).map(<span class="hljs-function">(<span class="hljs-params">entryName</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> chunkName = entryName;<br>  <span class="hljs-keyword">const</span> options = &#123;<br>    template: resolve(pagesDirPath, <span class="hljs-string">`<span class="hljs-subst">$&#123;chunkName&#125;</span>.html`</span>),<br>    chunks: [chunkName],<br>    <span class="hljs-comment">// â­ å¿…é¡»æŒ‡æ˜æ‰“åŒ…åçš„æ–‡ä»¶åï¼ŒåŒæ—¶å¯ä»¥åŠ å…¥å­ç›®å½•è·¯å¾„ï¼Œå¦‚ `static/&#123;chunkName&#125;.html`</span><br>    filename: <span class="hljs-string">`<span class="hljs-subst">$&#123;chunkName&#125;</span>.html`</span>,<br>    <span class="hljs-comment">// ä»¥ä¸‹ä¸ºå¯é€‰</span><br>    chunksSortMode: <span class="hljs-string">&#x27;manual&#x27;</span>,<br>    inject: <span class="hljs-string">&#x27;body&#x27;</span>,<br>    hash: <span class="hljs-literal">true</span>,<br>  &#125;;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> HTMLWebpackPlugin(options);<br>&#125;);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//...</span><br>  entry: entries,<br>  plugins: [<br>    ...htmlWebpackPlugins, <span class="hljs-comment">// ğŸ‘ˆ é…ç½®å¤šé¡µé¢</span><br>    <span class="hljs-comment">//...</span><br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>


<h2 id="html-webpack-pluginæ¨¡æ¿å­—ç¬¦ä¸²-â“"><a href="#html-webpack-pluginæ¨¡æ¿å­—ç¬¦ä¸²-â“" class="headerlink" title="html-webpack-pluginæ¨¡æ¿å­—ç¬¦ä¸² â“"></a>html-webpack-pluginæ¨¡æ¿å­—ç¬¦ä¸² â“</h2><p><code>html-webpack-plugin</code>èƒ½å¤Ÿè¯†åˆ«<code>$&#123;...&#125;</code>è¿™æ ·çš„æ’å€¼è¯­æ³•ï¼Œé…åˆ<code>raw-loader</code>å¯ä»¥å°†å¯¼å…¥çš„èµ„æºæ–‡ä»¶çš„å†…å®¹æ”¾å…¥åˆ°æ’å€¼è¯­æ³•çš„ä½ç½®ã€‚</p>
<p>index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--ğŸ‘‡ å†…è”html --&gt;</span><br>    $&#123;require(&#x27;!!raw-loader!./src/head.html&#x27;)&#125;<br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><br>      &lt;* ğŸ‘‡ å†…è”css *&gt;<br>      $&#123;require(&#x27;!!raw-loader!./src/css/index.css&#x27;)&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><br><span class="javascript">      <span class="hljs-comment">// ğŸ‘‡ å†…è”js</span></span><br><span class="javascript">      $&#123;<span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;!!raw-loader!./src/js/jquery.min.js&#x27;</span>)&#125;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>  <br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure>
<p><strong>è§£é‡Šï¼š</strong></p>
<ul>
<li><p><code>require()</code>ä¸­çš„<code>raw-loader![source-id]</code>çš„å†™æ³•æ˜¯<strong>è¡Œå†…loader</strong>ï¼Œç”¨<code>!</code>åˆ†å‰²loaderå’Œå‚æ•°ã€‚</p>
</li>
<li><p><code>!!raw-loader</code>ä¸­ï¼Œå‰é¢çš„ä¸¤ä¸ª<code>!!</code>æ˜¯æ ‡è®°è¯¥æ¡å¼•ç”¨çš„èµ„æºä¸éœ€è¦å†è¢«<code>rules</code>ä¸­é…ç½®çš„loaderå¤„ç†ã€‚</p>
</li>
</ul>
<h2 id="åˆ†æpluginså’Œloadersè€—æ—¶"><a href="#åˆ†æpluginså’Œloadersè€—æ—¶" class="headerlink" title="åˆ†æpluginså’Œloadersè€—æ—¶"></a>åˆ†æpluginså’Œloadersè€—æ—¶</h2><p><strong>ä½¿ç”¨æ’ä»¶ï¼š</strong><code>speed-measure-webpack-plugin</code></p>
<p><strong>1. å®‰è£…</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">npm <span class="hljs-keyword">install</span> speed-measure-webpack-<span class="hljs-keyword">plugin</span> -D<br></code></pre></td></tr></table></figure>
<p><strong>2. æ–°å»ºæ’ä»¶å¯¹è±¡</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-keyword">const</span> SpeedMeasureWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;speed-measure-webpack-plugin&#x27;</span>);<br><span class="hljs-keyword">const</span> smw = <span class="hljs-keyword">new</span> SpeedMeasureWebpackPlugin();<br><br></code></pre></td></tr></table></figure>
<p><strong>3. ä½¿ç”¨wrapæ–¹æ³•åŒ…è£¹webpacké…ç½®å¯¹è±¡å¹¶å¯¼å‡º</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># webpack.config.js<br><br><span class="hljs-keyword">const</span> SpeedMeasureWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;speed-measure-webpack-plugin&#x27;</span>);<br><span class="hljs-keyword">const</span> smw = <span class="hljs-keyword">new</span> SpeedMeasureWebpackPlugin();<br><br><span class="hljs-built_in">module</span>.exports = smw.wrap(&#123;<br>  entry: <span class="hljs-string">&#x27;./src/main.js&#x27;</span>,<br>  ouput: &#123;<span class="hljs-comment">/*...*/</span>&#125;,<br>  <span class="hljs-built_in">module</span>: &#123;<span class="hljs-comment">/*...*/</span>&#125;<br>  <span class="hljs-comment">//...</span><br>&#125;);<br></code></pre></td></tr></table></figure>
<p><strong>4. npm run build</strong></p>
<h2 id="ç”Ÿæˆæ‰“åŒ…è¿‡ç¨‹çš„åˆ†ææŠ¥å‘Š"><a href="#ç”Ÿæˆæ‰“åŒ…è¿‡ç¨‹çš„åˆ†ææŠ¥å‘Š" class="headerlink" title="ç”Ÿæˆæ‰“åŒ…è¿‡ç¨‹çš„åˆ†ææŠ¥å‘Š"></a>ç”Ÿæˆæ‰“åŒ…è¿‡ç¨‹çš„åˆ†ææŠ¥å‘Š</h2><p><strong>ä½¿ç”¨æ’ä»¶ï¼š</strong><code>webpack-bundle-analyzer</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install webpack-bundle-analyzer â€“save-dev<br></code></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// ç›´æ¥ä½¿ç”¨æ’ä»¶ï¼š</span><br>plugins: [<br>    <span class="hljs-keyword">new</span> BundleAnalyzerPlugin()<br>]<br><br>ğŸ‘‡ è¯¥æ’ä»¶çš„é»˜è®¤é…ç½®ï¼Œä¸€èˆ¬æ— éœ€ä¿®æ”¹ï¼š<br>&#123;<br>  <span class="hljs-comment">//  å¯ä»¥æ˜¯`server`ï¼Œ`static`æˆ–`disabled`ã€‚</span><br>  <span class="hljs-comment">//  åœ¨`server`æ¨¡å¼ä¸‹ï¼Œåˆ†æå™¨å°†å¯åŠ¨HTTPæœåŠ¡å™¨æ¥æ˜¾ç¤ºè½¯ä»¶åŒ…æŠ¥å‘Šã€‚</span><br>  <span class="hljs-comment">//  åœ¨â€œé™æ€â€æ¨¡å¼ä¸‹ï¼Œä¼šç”Ÿæˆå¸¦æœ‰æŠ¥å‘Šçš„å•ä¸ªHTMLæ–‡ä»¶ã€‚</span><br>  <span class="hljs-comment">//  åœ¨`disabled`æ¨¡å¼ä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ’ä»¶æ¥å°†`generateStatsFile`è®¾ç½®ä¸º`true`æ¥ç”ŸæˆWebpack Stats JSONæ–‡ä»¶ã€‚</span><br>  analyzerMode: <span class="hljs-string">&#x27;server&#x27;</span>,<br>  <span class="hljs-comment">//  å°†åœ¨â€œæœåŠ¡å™¨â€æ¨¡å¼ä¸‹ä½¿ç”¨çš„ä¸»æœºå¯åŠ¨HTTPæœåŠ¡å™¨ã€‚</span><br>  analyzerHost: <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<br>  <span class="hljs-comment">//  å°†åœ¨â€œæœåŠ¡å™¨â€æ¨¡å¼ä¸‹ä½¿ç”¨çš„ç«¯å£å¯åŠ¨HTTPæœåŠ¡å™¨ã€‚</span><br>  analyzerPort: <span class="hljs-number">8888</span>, <br>  <span class="hljs-comment">//  è·¯å¾„æ†ç»‘ï¼Œå°†åœ¨`static`æ¨¡å¼ä¸‹ç”Ÿæˆçš„æŠ¥å‘Šæ–‡ä»¶ã€‚</span><br>  <span class="hljs-comment">//  ç›¸å¯¹äºæ†ç»‘è¾“å‡ºç›®å½•ã€‚</span><br>  reportFilename: <span class="hljs-string">&#x27;report.html&#x27;</span>,<br>  <span class="hljs-comment">//  æ¨¡å—å¤§å°é»˜è®¤æ˜¾ç¤ºåœ¨æŠ¥å‘Šä¸­ã€‚</span><br>  <span class="hljs-comment">//  åº”è¯¥æ˜¯`stat`ï¼Œ`parsed`æˆ–è€…`gzip`ä¸­çš„ä¸€ä¸ªã€‚</span><br>  <span class="hljs-comment">//  æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§â€œå®šä¹‰â€ä¸€èŠ‚ã€‚</span><br>  defaultSizes: <span class="hljs-string">&#x27;parsed&#x27;</span>,<br>  <span class="hljs-comment">//  åœ¨é»˜è®¤æµè§ˆå™¨ä¸­è‡ªåŠ¨æ‰“å¼€æŠ¥å‘Š</span><br>  openAnalyzer: <span class="hljs-literal">true</span>,<br>  <span class="hljs-comment">//  å¦‚æœä¸ºtrueï¼Œåˆ™Webpack Stats JSONæ–‡ä»¶å°†åœ¨bundleè¾“å‡ºç›®å½•ä¸­ç”Ÿæˆ</span><br>  generateStatsFile: <span class="hljs-literal">false</span>, <br>  <span class="hljs-comment">//  å¦‚æœ`generateStatsFile`ä¸º`true`ï¼Œå°†ä¼šç”ŸæˆWebpack Stats JSONæ–‡ä»¶çš„åå­—ã€‚</span><br>  <span class="hljs-comment">//  ç›¸å¯¹äºæ†ç»‘è¾“å‡ºç›®å½•ã€‚</span><br>  statsFilename: <span class="hljs-string">&#x27;stats.json&#x27;</span>,<br>  <span class="hljs-comment">//  stats.toJsonï¼ˆï¼‰æ–¹æ³•çš„é€‰é¡¹ã€‚</span><br>  <span class="hljs-comment">//  ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`sourceï¼šfalse`é€‰é¡¹æ’é™¤ç»Ÿè®¡æ–‡ä»¶ä¸­æ¨¡å—çš„æ¥æºã€‚</span><br>  <span class="hljs-comment">//  åœ¨è¿™é‡ŒæŸ¥çœ‹æ›´å¤šé€‰é¡¹ï¼šhttpsï¼š  //github.com/webpack/webpack/blob/webpack-1/lib/Stats.js#L21</span><br>  statsOptions: <span class="hljs-literal">null</span>,<br>  logLevel: <span class="hljs-string">&#x27;info&#x27;</span> <span class="hljs-comment">// æ—¥å¿—çº§åˆ«ã€‚å¯ä»¥æ˜¯&#x27;ä¿¡æ¯&#x27;ï¼Œ&#x27;è­¦å‘Š&#x27;ï¼Œ&#x27;é”™è¯¯&#x27;æˆ–&#x27;æ²‰é»˜&#x27;ã€‚</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/webpack4.assets/image-20210328200605532.png" srcset="/img/loading.gif" alt="image-20210328200605532"></p>
<h2 id="æ ·å¼è¡¨pxè‡ªåŠ¨æ¢ç®—rem"><a href="#æ ·å¼è¡¨pxè‡ªåŠ¨æ¢ç®—rem" class="headerlink" title="æ ·å¼è¡¨pxè‡ªåŠ¨æ¢ç®—rem"></a>æ ·å¼è¡¨pxè‡ªåŠ¨æ¢ç®—rem</h2><p><strong>ä½¿ç”¨loaderï¼š</strong><code>px2rem-loader</code></p>
<p><strong>å‰è¨€</strong></p>
<p>ç§»åŠ¨ç«¯å¼€å‘remå¸ƒå±€ä¸­ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨å†…è”çš„JSè„šæœ¬æ”¹å˜remçš„å¤§å°ã€‚<font color='red'>è€Œè¿™ä¸ªJSè„šæœ¬ä¸­ä¼šè€¦åˆè®¾è®¡ç¨¿çš„ä¿¡æ¯</font>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> html = <span class="hljs-built_in">document</span>.documentElement;<br><span class="hljs-keyword">const</span> body = <span class="hljs-built_in">document</span>.body;<br><br><span class="hljs-keyword">const</span> designWidth = <span class="hljs-number">750</span>; <span class="hljs-comment">// ğŸ‘ˆ è®¾è®¡ç¨¿å®½åº¦ï¼Œè€¦åˆäº†è®¾è®¡ç¨¿ä¿¡æ¯</span><br><span class="hljs-keyword">const</span> zoomRatio = <span class="hljs-number">100</span>; <span class="hljs-comment">// remæ”¾å¤§æ¯”ä¾‹ï¼Œä¾¿äºæ¢ç®—ã€‚</span><br>html.style.fontSize = html.clientWidth / designWidth * zoomRatio + <span class="hljs-string">&#x27;px&#x27;</span>;<br>body.style.fontSize = <span class="hljs-string">&#x27;16px&#x27;</span>;<br><br></code></pre></td></tr></table></figure>


<p><strong>ç°åœ¨æä¾›ä¸€ç§æ–¹å¼ï¼š</strong> æŠ½ç¦»æ§åˆ¶remçš„JSè„šæœ¬ä¸­çš„è®¾è®¡ç¨¿å®½åº¦ä¿¡æ¯ï¼Œå°†è®¾è®¡ç¨¿å®½åº¦çš„å˜åŒ–ç”±wepackçš„æ’ä»¶æ¥é€‚é…ã€‚<font color='red'>åŒæ—¶åœ¨å†™cssæ–‡ä»¶æ—¶ï¼Œä¸å†éœ€è¦è¿›è¡Œäººä¸ºçš„æ¢ç®—, æ’ä»¶ä¼šå¸®åŠ©æˆ‘ä»¬æ¢ç®—ã€‚</font></p>
<p>ğŸ˜„ <strong>åœ¨å¦‚ä¸‹é…ç½®ä¸‹ï¼Œæˆ‘ä»¬çš„cssæ–‡ä»¶ä¸­ä¸å†éœ€è¦å¼€å‘è€…æ¢ç®—å•¦ ~ é‡å¤šå°‘ï¼Œå†™å¤šå°‘ã€‚</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># æ§åˆ¶remå¤§å°çš„è„šæœ¬æˆ–è€…å…¶ä»–ç±»ä¼¼çš„é€šç”¨è„šæœ¬/æ’ä»¶<br><br><span class="hljs-keyword">const</span> html = <span class="hljs-built_in">document</span>.documentElement;<br><span class="hljs-keyword">const</span> body = <span class="hljs-built_in">document</span>.body;<br><br><span class="hljs-keyword">const</span> ratio = <span class="hljs-number">10</span>;<br><br><span class="hljs-comment">/* ğŸ‘‡ å‰¥ç¦»è®¾è®¡ç¨¿ä¿¡æ¯ï¼Œremå¤§å°æ°¸è¿œä¸ºç†æƒ³è§†å£å®½åº¦çš„ååˆ†ä¹‹ä¸€ã€‚æ’ä»¶æ¢ç®—æ¯”ä¾‹ = è®¾è®¡ç¨¿å®½åº¦ / 10</span><br><span class="hljs-comment">*			ratioä¹Ÿå¯ä»¥æ˜¯åˆ«çš„å€¼ï¼Œä½†æ˜¯æ’ä»¶æ¢ç®—æ¯”ä¾‹  = è®¾è®¡ç¨¿ / ratio</span><br><span class="hljs-comment">*/</span><br>html.style.fontSize = html.clientWidth / ratio; <br><br>body.style.fontSize = <span class="hljs-string">&#x27;16px&#x27;</span>;<br><br><span class="hljs-comment">//====================================================================</span><br># webpack.config.js<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">//..</span><br>  <span class="hljs-built_in">module</span>: &#123;<br>    rules: [<br>      &#123;<br>        test: <span class="hljs-regexp">/\.css$/</span>,<br>        use: [<br>          <span class="hljs-string">&#x27;style-loader&#x27;</span>,<br>          <span class="hljs-string">&#x27;css-loader&#x27;</span>,<br>          &#123;<br>            loader: <span class="hljs-string">&#x27;px2rem-loader&#x27;</span>,<br>            options: &#123;<br>              remPrecesion: <span class="hljs-number">8</span>, <span class="hljs-comment">// ğŸ‘ˆ æ¢ç®—æˆremåï¼Œä¿ç•™å¤šå°‘ä½å°æ•°</span><br>              remunit: <span class="hljs-number">75</span>, <span class="hljs-comment">// ğŸ‘ˆ æ¢ç®—æ¯”ä¾‹ï¼Œå³åœ¨cssæ ·å¼è¡¨ä¸­75pxæ¢ç®—ä¸º1remï¼Œç›¸å½“äºè®¾è®¡ç¨¿ 750/10</span><br>              <br>              <span class="hljs-comment">// å‡å¦‚è¯´è®¾è®¡ç¨¿æ˜¯1080ï¼Œæ§åˆ¶remå¤§å°JSè„šæœ¬ä¸­çš„ratioè®¾ç½®ä¸º10ï¼Œåˆ™ï¼š</span><br>              remunit: <span class="hljs-number">108</span>,<br>              <span class="hljs-comment">// å‡å¦‚è¯´è®¾è®¡ç¨¿æ˜¯1000ï¼Œratioè®¾ç½®ä¸º20ï¼Œåˆ™ï¼š</span><br>              remunit: <span class="hljs-number">50</span>,<br>              <br>            &#125;<br>          &#125;<br>        ]<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-comment">/*</span><br><span class="hljs-comment">å‡å¦‚è®¾è®¡ç¨¿ä¸Šä¸€ä¸ªdivå®½åº¦æ˜¯ 250px</span><br><span class="hljs-comment">px2rem-loaderä¸­è®¾ç½®äº†remunitæ˜¯75</span><br><span class="hljs-comment">*/</span><br><span class="hljs-selector-tag">div</span> &#123;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">250px</span> <span class="hljs-comment">/* ğŸ‘‰ loader ç¼–è¯‘å width: 3.33333333rem */</span><br>&#125;<br><br></code></pre></td></tr></table></figure>
<h3 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="headerlink" title="æ³¨æ„ç‚¹"></a>æ³¨æ„ç‚¹</h3><p>â— â—  éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå†…è”æ ·å¼ä¸ä¼šè¢« <code>px2rem-loader</code>å¤„ç†ï¼Œä»ç„¶éœ€è¦å¼€å‘è€…æ¢ç®—ã€‚</p>
<blockquote>
<p>æ‰€ä»¥å¯èƒ½è¿˜æ˜¯ remunit å›ºå®šä¸º100ï¼Œæ ¹æ®ä¸åŒè®¾è®¡ç¨¿è°ƒæ•´ratioæ¥çš„å¥½ã€‚</p>
</blockquote>
<h1 id="å½’çº³å°ç»“"><a href="#å½’çº³å°ç»“" class="headerlink" title="å½’çº³å°ç»“"></a>å½’çº³å°ç»“</h1><h1 id="è¸©å‘"><a href="#è¸©å‘" class="headerlink" title="è¸©å‘"></a>è¸©å‘</h1><h2 id="webpack4ã€cliã€html-webpack-pluginå…¼å®¹"><a href="#webpack4ã€cliã€html-webpack-pluginå…¼å®¹" class="headerlink" title="webpack4ã€cliã€html-webpack-pluginå…¼å®¹"></a>webpack4ã€cliã€html-webpack-pluginå…¼å®¹</h2><ul>
<li>ç°åœ¨ä½¿ç”¨<code>npm install webpack -D</code>é»˜è®¤å®‰è£…çš„æ˜¯webpack5ã€‚</li>
<li>webpack-cliã€html-webpack-pluginé»˜è®¤å®‰è£…çš„æœ€æ–°ç‰ˆæœ¬æ˜¯é…åˆwebpack5ä½¿ç”¨ï¼Œæ‰€ä»¥å½“ä½¿ç”¨webpack4æ—¶ï¼Œä¹Ÿéœ€è¦é™ä½webpack-cliã€html-webpack-pluginçš„ç‰ˆæœ¬ã€‚</li>
</ul>
<p><strong>å®‰è£…ç»„åˆï¼š</strong><code>npm install -D wepack@4 webpack-cli@3 html-webpack-plugin@4 </code></p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/webpack/">webpack</a>
                    
                  </div>
                
                
              </div>
              
                <p class="note note-warning">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/04/29/Vue/vue3/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Vue3ç¬”è®°</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/04/09/JavaScript/webapis/">
                        <span class="hidden-mobile">WebAPIs</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      var inputArea = document.querySelector("#local-search-input");
      inputArea.onclick = function () {
        searchFunc(path, 'local-search-input', 'local-search-result');
        this.onclick = null
      }
    })()
  </script>















<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>



</body>
</html>
